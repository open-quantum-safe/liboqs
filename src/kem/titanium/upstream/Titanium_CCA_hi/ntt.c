/* ****************************** *
 * Titanium_CCA_hi                *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 1024=4*256 */
#define N1_1024 4
#define N2_1024 256

/* 2304=9*256 */
#define N1_2304 9
#define N2_2304 256

/* 2560=10*256 */
#define N1_2560 10
#define N2_2560 256

/* multiplication inverses of 1024, 2304, 2560 (in Montgomery form) */
#define INV_1024 277499
#define INV_2304 210373
#define INV_2560 424344

/* omega_n: n-th root of unity mod Q (in Montgomery form) */
static const uint32_t w_4[3][3]={{42784,201067,740577},
{201067,582294,201067},
{740577,201067,42784}};

static const uint32_t w_9[8][8]={{365339,600698,545880,681581,268617,438548,519802,697407},
{600698,681581,438548,697407,365339,545880,268617,519802},
{545880,438548,582294,545880,438548,582294,545880,438548},
{681581,697407,545880,519802,600698,438548,365339,268617},
{268617,365339,438548,600698,519802,545880,697407,681581},
{438548,545880,582294,438548,545880,582294,438548,545880},
{519802,268617,545880,365339,697407,438548,681581,600698},
{697407,519802,438548,268617,681581,545880,600698,365339}};

static const uint32_t w_10[9][9]={{50529,388962,78325,724320,201067,732832,394399,705036,59041},
{388962,724320,732832,705036,582294,388962,724320,732832,705036},
{78325,732832,59041,388962,201067,705036,50529,724320,394399},
{724320,705036,388962,732832,582294,724320,705036,388962,732832},
{201067,582294,201067,582294,201067,582294,201067,582294,201067},
{732832,388962,705036,724320,582294,732832,388962,705036,724320},
{394399,724320,50529,705036,201067,388962,59041,732832,78325},
{705036,732832,724320,388962,582294,705036,732832,724320,388962},
{59041,705036,394399,732832,201067,724320,78325,388962,50529}};

/* omega_256,1024,2304,2560, respectively (in Montgomery form) */
static const uint32_t omega_256[128]={582294,158118,128941,92896,151089,564145,399162,353240,7913,436856,656345,19615,21252,427426,147916,418572,618883,154509,308261,575126,590895,111046,428546,398535,347928,27877,458566,415485,412819,721318,145283,603662,412863,34532,377516,93641,237361,419234,754427,621938,219122,213487,396882,262709,151724,17299,65349,25155,715366,469671,665740,397812,701624,680585,239971,59036,393961,741462,277214,743129,571198,657567,672149,453359,42784,329986,278171,297712,334579,335824,380105,595337,211148,265871,77313,718721,195745,160363,89240,245053,638075,190918,194431,374119,524633,627883,182032,523947,582091,656150,748850,327312,355467,35526,315972,461793,359116,228860,614580,56834,11736,762849,199785,197089,617778,631156,475879,689599,476259,313007,60610,252373,681350,512570,304544,374969,218240,378429,335010,551870,607512,637885,379214,10575,404436,214263,106104,370435};
static const uint32_t omega_1024[1024]={582294,523667,202134,408891,158118,323596,29583,4629,128941,673811,606703,706386,92896,504921,268711,628475,151089,447138,684834,57112,564145,328661,539588,16590,399162,271943,319799,627810,353240,87526,511707,716148,7913,649074,137312,156455,436856,315337,644827,342239,656345,225278,269361,413214,19615,692929,81893,288631,21252,556945,302749,609969,427426,690488,298542,66495,147916,24019,625220,439663,418572,2341,479312,603914,618883,384652,123979,253828,154509,302774,631819,723662,308261,727291,346563,518716,575126,525723,432356,299142,590895,207331,250903,731503,111046,700801,695133,441467,428546,102646,409450,646684,398535,507306,3118,375049,347928,145004,612375,180187,27877,80307,469189,373383,458566,489213,640417,404704,415485,437747,310710,517634,412819,457746,555894,167536,721318,609688,181832,682246,145283,72860,227399,556393,603662,398635,594706,404701,412863,496202,481915,528853,34532,413250,51079,774830,377516,154003,643891,307536,93641,372690,636245,675181,237361,646210,767620,342864,419234,580929,114018,164885,754427,562597,542431,151289,621938,704639,132740,77332,219122,372544,508641,386547,213487,147720,636076,527475,396882,629306,94022,705684,262709,82893,379270,120277,151724,218767,62274,375567,17299,235467,557576,70882,65349,713034,419721,223206,25155,51362,238811,346788,715366,107806,219124,374292,469671,11290,467128,138791,665740,602898,514260,597387,397812,658765,773636,117321,701624,631074,72532,724088,680585,260291,319644,492340,239971,577267,46874,233104,59036,678999,440849,671775,393961,426435,607715,24152,741462,198241,139853,27206,277214,226487,542666,356679,743129,88477,559520,203216,571198,226095,200058,161189,657567,509945,742882,655960,672149,720837,189294,153785,453359,638461,261882,143456,42784,575249,633225,385784,329986,130916,49878,508517,278171,279544,696185,577554,297712,124436,653246,650196,334579,228393,641788,36236,335824,533162,667154,272012,380105,66706,332330,612850,595337,172834,651604,781810,211148,453517,776553,316696,265871,496398,653219,626598,77313,202516,742759,548458,718721,689993,649273,311238,195745,308432,93384,148072,160363,719004,153974,618545,89240,443021,220020,374035,245053,318769,510951,55404,638075,707879,614417,398173,190918,6439,144159,657206,194431,726718,629122,716567,374119,318469,248751,417377,524633,263057,387045,648739,627883,417042,231843,523644,182032,73685,165088,148488,523947,446854,436618,107325,582091,346245,240784,504468,656150,54848,152131,574485,748850,388465,323097,376818,327312,143923,450942,92725,355467,467202,203467,7211,35526,498645,267014,712019,315972,416456,503040,191439,461793,176167,431202,73907,359116,522984,388553,400009,228860,266585,337073,58066,614580,540635,148307,365753,56834,321173,261964,215124,11736,73571,65452,19695,762849,89815,162210,766560,199785,705948,493445,422380,197089,699727,539818,217610,617778,202243,504157,384336,631156,144200,693040,178907,475879,736916,141842,198870,689599,304917,154718,485440,476259,285675,571152,185891,313007,175129,307351,715312,60610,487953,322538,671613,252373,449561,452453,629978,681350,145540,297478,703281,512570,687049,426300,489725,304544,612077,703096,350880,374969,278008,137082,738796,218240,385037,460469,585713,378429,168604,88028,167094,335010,605087,77363,246216,551870,567365,9497,466768,607512,630091,780112,293818,637885,541819,399762,12982,379214,71333,459523,542270,10575,625579,753429,473706,404436,181253,176200,460044,214263,42583,399575,632905,106104,298298,636600,202090,370435,232097,745640,716369,201067,259694,581227,374470,625243,459765,753778,778732,654420,109550,176658,76975,690465,278440,514650,154886,632272,336223,98527,726249,219216,454700,243773,766771,384199,511418,463562,155551,430121,695835,271654,67213,775448,134287,646049,626906,346505,468024,138534,441122,127016,558083,514000,370147,763746,90432,701468,494730,762109,226416,480612,173392,355935,92873,484819,716866,635445,759342,158141,343698,364789,781020,304049,179447,164478,398709,659382,529533,628852,480587,151542,59699,475100,56070,436798,264645,208235,257638,351005,484219,192466,576030,532458,51858,672315,82560,88228,341894,354815,680715,373911,136677,384826,276055,780243,408312,435433,638357,170986,603174,755484,703054,314172,409978,324795,294148,142944,378657,367876,345614,472651,265727,370542,325615,227467,615825,62043,173673,601529,101115,638078,710501,555962,226968,179699,384726,188655,378660,370498,287159,301446,254508,748829,370111,732282,8531,405845,629358,139470,475825,689720,410671,147116,108180,546000,137151,15741,440497,364127,202432,669343,618476,28934,220764,240930,632072,161423,78722,650621,706029,564239,410817,274720,396814,569874,635641,147285,255886,386479,154055,689339,77677,520652,700468,404091,663084,631637,564594,721087,407794,766062,547894,225785,712479,718012,70327,363640,560155,758206,731999,544550,436573,67995,675555,564237,409069,313690,772071,316233,644570,117621,180463,269101,185974,385549,124596,9725,666040,81737,152287,710829,59273,102776,523070,463717,291021,543390,206094,736487,550257,724325,104362,342512,111586,389400,356926,175646,759209,41899,585120,643508,756155,506147,556874,240695,426682,40232,694884,223841,580145,212163,557266,583303,622172,125794,273416,40479,127401,111212,62524,594067,629576,330002,144900,521479,639905,740577,208112,150136,397577,453375,652445,733483,274844,505190,503817,87176,205807,485649,658925,130115,133165,448782,554968,141573,747125,447537,250199,116207,511349,403256,716655,451031,170511,188024,610527,131757,1551,572213,329844,6808,466665,517490,286963,130142,156763,706048,580845,40602,234903,64640,93368,134088,472123,587616,474929,689977,635289,622998,64357,629387,164816,694121,340340,563341,409326,538308,464592,272410,727957,145286,75482,168944,385188,592443,776922,639202,126155,588930,56643,154239,66794,409242,464892,534610,365984,258728,520304,396316,134622,155478,366319,551518,259717,601329,709676,618273,634873,259414,336507,346743,676036,201270,437116,542577,278893,127211,728513,631230,208876,34511,394896,460264,406543,456049,639438,332419,690636,427894,316159,579894,776150,747835,284716,516347,71342,467389,366905,280321,591922,321568,607194,352159,709454,424245,260377,394808,383352,554501,516776,446288,725295,168781,242726,635054,417608,726527,462188,521397,568237,771625,709790,717909,763666,20512,693546,621151,16801,583576,77413,289916,360981,586272,83634,243543,565751,165583,581118,279204,399025,152205,639161,90321,604454,307482,46445,641519,584491,93762,478444,628643,297921,307102,497686,212209,597470,470354,608232,476010,68049,722751,295408,460823,111748,530988,333800,330908,153383,102011,637821,485883,80080,270791,96312,357061,293636,478817,171284,80265,432481,408392,505353,646279,44565,565121,398324,322892,197648,404932,614757,695333,616267,448351,178274,705998,537145,231491,215996,773864,316593,175849,153270,3249,489543,145476,241542,383599,770379,404147,712028,323838,241091,772786,157782,29932,309655,378925,602108,607161,323317,569098,740778,383786,150456,677257,485063,146761,581271,412926,551264,37721,66992};
static const uint32_t omega_2304[2304]={582294,118736,181332,154267,76753,558114,493915,485043,463049,158118,393746,269390,168779,201731,496743,610017,364937,623381,128941,501009,234563,472886,231067,479053,670352,133248,306310,92896,192855,438008,654247,455866,570312,123291,697853,298726,151089,262066,265054,292946,328892,315227,332386,682370,459362,564145,467367,260297,662768,191441,375521,703303,614915,311034,399162,664961,554829,283927,327548,504027,146332,631888,127603,353240,699809,247772,184058,517387,656956,75316,88526,396404,7913,417831,392494,519872,568993,345882,92105,565092,744668,436856,256532,744026,415133,286561,628986,497962,252262,299378,656345,534176,350161,423580,517469,235105,359445,313092,110062,19615,191489,33052,430176,1220,238951,42991,264979,191573,21252,148044,689816,308646,398893,740052,339236,540772,617273,427426,201015,186992,440956,314729,66617,676379,69959,430725,147916,297465,514744,468691,671153,244544,301789,280354,605652,418572,736036,269239,152688,261262,713723,755178,228750,543416,618883,723500,277012,67945,340615,85935,685772,764823,104853,154509,341181,192940,239553,480665,593116,426345,651293,348592,308261,191856,466435,316615,547737,161097,534811,111747,417062,575126,81188,755766,146150,135214,738889,428004,418243,260012,590895,589131,53570,494815,134797,237924,597592,21391,53912,111046,440930,467593,377761,127516,141644,656291,429853,755349,428546,304802,342037,221904,721755,111811,221557,472077,46289,398535,193496,646386,515668,338891,701145,768851,285073,278471,347928,476143,183868,730592,399842,644043,732895,598566,742534,27877,485688,708168,453739,421470,328936,719378,408420,707337,458566,302935,231277,449553,748383,288016,88867,199290,205496,415485,386325,453897,697698,245894,559781,334347,481502,251720,412819,574320,119806,217537,365339,7366,681186,551080,512149,721318,210502,570228,135091,196624,393491,81394,689525,573342,145283,592733,629359,594776,6640,671263,79880,491874,734452,603662,548908,145811,742379,758406,111019,780449,670187,380244,412863,195110,195840,242504,364543,529517,445096,740336,597764,34532,707209,66215,509033,301075,380654,653691,49033,535309,377516,423053,181168,214608,291856,108982,283238,461639,132372,93641,573138,621575,382641,299959,313608,149485,412784,56996,237361,713983,9899,250754,548519,685394,34562,591086,189271,419234,158103,60127,207862,605359,273217,265326,441251,86774,754427,185036,491910,281760,594657,284477,287589,671091,66739,621938,779283,535559,715426,142918,216204,67656,232001,49425,219122,627622,503057,245291,308762,681021,14715,618702,40171,213487,374724,628748,270275,268275,698439,589436,309148,701403,396882,89977,602905,58402,226366,579888,344813,652606,462570,262709,100122,371467,675947,18736,538785,187644,162851,586839,151724,23652,258536,350603,174975,711548,165444,707522,395275,17299,69197,90133,469082,541621,386100,149778,558139,527706,65349,779897,300095,779441,28426,632384,766682,142131,625182,25155,159309,562165,297875,755572,322614,227261,379556,360299,715366,375164,753453,247254,517945,690479,327419,298331,243880,469671,272366,86448,501799,48981,57676,216443,108688,324538,665740,72369,241389,110842,133861,257501,48361,629709,284489,397812,406969,500836,408077,494400,43883,624612,664770,171328,701624,664260,578697,176394,624121,659138,141826,369604,601928,680585,710112,292562,718561,150160,541780,475673,175286,630557,239971,11614,532078,271851,643731,217180,415489,423066,104736,59036,174607,464820,170455,712351,686791,136740,263402,2772,393961,89976,6199,733213,777712,10189,172713,693579,600698,741462,364982,57516,313525,757991,20105,383776,737365,530181,277214,748324,333607,734666,610903,277778,445278,453649,769839,743129,205414,53975,102196,229331,200679,234192,2762,693789,571198,36132,519750,623434,419919,770632,780943,115854,735396,657567,399817,610252,369228,281718,600557,425543,726652,244563,672149,776082,313771,275799,89131,274113,661700,565287,381549,453359,64519,598069,290110,130436,328300,361086,306388,417665,42784,517875,439192,562529,507862,316361,173086,7032,355076,329986,571878,15214,697816,154712,51544,294482,336938,192134,278171,725797,28944,298497,593590,471668,402167,653162,86042,297712,629258,646267,10144,738578,508995,343716,172559,454092,334579,262397,367768,188390,356479,95595,112133,437444,173932,335824,535139,774426,770217,690029,502542,19213,24143,264168,380105,506995,773880,63556,173804,726834,741237,60863,701318,595337,263559,465655,202369,481725,145788,335278,611839,258201,211148,628692,539262,456363,239375,20732,71880,645808,298440,265871,551206,494449,298120,460035,283090,668944,517553,223305,77313,218327,179757,375517,666562,180715,166335,470449,759922,718721,53078,675838,780106,457250,748922,734540,628603,700976,195745,740787,235986,422200,375600,58056,573394,622916,753806,160363,451406,338869,107389,730834,664270,278869,478533,594188,89240,296104,743235,4009,593221,411595,298628,425976,591220,245053,81075,697034,413776,551793,598504,564729,348026,201256,638075,750593,611713,275901,634346,379159,43039,705871,701807,190918,75961,333645,692025,35637,477377,159732,726561,779587,194431,30103,172988,281919,684230,309985,360007,383356,13004,374119,751039,399849,120819,709384,655949,30261,449216,198877,524633,235912,134172,176510,122888,717162,421292,652364,198142,627883,354484,375845,545880,533870,281238,108442,23369,596714,182032,317054,75736,29526,552466,317449,766306,605282,545154,523947,593399,88167,36503,206513,160712,327774,621491,394441,582091,408373,79790,56882,365284,89698,194463,324031,513144,656150,113934,333658,615593,663426,360128,515570,613778,246938,748850,73202,646613,446477,695550,100002,52598,183723,377932,327312,686391,379445,711618,416731,472412,185744,728179,365782,355467,200454,713434,646564,192240,76766,481682,338343,367794,35526,45335,644458,40448,211878,675356,661301,621337,154954,315972,712669,82576,187756,408238,210663,286491,377699,733072,461793,371859,359760,268842,618789,251767,257005,192643,57457,359116,620429,431718,456058,767158,597505,593156,10394,293127,228860,378752,25607,394237,275022,198281,533751,559075,508129,614580,171579,69518,492675,62387,599141,736366,558608,722943,56834,707753,362825,24797,396114,85954,272771,477190,596333,11736,477637,197814,748565,1329,260942,124526,487062,403245,762849,382153,517723,609756,513510,492827,675184,648160,751401,199785,247869,95826,79683,444942,500849,331645,338828,709995,197089,551987,422040,472682,707359,268961,340952,635441,449155,617778,169971,183495,633778,645464,272158,525999,640868,358243,631156,454249,14101,70805,759517,327979,741905,713083,360145,475879,109045,274388,250040,648819,733433,448384,390359,297548,689599,78009,344373,527901,485591,13039,108082,633484,686764,476259,465996,5255,679308,143442,329109,545864,386906,111160,313007,308517,193197,54239,177019,685535,350481,229416,2224,60610,140012,549822,315839,470232,529285,664201,624288,38832,252373,731420,171619,436928,134509,726016,669632,570117,486410,681350,490739,297046,387089,421179,593632,465768,261101,214099,512570,475663,475114,328418,269904,581512,377800,681581,458289,304544,714006,417000,397321,401337,471334,76057,432068,145771,374969,333211,230751,709958,53075,452442,454456,544566,606547,218240,751522,331999,65282,752006,77494,118295,243282,68738,378429,779736,583832,536833,275339,564082,476217,471896,146321,335010,500275,151158,700008,704755,634761,470073,439712,638693,551870,326567,306108,195878,199863,572638,729116,159550,229887,607512,269195,531898,185228,688756,755974,489960,779506,429627,637885,180437,354599,61267,495354,581321,777660,315917,11640,379214,744068,409233,145495,189923,141129,430213,145234,338496,10575,193095,292385,71973,520835,209897,692519,264665,49168,404436,147907,410638,321155,730639,244028,262366,670546,740145,214263,452229,260560,140885,539095,293308,128828,442277,502189,106104,90682,615778,600135,74492,353490,254358,750998,219094,370435,597101,15759,24410,562387,378598,569481,128118,579318,201067,664625,602029,629094,706608,225247,289446,298318,320312,625243,389615,513971,614582,581630,286618,173344,418424,159980,654420,282352,548798,310475,552294,304308,113009,650113,477051,690465,590506,345353,129114,327495,213049,660070,85508,484635,632272,521295,518307,490415,454469,468134,450975,100991,323999,219216,315994,523064,120593,591920,407840,80058,168446,472327,384199,118400,228532,499434,455813,279334,637029,151473,655758,430121,83552,535589,599303,265974,126405,708045,694835,386957,775448,365530,390867,263489,214368,437479,691256,218269,38693,346505,526829,39335,368228,496800,154375,285399,531099,483983,127016,249185,433200,359781,265892,548256,423916,470269,673299,763746,591872,750309,353185,782141,544410,740370,518382,591788,762109,635317,93545,474715,384468,43309,444125,242589,166088,355935,582346,596369,342405,468632,716744,106982,713402,352636,635445,485896,268617,314670,112208,538817,481572,503007,177709,364789,47325,514122,630673,522099,69638,28183,554611,239945,164478,59861,506349,715416,442746,697426,97589,18538,678508,628852,442180,590421,543808,302696,190245,357016,132068,434769,475100,591505,316926,466746,235624,622264,248550,671614,366299,208235,702173,27595,637211,648147,44472,355357,365118,523349,192466,194230,729791,288546,648564,545437,185769,761970,729449,672315,342431,315768,405600,655845,641717,127070,353508,28012,354815,478559,441324,561457,61606,671550,561804,311284,737072,384826,589865,136975,267693,444470,82216,14510,498288,504890,435433,307218,599493,52769,383519,139318,50466,184795,40827,755484,297673,75193,329622,361891,454425,63983,374941,76024,324795,480426,552084,333808,34978,495345,694494,584071,577865,367876,397036,329464,85663,537467,223580,449014,301859,531641,370542,209041,663555,565824,418022,775995,102175,232281,271212,62043,572859,213133,648270,586737,389870,701967,93836,210019,638078,190628,154002,188585,776721,112098,703481,291487,48909,179699,234453,637550,40982,24955,672342,2912,113174,403117,370498,588251,587521,540857,418818,253844,338265,43025,185597,748829,76152,717146,274328,482286,402707,129670,734328,248052,405845,360308,602193,568753,491505,674379,500123,321722,650989,689720,210223,161786,400720,483402,469753,633876,370577,726365,546000,69378,773462,532607,234842,97967,748799,192275,594090,364127,625258,723234,575499,178002,510144,518035,342110,696587,28934,598325,291451,501601,188704,498884,495772,112270,716622,161423,4078,247802,67935,640443,567157,715705,551360,733936,564239,155739,280304,538070,474599,102340,768646,164659,743190,569874,408637,154613,513086,515086,84922,193925,474213,81958,386479,693384,180456,724959,556995,203473,438548,130755,320791,520652,683239,411894,107414,764625,244576,595717,620510,196522,631637,759709,524825,432758,608386,71813,617917,75839,388086,766062,714164,693228,314279,241740,397261,633583,225222,255655,718012,3464,483266,3920,754935,150977,16679,641230,158179,758206,624052,221196,485486,27789,460747,556100,403805,423062,67995,408197,29908,536107,265416,92882,455942,485030,539481,313690,510995,696913,281562,734380,725685,566918,674673,458823,117621,710992,541972,672519,649500,525860,735000,153652,498872,385549,376392,282525,375284,288961,739478,158749,118591,612033,81737,119101,204664,606967,159240,124223,641535,413757,181433,102776,73249,490799,64800,633201,241581,307688,608075,152804,543390,771747,251283,511510,139630,566181,367872,360295,678625,724325,608754,318541,612906,71010,96570,646621,519959,780589,389400,693385,777162,50148,5649,773172,610648,89782,182663,41899,418379,725845,469836,25370,763256,399585,45996,253180,506147,35037,449754,48695,172458,505583,338083,329712,13522,40232,577947,729386,681165,554030,582682,549169,780599,89572,212163,747229,263611,159927,363442,12729,2418,667507,47965,125794,383544,173109,414133,501643,182804,357818,56709,538798,111212,7279,469590,507562,694230,509248,121661,218074,401812,330002,718842,185292,493251,652925,455061,422275,476973,365696,740577,265486,344169,220832,275499,467000,610275,776329,428285,453375,211483,768147,85545,628649,731817,488879,446423,591227,505190,57564,754417,484864,189771,311693,381194,130199,697319,485649,154103,137094,773217,44783,274366,439645,610802,329269,448782,520964,415593,594971,426882,687766,671228,345917,609429,447537,248222,8935,13144,93332,280819,764148,759218,519193,403256,276366,9481,719805,609557,56527,42124,722498,82043,188024,519802,317706,580992,301636,637573,448083,171522,525160,572213,154669,244099,326998,543986,762629,711481,137553,484921,517490,232155,288912,485241,323326,500271,114417,265808,560056,706048,565034,603604,407844,116799,602646,617026,312912,23439,64640,730283,107523,3255,326111,34439,48821,154758,82385,587616,42574,547375,361161,407761,725305,209967,160445,29555,622998,331955,444492,675972,52527,119091,504492,304828,189173,694121,487257,40126,779352,190140,371766,484733,357385,192141,538308,702286,86327,369585,231568,184857,218632,435335,582105,145286,32768,171648,507460,149015,404202,740322,77490,81554,592443,707400,449716,91336,747724,305984,623629,56800,3774,588930,753258,610373,501442,99131,473376,423354,400005,770357,409242,32322,383512,662542,73977,127412,753100,334145,584484,258728,547449,649189,606851,660473,66199,362069,130997,585219,155478,428877,407516,237481,249491,502123,674919,759992,186647,601329,466307,707625,753835,230895,465912,17055,178079,238207,259414,189962,695194,746858,576848,622649,455587,161870,388920,201270,374988,703571,726479,418077,693663,588898,459330,270217,127211,669427,449703,167768,119935,423233,267791,169583,536423,34511,710159,136748,336884,87811,683359,730763,599638,405429,456049,96970,403916,71743,366630,310949,597617,55182,417579,427894,582907,69927,136797,591121,706595,301679,445018,415567,747835,738026,138903,742913,571483,108005,122060,162024,628407,467389,70692,700785,595605,375123,572698,496870,405662,50289,321568,411502,423601,514519,164572,531594,526356,590718,725904,424245,162932,351643,327303,16203,185856,190205,772967,490234,554501,404609,757754,389124,508339,585080,249610,224286,275232,168781,611782,713843,290686,720974,184220,46995,224753,60418,726527,75608,420536,758564,387247,697407,510590,306171,187028,771625,305724,585547,34796,782032,522419,658835,296299,380116,20512,401208,265638,173605,269851,290534,108177,135201,31960,583576,535492,687535,703678,338419,282512,451716,444533,73366,586272,231374,361321,310679,76002,514400,442409,147920,334206,165583,613390,599866,149583,137897,511203,257362,142493,425118,152205,329112,769260,712556,23844,455382,41456,70278,423216,307482,674316,508973,533321,134542,49928,334977,393002,485813,93762,705352,438988,255460,297770,770322,675279,149877,96597,307102,317365,778106,104053,639919,454252,237497,396455,672201,470354,474844,590164,729122,606342,97826,432880,553945,781137,722751,643349,233539,467522,313129,254076,119160,159073,744529,530988,51941,611742,346433,648852,57345,113729,213244,296951,102011,292622,486315,396272,362182,189729,317593,522260,569262,270791,307698,308247,454943,513457,201849,405561,101780,325072,478817,69355,366361,386040,382024,312027,707304,351293,637590,408392,450150,552610,73403,730286,330919,328905,238795,176814,565121,31839,451362,718079,31355,705867,665066,540079,714623,404932,3625,199529,246528,508022,219279,307144,311465,637040,448351,283086,632203,83353,78606,148600,313288,343649,144668,231491,456794,477253,587483,583498,210723,54245,623811,553474,175849,514166,251463,598133,94605,27387,293401,3855,353734,145476,602924,428762,722094,288007,202040,5701,467444,771721,404147,39293,374128,637866,593438,642232,353148,638127,444865,772786,590266,490976,711388,262526,573464,90842,518696,734193,378925,635454,372723,462206,52722,539333,520995,112815,43216,569098,331132,522801,642476,244266,490053,654533,341084,281172,677257,692679,167583,183226,708869,429871,529003,32363,564267,412926,186260,767602,758951,220974,404763,213880,655243,204043};
static const uint32_t omega_2560[2560]={582294,322592,150024,635863,569027,581227,16456,497749,152979,582862,158118,250511,630085,107210,681653,753778,84444,372633,546424,122950,128941,333240,564257,412289,162812,176658,685432,76010,84110,563131,92896,120831,502560,92138,70008,514650,392230,369100,628879,274379,151089,131634,659520,374553,619351,98527,164576,493356,374129,378030,564145,466787,418829,729460,754428,243773,523485,611528,226116,260415,399162,745005,702270,247996,357078,463562,743095,764363,431412,635789,353240,344712,353723,599290,277811,271654,176106,282577,386584,122825,7913,304230,551737,573225,77270,646049,228863,532442,127987,769469,436856,504743,582647,388632,357286,138534,603361,409183,527094,771864,656345,590558,665858,563880,22201,514000,232901,218248,563775,171213,19615,65712,478772,84572,534167,701468,386446,609632,477237,509749,21252,234378,576677,467875,225146,480612,644061,21161,572418,148210,427426,85365,274199,70812,403204,484819,261622,245495,273099,102471,147916,374643,267809,746103,643607,158141,561057,290744,203517,639507,418572,392890,663449,155363,653829,304049,457958,280543,341151,58122,618883,46479,87297,509150,550525,659382,77999,305314,304046,417452,154509,90175,199856,560428,414957,151542,764513,106629,670601,368264,308261,143029,192693,199005,37280,436798,504988,757193,758836,225153,575126,677020,84531,763946,284605,351005,718821,461713,62088,115906,590895,515866,360081,275296,782008,532458,344019,397169,469793,271069,111046,773499,14646,343320,359603,88228,545736,233906,470621,483671,428546,323746,64112,26319,496605,373911,568038,544886,507621,273353,398535,112861,212077,279199,211766,780243,202258,91070,533731,298123,347928,691300,186285,631260,304840,170986,88105,451712,550039,364298,27877,381974,547485,348074,312509,314172,50529,718488,665713,172812,458566,656149,294249,526367,356242,142944,611745,22606,498783,13549,415485,230349,229028,410189,9608,472651,475096,586324,683743,771962,412819,268623,769677,111828,365009,227467,484314,493361,441639,65846,721318,491684,516254,115330,647353,601529,741071,70589,525702,777744,145283,75122,628110,75034,223295,555962,433822,274447,285864,116081,603662,556480,377609,363330,275078,188655,513199,384853,251693,138868,412863,79350,529213,398245,114086,301446,563497,334462,613120,570553,34532,151269,211911,387950,549254,732282,472383,773365,555461,719569,377516,674366,284829,242009,206787,139470,707457,563741,495506,419072,93641,779489,205443,10085,646217,147116,540097,82145,665975,576892,237361,118371,188802,147910,293631,15741,244151,143714,41231,514652,419234,714243,535076,441010,190059,669343,616690,204311,393041,352168,754427,230271,742594,266749,534481,240930,521988,766420,4030,361151,621938,560317,482957,188450,95372,650621,74488,684813,335243,191128,219122,614108,593392,545837,30886,274720,55105,618121,725009,192462,213487,516355,695671,451452,172963,147285,471852,654052,181551,165033,396882,511524,486472,646320,754461,689339,343137,238820,233764,120059,262709,38310,243360,430686,233669,404091,710678,185467,553678,146333,151724,88433,180202,751499,647826,721087,506166,211968,374203,593817,17299,129520,317288,604628,282275,225785,491419,71668,210501,150794,65349,277712,501678,717150,617340,363640,543893,417272,74232,361745,25155,447497,41101,326114,702408,544550,671115,258043,490219,319849,715366,30602,356957,396542,621010,564237,142249,628187,331327,585844,469671,190547,208070,228594,33848,316233,460516,350775,746805,721679,665740,537366,26150,564850,585365,269101,173384,348100,663561,100865,397812,534608,388962,112780,685137,9725,485663,690256,190695,639644,701624,142675,113151,210852,189830,710829,657547,369381,506136,590269,680585,434140,651278,328331,85263,463717,485822,486991,603609,624235,239971,107346,167842,722672,756089,736487,62940,652556,349945,507199,59036,425935,321269,304181,673500,342512,417041,88714,57459,284028,393961,240232,497924,165746,623476,175646,338545,123155,546768,67472,741462,649705,240432,64880,212162,643508,388165,318740,625507,180573,277214,44570,162892,473457,390654,240695,482462,555209,450509,757714,743129,440070,31955,607860,52523,223841,94444,654541,517141,341189,571198,126351,614305,119842,466219,583303,628973,760206,705590,423059,657567,639421,40761,435600,780173,40479,544841,683392,732926,550700,672149,118613,322842,392080,693883,594067,259355,187540,342328,282756,453359,70364,621196,725526,122747,521479,160790,293249,341504,124162,42784,332511,121631,337106,277802,150136,581365,313010,28425,730821,329986,496965,534465,24898,110927,733483,237704,49391,237071,119596,278171,432208,416327,631979,612446,87176,442130,428440,459256,572197,297712,282133,658584,270457,464793,130115,517368,272699,185198,55084,334579,626132,2352,422264,107170,141573,117806,393782,173457,550385,335824,202180,604636,390291,39635,116207,738192,366381,734908,677390,380105,379799,164992,626661,94661,451031,755509,738937,241678,437791,595337,172953,12265,312859,339706,131757,753544,58420,725674,554321,211148,269617,90167,91840,746578,6808,268379,608633,305876,58560,265871,430140,695187,183372,467984,130142,98561,623644,93899,346200,77313,443274,207508,474080,185429,40602,638865,367259,55888,223133,718721,678235,38880,105890,92955,134088,108905,66713,677137,97543,195745,672337,306906,648483,191569,689977,340442,668897,78325,6800,160363,11422,681088,175397,109991,629387,83146,80979,589863,682300,89240,109262,186761,7963,195969,563341,578233,326240,53577,354451,245053,572103,595246,510993,367159,272410,199925,708705,180295,440463,638075,667733,29217,457351,701800,168944,718017,573159,752860,223384,190918,517146,408699,259014,283524,639202,217267,635450,476228,203368,194431,164651,722645,391535,385542,154239,361440,607211,690057,637241,374119,243010,405152,152441,369035,534610,415966,457923,591334,176356,524633,444604,147865,469402,475314,396316,703002,731128,558295,599548,627883,143524,609295,627229,713548,551518,749731,277120,342104,391752,182032,392607,759188,277691,218136,618273,427230,572417,134708,646535,523947,582564,51327,526030,506234,346743,358650,537959,199226,671139,582091,715130,760935,364855,498242,542577,665943,144828,198600,52497,656150,307751,307258,701021,617940,631230,683141,477368,711789,302330,748850,132273,670327,585521,25330,460264,81715,343642,7081,37620,327312,427223,477903,101749,583165,332419,446169,127748,675935,318720,355467,645948,431883,728343,556553,579894,35593,376393,395479,368882,35526,255120,191923,769519,328595,516347,587655,637602,548175,264122,315972,69938,352871,62640,518761,280321,477151,131938,63962,351102,461793,358887,604489,755580,130857,352159,632909,635530,773027,691951,359116,563003,714723,749148,239064,394808,709372,569158,783267,297534,228860,491936,1953,518493,578590,446288,167764,452877,612649,477999,614580,699448,530041,610847,431586,635054,612963,17461,750122,72875,56834,462249,248911,177632,519243,521397,620348,242884,270622,342540,11736,220550,310939,266779,156180,717909,681665,132441,588580,593176,762849,356770,221751,76260,326166,621151,117936,582320,673644,720078,199785,385147,304476,739785,724320,289916,774276,322007,84964,343424,197089,18361,368146,281747,146978,243543,551469,88133,46407,681875,617778,10628,144193,241801,531815,279204,279276,468059,359431,115967,631156,467354,240853,265695,403871,90321,604426,688315,617587,565190,475879,191336,677455,474374,238212,641519,166961,577825,300951,146895,689599,720213,455833,573150,631342,628643,221351,158987,233334,581087,476259,621930,452301,669107,563662,212209,494741,273735,72772,232850,313007,771280,604787,79010,638699,476010,393376,175172,205485,577169,60610,527336,122543,117154,207449,460823,579084,66027,31736,1005,252373,703257,257333,304131,781761,330908,412033,623105,649931,158440,681350,579477,672147,91609,761060,485883,527252,555097,505007,230370,512570,509066,199718,263874,100920,357061,234028,551143,386647,190090,304544,91199,708767,234058,172842,80265,349767,453926,675749,157431,374969,752656,602420,237577,684720,646279,200879,272476,307696,348009,218240,455759,357363,394827,182549,322892,283819,705487,599075,508325,378429,467916,778728,114114,679502,695333,587942,595871,332772,512209,335010,178606,353054,183423,373225,705998,448348,564249,304273,348962,551870,18908,703491,283357,734451,773864,242710,271357,82817,338987,607512,53993,487756,748946,645104,3249,783143,190008,764102,40834,637885,452436,141794,751665,539075,383599,554127,725204,475269,572087,379214,99932,334222,506084,671526,323838,522935,235677,98472,205327,10575,211948,104163,275831,171968,29932,710949,711065,710575,361483,404436,668702,578879,431561,297504,607161,14957,625637,369111,777401,214263,26853,656424,90494,590189,383786,728918,486593,713340,93185,106104,632300,246422,255677,662288,146761,447053,313101,473746,375927,370435,636746,740878,598147,512245,37721,124292,231322,49337,291324,201067,460769,633337,147498,214334,202134,766905,285612,630382,200499,625243,532850,153276,676151,101708,29583,698917,410728,236937,660411,654420,450121,219104,371072,620549,606703,97929,707351,699251,220230,690465,662530,280801,691223,713353,268711,391131,414261,154482,508982,632272,651727,123841,408808,164010,684834,618785,290005,409232,405331,219216,316574,364532,53901,28933,539588,259876,171833,557245,522946,384199,38356,81091,535365,426283,319799,40266,18998,351949,147572,430121,438649,429638,184071,505550,511707,607255,500784,396777,660536,775448,479131,231624,210136,706091,137312,554498,250919,655374,13892,346505,278618,200714,394729,426075,644827,180000,374178,256267,11497,127016,192803,117503,219481,761160,269361,550460,565113,219586,612148,763746,717649,304589,698789,249194,81893,396915,173729,306124,273612,762109,548983,206684,315486,558215,302749,139300,762200,210943,635151,355935,697996,509162,712549,380157,298542,521739,537866,510262,680890,635445,408718,515552,37258,139754,625220,222304,492617,579844,143854,364789,390471,119912,627998,129532,479312,325403,502818,442210,725239,164478,736882,696064,274211,232836,123979,705362,478047,479315,365909,628852,693186,583505,222933,368404,631819,18848,676732,112760,415097,475100,640332,590668,584356,746081,346563,278373,26168,24525,558208,208235,106341,698830,19415,498756,432356,64540,321648,721273,667455,192466,267495,423280,508065,1353,250903,439342,386192,313568,512292,672315,9862,768715,440041,423758,695133,237625,549455,312740,299690,354815,459615,719249,757042,286756,409450,215323,238475,275740,510008,384826,670500,571284,504162,571595,3118,581103,692291,249630,485238,435433,92061,597076,152101,478521,612375,695256,331649,233322,419063,755484,401387,235876,435287,470852,469189,732832,64873,117648,610549,324795,127212,489112,256994,427119,640417,171616,760755,284578,769812,367876,553012,554333,373172,773753,310710,308265,197037,99618,11399,370542,514738,13684,671533,418352,555894,299047,290000,341722,717515,62043,291677,267107,668031,136008,181832,42290,712772,257659,5617,638078,708239,155251,708327,560066,227399,349539,508914,497497,667280,179699,226881,405752,420031,508283,594706,270162,398508,531668,644493,370498,704011,254148,385116,669275,481915,219864,448899,170241,212808,748829,632092,571450,395411,234107,51079,310978,9996,227900,63792,405845,108995,498532,541352,576574,643891,75904,219620,287855,364289,689720,3872,577918,773276,137144,636245,243264,701216,117386,206469,546000,664990,594559,635451,489730,767620,539210,639647,742130,268709,364127,69118,248285,342351,593302,114018,166671,579050,390320,431193,28934,553090,40767,516612,248880,542431,261373,16941,779331,422210,161423,223044,300404,594911,687989,132740,708873,98548,448118,592233,564239,169253,189969,237524,752475,508641,728256,165240,58352,590899,569874,267006,87690,331909,610398,636076,311509,129309,601810,618328,386479,271837,296889,137041,28900,94022,440224,544541,549597,663302,520652,745051,540001,352675,549692,379270,72683,597894,229683,637028,631637,694928,603159,31862,135535,62274,277195,571393,409158,189544,766062,653841,466073,178733,501086,557576,291942,711693,572860,632567,718012,505649,281683,66211,166021,419721,239468,366089,709129,421616,758206,335864,742260,457247,80953,238811,112246,525318,293142,463512,67995,752759,426404,386819,162351,219124,641112,155174,452034,197517,313690,592814,575291,554767,749513,467128,322845,432586,36556,61682,117621,245995,757211,218511,197996,514260,609977,435261,119800,682496,385549,248753,394399,670581,98224,773636,297698,93105,592666,143717,81737,640686,670210,572509,593531,72532,125814,413980,277225,193092,102776,349221,132083,455030,698098,319644,297539,296370,179752,159126,543390,676015,615519,60689,27272,46874,720421,130805,433416,276162,724325,357426,462092,479180,109861,440849,366320,694647,725902,499333,389400,543129,285437,617615,159885,607715,444816,660206,236593,715889,41899,133656,542929,718481,571199,139853,395196,464621,157854,602788,506147,738791,620469,309904,392707,542666,300899,228152,332852,25647,40232,343291,751406,175501,730838,559520,688917,128820,266220,442172,212163,657010,169056,663519,317142,200058,154388,23155,77771,360302,125794,143940,742600,347761,3188,742882,238520,99969,50435,232661,111212,664748,460519,391281,89478,189294,524006,595821,441033,500605,330002,712997,162165,57835,660614,261882,622571,490112,441857,659199,740577,450850,661730,446255,505559,633225,201996,470351,754936,52540,453375,286396,248896,758463,672434,49878,545657,733970,546290,663765,505190,351153,367034,151382,170915,696185,341231,354921,324105,211164,485649,501228,124777,512904,318568,653246,265993,510662,598163,728277,448782,157229,781009,361097,676191,641788,665555,389579,609904,232976,447537,581181,178725,393070,743726,667154,45169,416980,48453,105971,403256,403562,618369,156700,688700,332330,27852,44424,541683,345570,188024,610408,771096,470502,443655,651604,29817,724941,57687,229040,572213,513744,693194,691521,36783,776553,514982,174728,477485,724801,517490,353221,88174,599989,315377,653219,684800,159717,689462,437161,706048,340087,575853,309281,597932,742759,144496,416102,727473,560228,64640,105126,744481,677471,690406,649273,674456,716648,106224,685818,587616,111024,476455,134878,591792,93384,442919,114464,705036,776561,622998,771939,102273,607964,673370,153974,700215,702382,193498,101061,694121,674099,596600,775398,587392,220020,205128,457121,729784,428910,538308,211258,188115,272368,416202,510951,583436,74656,603066,342898,145286,115628,754144,326010,81561,614417,65344,210202,30501,559977,592443,266215,374662,524347,499837,144159,566094,147911,307133,579993,588930,618710,60716,391826,397819,629122,421921,176150,93304,146120,409242,540351,378209,630920,414326,248751,367395,325438,192027,607005,258728,338757,635496,313959,308047,387045,80359,52233,225066,183813,155478,639837,174066,156132,69813,231843,33630,506241,441257,391609,601329,390754,24173,505670,565225,165088,356131,210944,648653,136826,259414,200797,732034,257331,277127,436618,424711,245402,584135,112222,201270,68231,22426,418506,285119,240784,117418,638533,584761,730864,127211,475610,476103,82340,165421,152131,100220,305993,71572,481031,34511,651088,113034,197840,758031,323097,701646,439719,776280,745741,456049,356138,305458,681612,200196,450942,337192,655613,107426,464641,427894,137413,351478,55018,226808,203467,747768,406968,387882,414479,747835,528241,591438,13842,454766,267014,195706,145759,235186,519239,467389,713423,430490,720721,264600,503040,306210,651423,719399,432259,321568,424474,178872,27781,652504,431202,150452,147831,10334,91410,424245,220358,68638,34213,544297,388553,73989,214203,94,485827,554501,291425,781408,264868,204771,337073,615597,330484,170712,305362,168781,83913,253320,172514,351775,148307,170398,765900,33239,710486,726527,321112,534450,605729,264118,261964,163013,540477,512739,440821,771625,562811,472422,516582,627181,65452,101696,650920,194781,190185,20512,426591,561610,707101,457195,162210,665425,201041,109717,63283,583576,398214,478885,43576,59041,493445,9085,461354,698397,439937,586272,765000,415215,501614,636383,539818,231892,695228,736954,101486,165583,772733,639168,541560,251546,504157,504085,315302,423930,667394,152205,316007,542508,517666,379490,693040,178935,95046,165774,218171,307482,592025,105906,308987,545149,141842,616400,205536,482410,636466,93762,63148,327528,210211,152019,154718,562010,624374,550027,202274,307102,161431,331060,114254,219699,571152,288620,509626,710589,550511,470354,12081,178574,704351,144662,307351,389985,608189,577876,206192,722751,256025,660818,666207,575912,322538,204277,717334,751625,782356,530988,80104,526028,479230,1600,452453,371328,160256,133430,624921,102011,203884,111214,691752,22301,297478,256109,228264,278354,552991,270791,274295,583643,519487,682441,426300,549333,232218,396714,593271,478817,692162,74594,549303,610519,703096,433594,329435,107612,625930,408392,30705,180941,545784,98641,137082,582482,510885,475665,435352,565121,327602,425998,388534,600812,460469,499542,77874,184286,275036,404932,315445,4633,669247,103859,88028,195419,187490,450589,271152,448351,604755,430307,599938,410136,77363,335013,219112,479088,434399,231491,764453,79870,500004,48910,9497,540651,512004,700544,444374,175849,729368,295605,34415,138257,780112,218,593353,19259,742527,145476,330925,641567,31696,244286,399762,229234,58157,308092,211274,404147,683429,449139,277277,111835,459523,260426,547684,684889,578034,772786,571413,679198,507530,611393,753429,72412,72296,72786,421878,378925,114659,204482,351800,485857,176200,768404,157724,414250,5960,569098,756508,126937,692867,193172,399575,54443,296768,70021,690176,677257,151061,536939,527684,121073,636600,336308,470260,309615,407434,412926,146615,42483,185214,271116,745640,659069,552039,734024,492037};

/* multiplication inverses of omega */

/* (in Montgomery form) */
static const uint32_t w_4_inv[3][3]={{740577,201067,42784},
{201067,582294,201067},
{42784,201067,740577}};

static const uint32_t w_9_inv[8][8]={{697407,519802,438548,268617,681581,545880,600698,365339},
{519802,268617,545880,365339,697407,438548,681581,600698},
{438548,545880,582294,438548,545880,582294,438548,545880},
{268617,365339,438548,600698,519802,545880,697407,681581},
{681581,697407,545880,519802,600698,438548,365339,268617},
{545880,438548,582294,545880,438548,582294,545880,438548},
{600698,681581,438548,697407,365339,545880,268617,519802},
{365339,600698,545880,681581,268617,438548,519802,697407}};

static const uint32_t omega_256_inv[128]={582294,412926,677257,569098,378925,772786,404147,145476,175849,231491,448351,404932,565121,408392,478817,270791,102011,530988,722751,470354,307102,93762,307482,152205,165583,586272,583576,20512,771625,726527,168781,554501,424245,321568,467389,747835,427894,456049,34511,127211,201270,259414,601329,155478,258728,409242,588930,592443,145286,538308,694121,622998,587616,64640,706048,517490,572213,188024,403256,447537,448782,485649,505190,453375,740577,330002,111212,125794,212163,40232,506147,41899,389400,724325,543390,102776,81737,385549,117621,313690,67995,758206,718012,766062,631637,520652,386479,569874,564239,161423,28934,364127,546000,689720,405845,748829,370498,179699,638078,62043,370542,367876,324795,755484,435433,384826,354815,672315,192466,208235,475100,628852,164478,364789,635445,355935,762109,763746,127016,346505,775448,430121,384199,219216,632272,690465,654420,625243};
static const uint32_t omega_1024_inv[1024]={582294,66992,37721,551264,412926,581271,146761,485063,677257,150456,383786,740778,569098,323317,607161,602108,378925,309655,29932,157782,772786,241091,323838,712028,404147,770379,383599,241542,145476,489543,3249,153270,175849,316593,773864,215996,231491,537145,705998,178274,448351,616267,695333,614757,404932,197648,322892,398324,565121,44565,646279,505353,408392,432481,80265,171284,478817,293636,357061,96312,270791,80080,485883,637821,102011,153383,330908,333800,530988,111748,460823,295408,722751,68049,476010,608232,470354,597470,212209,497686,307102,297921,628643,478444,93762,584491,641519,46445,307482,604454,90321,639161,152205,399025,279204,581118,165583,565751,243543,83634,586272,360981,289916,77413,583576,16801,621151,693546,20512,763666,717909,709790,771625,568237,521397,462188,726527,417608,635054,242726,168781,725295,446288,516776,554501,383352,394808,260377,424245,709454,352159,607194,321568,591922,280321,366905,467389,71342,516347,284716,747835,776150,579894,316159,427894,690636,332419,639438,456049,406543,460264,394896,34511,208876,631230,728513,127211,278893,542577,437116,201270,676036,346743,336507,259414,634873,618273,709676,601329,259717,551518,366319,155478,134622,396316,520304,258728,365984,534610,464892,409242,66794,154239,56643,588930,126155,639202,776922,592443,385188,168944,75482,145286,727957,272410,464592,538308,409326,563341,340340,694121,164816,629387,64357,622998,635289,689977,474929,587616,472123,134088,93368,64640,234903,40602,580845,706048,156763,130142,286963,517490,466665,6808,329844,572213,1551,131757,610527,188024,170511,451031,716655,403256,511349,116207,250199,447537,747125,141573,554968,448782,133165,130115,658925,485649,205807,87176,503817,505190,274844,733483,652445,453375,397577,150136,208112,740577,639905,521479,144900,330002,629576,594067,62524,111212,127401,40479,273416,125794,622172,583303,557266,212163,580145,223841,694884,40232,426682,240695,556874,506147,756155,643508,585120,41899,759209,175646,356926,389400,111586,342512,104362,724325,550257,736487,206094,543390,291021,463717,523070,102776,59273,710829,152287,81737,666040,9725,124596,385549,185974,269101,180463,117621,644570,316233,772071,313690,409069,564237,675555,67995,436573,544550,731999,758206,560155,363640,70327,718012,712479,225785,547894,766062,407794,721087,564594,631637,663084,404091,700468,520652,77677,689339,154055,386479,255886,147285,635641,569874,396814,274720,410817,564239,706029,650621,78722,161423,632072,240930,220764,28934,618476,669343,202432,364127,440497,15741,137151,546000,108180,147116,410671,689720,475825,139470,629358,405845,8531,732282,370111,748829,254508,301446,287159,370498,378660,188655,384726,179699,226968,555962,710501,638078,101115,601529,173673,62043,615825,227467,325615,370542,265727,472651,345614,367876,378657,142944,294148,324795,409978,314172,703054,755484,603174,170986,638357,435433,408312,780243,276055,384826,136677,373911,680715,354815,341894,88228,82560,672315,51858,532458,576030,192466,484219,351005,257638,208235,264645,436798,56070,475100,59699,151542,480587,628852,529533,659382,398709,164478,179447,304049,781020,364789,343698,158141,759342,635445,716866,484819,92873,355935,173392,480612,226416,762109,494730,701468,90432,763746,370147,514000,558083,127016,441122,138534,468024,346505,626906,646049,134287,775448,67213,271654,695835,430121,155551,463562,511418,384199,766771,243773,454700,219216,726249,98527,336223,632272,154886,514650,278440,690465,76975,176658,109550,654420,778732,753778,459765,625243,374470,581227,259694,201067,716369,745640,232097,370435,202090,636600,298298,106104,632905,399575,42583,214263,460044,176200,181253,404436,473706,753429,625579,10575,542270,459523,71333,379214,12982,399762,541819,637885,293818,780112,630091,607512,466768,9497,567365,551870,246216,77363,605087,335010,167094,88028,168604,378429,585713,460469,385037,218240,738796,137082,278008,374969,350880,703096,612077,304544,489725,426300,687049,512570,703281,297478,145540,681350,629978,452453,449561,252373,671613,322538,487953,60610,715312,307351,175129,313007,185891,571152,285675,476259,485440,154718,304917,689599,198870,141842,736916,475879,178907,693040,144200,631156,384336,504157,202243,617778,217610,539818,699727,197089,422380,493445,705948,199785,766560,162210,89815,762849,19695,65452,73571,11736,215124,261964,321173,56834,365753,148307,540635,614580,58066,337073,266585,228860,400009,388553,522984,359116,73907,431202,176167,461793,191439,503040,416456,315972,712019,267014,498645,35526,7211,203467,467202,355467,92725,450942,143923,327312,376818,323097,388465,748850,574485,152131,54848,656150,504468,240784,346245,582091,107325,436618,446854,523947,148488,165088,73685,182032,523644,231843,417042,627883,648739,387045,263057,524633,417377,248751,318469,374119,716567,629122,726718,194431,657206,144159,6439,190918,398173,614417,707879,638075,55404,510951,318769,245053,374035,220020,443021,89240,618545,153974,719004,160363,148072,93384,308432,195745,311238,649273,689993,718721,548458,742759,202516,77313,626598,653219,496398,265871,316696,776553,453517,211148,781810,651604,172834,595337,612850,332330,66706,380105,272012,667154,533162,335824,36236,641788,228393,334579,650196,653246,124436,297712,577554,696185,279544,278171,508517,49878,130916,329986,385784,633225,575249,42784,143456,261882,638461,453359,153785,189294,720837,672149,655960,742882,509945,657567,161189,200058,226095,571198,203216,559520,88477,743129,356679,542666,226487,277214,27206,139853,198241,741462,24152,607715,426435,393961,671775,440849,678999,59036,233104,46874,577267,239971,492340,319644,260291,680585,724088,72532,631074,701624,117321,773636,658765,397812,597387,514260,602898,665740,138791,467128,11290,469671,374292,219124,107806,715366,346788,238811,51362,25155,223206,419721,713034,65349,70882,557576,235467,17299,375567,62274,218767,151724,120277,379270,82893,262709,705684,94022,629306,396882,527475,636076,147720,213487,386547,508641,372544,219122,77332,132740,704639,621938,151289,542431,562597,754427,164885,114018,580929,419234,342864,767620,646210,237361,675181,636245,372690,93641,307536,643891,154003,377516,774830,51079,413250,34532,528853,481915,496202,412863,404701,594706,398635,603662,556393,227399,72860,145283,682246,181832,609688,721318,167536,555894,457746,412819,517634,310710,437747,415485,404704,640417,489213,458566,373383,469189,80307,27877,180187,612375,145004,347928,375049,3118,507306,398535,646684,409450,102646,428546,441467,695133,700801,111046,731503,250903,207331,590895,299142,432356,525723,575126,518716,346563,727291,308261,723662,631819,302774,154509,253828,123979,384652,618883,603914,479312,2341,418572,439663,625220,24019,147916,66495,298542,690488,427426,609969,302749,556945,21252,288631,81893,692929,19615,413214,269361,225278,656345,342239,644827,315337,436856,156455,137312,649074,7913,716148,511707,87526,353240,627810,319799,271943,399162,16590,539588,328661,564145,57112,684834,447138,151089,628475,268711,504921,92896,706386,606703,673811,128941,4629,29583,323596,158118,408891,202134,523667};
static const uint32_t omega_2304_inv[2304]={582294,204043,655243,213880,404763,220974,758951,767602,186260,412926,564267,32363,529003,429871,708869,183226,167583,692679,677257,281172,341084,654533,490053,244266,642476,522801,331132,569098,43216,112815,520995,539333,52722,462206,372723,635454,378925,734193,518696,90842,573464,262526,711388,490976,590266,772786,444865,638127,353148,642232,593438,637866,374128,39293,404147,771721,467444,5701,202040,288007,722094,428762,602924,145476,353734,3855,293401,27387,94605,598133,251463,514166,175849,553474,623811,54245,210723,583498,587483,477253,456794,231491,144668,343649,313288,148600,78606,83353,632203,283086,448351,637040,311465,307144,219279,508022,246528,199529,3625,404932,714623,540079,665066,705867,31355,718079,451362,31839,565121,176814,238795,328905,330919,730286,73403,552610,450150,408392,637590,351293,707304,312027,382024,386040,366361,69355,478817,325072,101780,405561,201849,513457,454943,308247,307698,270791,569262,522260,317593,189729,362182,396272,486315,292622,102011,296951,213244,113729,57345,648852,346433,611742,51941,530988,744529,159073,119160,254076,313129,467522,233539,643349,722751,781137,553945,432880,97826,606342,729122,590164,474844,470354,672201,396455,237497,454252,639919,104053,778106,317365,307102,96597,149877,675279,770322,297770,255460,438988,705352,93762,485813,393002,334977,49928,134542,533321,508973,674316,307482,423216,70278,41456,455382,23844,712556,769260,329112,152205,425118,142493,257362,511203,137897,149583,599866,613390,165583,334206,147920,442409,514400,76002,310679,361321,231374,586272,73366,444533,451716,282512,338419,703678,687535,535492,583576,31960,135201,108177,290534,269851,173605,265638,401208,20512,380116,296299,658835,522419,782032,34796,585547,305724,771625,187028,306171,510590,697407,387247,758564,420536,75608,726527,60418,224753,46995,184220,720974,290686,713843,611782,168781,275232,224286,249610,585080,508339,389124,757754,404609,554501,490234,772967,190205,185856,16203,327303,351643,162932,424245,725904,590718,526356,531594,164572,514519,423601,411502,321568,50289,405662,496870,572698,375123,595605,700785,70692,467389,628407,162024,122060,108005,571483,742913,138903,738026,747835,415567,445018,301679,706595,591121,136797,69927,582907,427894,417579,55182,597617,310949,366630,71743,403916,96970,456049,405429,599638,730763,683359,87811,336884,136748,710159,34511,536423,169583,267791,423233,119935,167768,449703,669427,127211,270217,459330,588898,693663,418077,726479,703571,374988,201270,388920,161870,455587,622649,576848,746858,695194,189962,259414,238207,178079,17055,465912,230895,753835,707625,466307,601329,186647,759992,674919,502123,249491,237481,407516,428877,155478,585219,130997,362069,66199,660473,606851,649189,547449,258728,584484,334145,753100,127412,73977,662542,383512,32322,409242,770357,400005,423354,473376,99131,501442,610373,753258,588930,3774,56800,623629,305984,747724,91336,449716,707400,592443,81554,77490,740322,404202,149015,507460,171648,32768,145286,582105,435335,218632,184857,231568,369585,86327,702286,538308,192141,357385,484733,371766,190140,779352,40126,487257,694121,189173,304828,504492,119091,52527,675972,444492,331955,622998,29555,160445,209967,725305,407761,361161,547375,42574,587616,82385,154758,48821,34439,326111,3255,107523,730283,64640,23439,312912,617026,602646,116799,407844,603604,565034,706048,560056,265808,114417,500271,323326,485241,288912,232155,517490,484921,137553,711481,762629,543986,326998,244099,154669,572213,525160,171522,448083,637573,301636,580992,317706,519802,188024,82043,722498,42124,56527,609557,719805,9481,276366,403256,519193,759218,764148,280819,93332,13144,8935,248222,447537,609429,345917,671228,687766,426882,594971,415593,520964,448782,329269,610802,439645,274366,44783,773217,137094,154103,485649,697319,130199,381194,311693,189771,484864,754417,57564,505190,591227,446423,488879,731817,628649,85545,768147,211483,453375,428285,776329,610275,467000,275499,220832,344169,265486,740577,365696,476973,422275,455061,652925,493251,185292,718842,330002,401812,218074,121661,509248,694230,507562,469590,7279,111212,538798,56709,357818,182804,501643,414133,173109,383544,125794,47965,667507,2418,12729,363442,159927,263611,747229,212163,89572,780599,549169,582682,554030,681165,729386,577947,40232,13522,329712,338083,505583,172458,48695,449754,35037,506147,253180,45996,399585,763256,25370,469836,725845,418379,41899,182663,89782,610648,773172,5649,50148,777162,693385,389400,780589,519959,646621,96570,71010,612906,318541,608754,724325,678625,360295,367872,566181,139630,511510,251283,771747,543390,152804,608075,307688,241581,633201,64800,490799,73249,102776,181433,413757,641535,124223,159240,606967,204664,119101,81737,612033,118591,158749,739478,288961,375284,282525,376392,385549,498872,153652,735000,525860,649500,672519,541972,710992,117621,458823,674673,566918,725685,734380,281562,696913,510995,313690,539481,485030,455942,92882,265416,536107,29908,408197,67995,423062,403805,556100,460747,27789,485486,221196,624052,758206,158179,641230,16679,150977,754935,3920,483266,3464,718012,255655,225222,633583,397261,241740,314279,693228,714164,766062,388086,75839,617917,71813,608386,432758,524825,759709,631637,196522,620510,595717,244576,764625,107414,411894,683239,520652,320791,130755,438548,203473,556995,724959,180456,693384,386479,81958,474213,193925,84922,515086,513086,154613,408637,569874,743190,164659,768646,102340,474599,538070,280304,155739,564239,733936,551360,715705,567157,640443,67935,247802,4078,161423,716622,112270,495772,498884,188704,501601,291451,598325,28934,696587,342110,518035,510144,178002,575499,723234,625258,364127,594090,192275,748799,97967,234842,532607,773462,69378,546000,726365,370577,633876,469753,483402,400720,161786,210223,689720,650989,321722,500123,674379,491505,568753,602193,360308,405845,248052,734328,129670,402707,482286,274328,717146,76152,748829,185597,43025,338265,253844,418818,540857,587521,588251,370498,403117,113174,2912,672342,24955,40982,637550,234453,179699,48909,291487,703481,112098,776721,188585,154002,190628,638078,210019,93836,701967,389870,586737,648270,213133,572859,62043,271212,232281,102175,775995,418022,565824,663555,209041,370542,531641,301859,449014,223580,537467,85663,329464,397036,367876,577865,584071,694494,495345,34978,333808,552084,480426,324795,76024,374941,63983,454425,361891,329622,75193,297673,755484,40827,184795,50466,139318,383519,52769,599493,307218,435433,504890,498288,14510,82216,444470,267693,136975,589865,384826,737072,311284,561804,671550,61606,561457,441324,478559,354815,28012,353508,127070,641717,655845,405600,315768,342431,672315,729449,761970,185769,545437,648564,288546,729791,194230,192466,523349,365118,355357,44472,648147,637211,27595,702173,208235,366299,671614,248550,622264,235624,466746,316926,591505,475100,434769,132068,357016,190245,302696,543808,590421,442180,628852,678508,18538,97589,697426,442746,715416,506349,59861,164478,239945,554611,28183,69638,522099,630673,514122,47325,364789,177709,503007,481572,538817,112208,314670,268617,485896,635445,352636,713402,106982,716744,468632,342405,596369,582346,355935,166088,242589,444125,43309,384468,474715,93545,635317,762109,591788,518382,740370,544410,782141,353185,750309,591872,763746,673299,470269,423916,548256,265892,359781,433200,249185,127016,483983,531099,285399,154375,496800,368228,39335,526829,346505,38693,218269,691256,437479,214368,263489,390867,365530,775448,386957,694835,708045,126405,265974,599303,535589,83552,430121,655758,151473,637029,279334,455813,499434,228532,118400,384199,472327,168446,80058,407840,591920,120593,523064,315994,219216,323999,100991,450975,468134,454469,490415,518307,521295,632272,484635,85508,660070,213049,327495,129114,345353,590506,690465,477051,650113,113009,304308,552294,310475,548798,282352,654420,159980,418424,173344,286618,581630,614582,513971,389615,625243,320312,298318,289446,225247,706608,629094,602029,664625,201067,579318,128118,569481,378598,562387,24410,15759,597101,370435,219094,750998,254358,353490,74492,600135,615778,90682,106104,502189,442277,128828,293308,539095,140885,260560,452229,214263,740145,670546,262366,244028,730639,321155,410638,147907,404436,49168,264665,692519,209897,520835,71973,292385,193095,10575,338496,145234,430213,141129,189923,145495,409233,744068,379214,11640,315917,777660,581321,495354,61267,354599,180437,637885,429627,779506,489960,755974,688756,185228,531898,269195,607512,229887,159550,729116,572638,199863,195878,306108,326567,551870,638693,439712,470073,634761,704755,700008,151158,500275,335010,146321,471896,476217,564082,275339,536833,583832,779736,378429,68738,243282,118295,77494,752006,65282,331999,751522,218240,606547,544566,454456,452442,53075,709958,230751,333211,374969,145771,432068,76057,471334,401337,397321,417000,714006,304544,458289,681581,377800,581512,269904,328418,475114,475663,512570,214099,261101,465768,593632,421179,387089,297046,490739,681350,486410,570117,669632,726016,134509,436928,171619,731420,252373,38832,624288,664201,529285,470232,315839,549822,140012,60610,2224,229416,350481,685535,177019,54239,193197,308517,313007,111160,386906,545864,329109,143442,679308,5255,465996,476259,686764,633484,108082,13039,485591,527901,344373,78009,689599,297548,390359,448384,733433,648819,250040,274388,109045,475879,360145,713083,741905,327979,759517,70805,14101,454249,631156,358243,640868,525999,272158,645464,633778,183495,169971,617778,449155,635441,340952,268961,707359,472682,422040,551987,197089,709995,338828,331645,500849,444942,79683,95826,247869,199785,751401,648160,675184,492827,513510,609756,517723,382153,762849,403245,487062,124526,260942,1329,748565,197814,477637,11736,596333,477190,272771,85954,396114,24797,362825,707753,56834,722943,558608,736366,599141,62387,492675,69518,171579,614580,508129,559075,533751,198281,275022,394237,25607,378752,228860,293127,10394,593156,597505,767158,456058,431718,620429,359116,57457,192643,257005,251767,618789,268842,359760,371859,461793,733072,377699,286491,210663,408238,187756,82576,712669,315972,154954,621337,661301,675356,211878,40448,644458,45335,35526,367794,338343,481682,76766,192240,646564,713434,200454,355467,365782,728179,185744,472412,416731,711618,379445,686391,327312,377932,183723,52598,100002,695550,446477,646613,73202,748850,246938,613778,515570,360128,663426,615593,333658,113934,656150,513144,324031,194463,89698,365284,56882,79790,408373,582091,394441,621491,327774,160712,206513,36503,88167,593399,523947,545154,605282,766306,317449,552466,29526,75736,317054,182032,596714,23369,108442,281238,533870,545880,375845,354484,627883,198142,652364,421292,717162,122888,176510,134172,235912,524633,198877,449216,30261,655949,709384,120819,399849,751039,374119,13004,383356,360007,309985,684230,281919,172988,30103,194431,779587,726561,159732,477377,35637,692025,333645,75961,190918,701807,705871,43039,379159,634346,275901,611713,750593,638075,201256,348026,564729,598504,551793,413776,697034,81075,245053,591220,425976,298628,411595,593221,4009,743235,296104,89240,594188,478533,278869,664270,730834,107389,338869,451406,160363,753806,622916,573394,58056,375600,422200,235986,740787,195745,700976,628603,734540,748922,457250,780106,675838,53078,718721,759922,470449,166335,180715,666562,375517,179757,218327,77313,223305,517553,668944,283090,460035,298120,494449,551206,265871,298440,645808,71880,20732,239375,456363,539262,628692,211148,258201,611839,335278,145788,481725,202369,465655,263559,595337,701318,60863,741237,726834,173804,63556,773880,506995,380105,264168,24143,19213,502542,690029,770217,774426,535139,335824,173932,437444,112133,95595,356479,188390,367768,262397,334579,454092,172559,343716,508995,738578,10144,646267,629258,297712,86042,653162,402167,471668,593590,298497,28944,725797,278171,192134,336938,294482,51544,154712,697816,15214,571878,329986,355076,7032,173086,316361,507862,562529,439192,517875,42784,417665,306388,361086,328300,130436,290110,598069,64519,453359,381549,565287,661700,274113,89131,275799,313771,776082,672149,244563,726652,425543,600557,281718,369228,610252,399817,657567,735396,115854,780943,770632,419919,623434,519750,36132,571198,693789,2762,234192,200679,229331,102196,53975,205414,743129,769839,453649,445278,277778,610903,734666,333607,748324,277214,530181,737365,383776,20105,757991,313525,57516,364982,741462,600698,693579,172713,10189,777712,733213,6199,89976,393961,2772,263402,136740,686791,712351,170455,464820,174607,59036,104736,423066,415489,217180,643731,271851,532078,11614,239971,630557,175286,475673,541780,150160,718561,292562,710112,680585,601928,369604,141826,659138,624121,176394,578697,664260,701624,171328,664770,624612,43883,494400,408077,500836,406969,397812,284489,629709,48361,257501,133861,110842,241389,72369,665740,324538,108688,216443,57676,48981,501799,86448,272366,469671,243880,298331,327419,690479,517945,247254,753453,375164,715366,360299,379556,227261,322614,755572,297875,562165,159309,25155,625182,142131,766682,632384,28426,779441,300095,779897,65349,527706,558139,149778,386100,541621,469082,90133,69197,17299,395275,707522,165444,711548,174975,350603,258536,23652,151724,586839,162851,187644,538785,18736,675947,371467,100122,262709,462570,652606,344813,579888,226366,58402,602905,89977,396882,701403,309148,589436,698439,268275,270275,628748,374724,213487,40171,618702,14715,681021,308762,245291,503057,627622,219122,49425,232001,67656,216204,142918,715426,535559,779283,621938,66739,671091,287589,284477,594657,281760,491910,185036,754427,86774,441251,265326,273217,605359,207862,60127,158103,419234,189271,591086,34562,685394,548519,250754,9899,713983,237361,56996,412784,149485,313608,299959,382641,621575,573138,93641,132372,461639,283238,108982,291856,214608,181168,423053,377516,535309,49033,653691,380654,301075,509033,66215,707209,34532,597764,740336,445096,529517,364543,242504,195840,195110,412863,380244,670187,780449,111019,758406,742379,145811,548908,603662,734452,491874,79880,671263,6640,594776,629359,592733,145283,573342,689525,81394,393491,196624,135091,570228,210502,721318,512149,551080,681186,7366,365339,217537,119806,574320,412819,251720,481502,334347,559781,245894,697698,453897,386325,415485,205496,199290,88867,288016,748383,449553,231277,302935,458566,707337,408420,719378,328936,421470,453739,708168,485688,27877,742534,598566,732895,644043,399842,730592,183868,476143,347928,278471,285073,768851,701145,338891,515668,646386,193496,398535,46289,472077,221557,111811,721755,221904,342037,304802,428546,755349,429853,656291,141644,127516,377761,467593,440930,111046,53912,21391,597592,237924,134797,494815,53570,589131,590895,260012,418243,428004,738889,135214,146150,755766,81188,575126,417062,111747,534811,161097,547737,316615,466435,191856,308261,348592,651293,426345,593116,480665,239553,192940,341181,154509,104853,764823,685772,85935,340615,67945,277012,723500,618883,543416,228750,755178,713723,261262,152688,269239,736036,418572,605652,280354,301789,244544,671153,468691,514744,297465,147916,430725,69959,676379,66617,314729,440956,186992,201015,427426,617273,540772,339236,740052,398893,308646,689816,148044,21252,191573,264979,42991,238951,1220,430176,33052,191489,19615,110062,313092,359445,235105,517469,423580,350161,534176,656345,299378,252262,497962,628986,286561,415133,744026,256532,436856,744668,565092,92105,345882,568993,519872,392494,417831,7913,396404,88526,75316,656956,517387,184058,247772,699809,353240,127603,631888,146332,504027,327548,283927,554829,664961,399162,311034,614915,703303,375521,191441,662768,260297,467367,564145,459362,682370,332386,315227,328892,292946,265054,262066,151089,298726,697853,123291,570312,455866,654247,438008,192855,92896,306310,133248,670352,479053,231067,472886,234563,501009,128941,623381,364937,610017,496743,201731,168779,269390,393746,158118,463049,485043,493915,558114,76753,154267,181332,118736};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 2;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v, x, y, t;
	
	uint32_t q_level = Q << 2, q_level1;
	
	/* first iteration */
	u = a[0];
	v = a[d];
	
	a[0] = u + v;
	a[d] = Q2 + u - v;

	for (j = 1; j < d; j++)
	{
		/* Gentleman-Sande's butterfly
		 * (u, v) <-- (u + v, (u - v) * omega) % Q */
		u = a[j];
		v = a[j + d];
		
		a[j] = u + v;
		a[j + d] = montgomery((Q2 + u - v) * omega[j]);
	} 
	
	d >>= 1;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = u + v;
			a[j1 + d] = q_level + u - v;

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = u + v;
				a[j + d] = montgomery((q_level + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
		
		q_level <<= 1;
	}
	
	/* merged last 2 levels (save some overhead of iterations) */
	q_level1 = q_level << 1;
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 1];
		x = a[j + 2];
		y = a[j + 3];
		t = montgomery((q_level + v - y) * omega[num_of_problems]);
		
		a[j] = barrett_short(u + v + x + y);
		a[j + 1] = barrett_short(q_level1 + u + x - v - y);
		a[j + 2] = barrett_short(q_level + u + t - x);
		a[j + 3] = barrett_short(q_level1 + u - x - t);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n)
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = montgomery((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 6 --> 256 * 10 */
static void ntt_butterfly_1536_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g);
	a[N2_2560 + n2] = b + montgomery(c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4]);
	a[N2_2560 * 2 + n2] = b + montgomery(c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4]);
	a[N2_2560 * 3 + n2] = b + montgomery(c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4]);
	a[N2_2560 * 4 + n2] = b + montgomery(c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4]);
	a[N2_2560 * 5 + n2] = b + montgomery(c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4]);
	a[N2_2560 * 6 + n2] = b + montgomery(c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4]);
	a[N2_2560 * 7 + n2] = b + montgomery(c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4]);
	a[N2_2560 * 8 + n2] = b + montgomery(c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4]);
	a[N2_2560 * 9 + n2] = b + montgomery(c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4]);
}

/* 256 * 10 --> 256 * 4 */
static void ntt_butterfly_2560_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	k = a[N2_2560 * 9 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j + k);
	a[N2_2560 + n2] = b + montgomery(c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7] + k * w_10[0][8]);
	a[N2_2560 * 2 + n2] = b + montgomery(c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7] + k * w_10[1][8]);
	a[N2_2560 * 3 + n2] = b + montgomery(c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7] + k * w_10[2][8]);
}

/* 256 * 3 --> 256 * 9 */
static void ntt_butterfly_768_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	
	a[n2] = barrett_short(b + c + d);
	a[N2_2304 + n2] = b + montgomery(c * w_9[0][0] + d * w_9[0][1]);
	a[N2_2304 * 2 + n2] = b + montgomery(c * w_9[1][0] + d * w_9[1][1]);
	a[N2_2304 * 3 + n2] = b + montgomery(c * w_9[2][0] + d * w_9[2][1]);
	a[N2_2304 * 4 + n2] = b + montgomery(c * w_9[3][0] + d * w_9[3][1]);
	a[N2_2304 * 5 + n2] = b + montgomery(c * w_9[4][0] + d * w_9[4][1]);
	a[N2_2304 * 6 + n2] = b + montgomery(c * w_9[5][0] + d * w_9[5][1]);
	a[N2_2304 * 7 + n2] = b + montgomery(c * w_9[6][0] + d * w_9[6][1]);
	a[N2_2304 * 8 + n2] = b + montgomery(c * w_9[7][0] + d * w_9[7][1]);
}

/* 256 * 6 --> 256 * 9 */
static void ntt_butterfly_1536_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g);
	a[N2_2304 + n2] = b + montgomery(c * w_9[0][0] + d * w_9[0][1] + e * w_9[0][2] + f * w_9[0][3] + g * w_9[0][4]);
	a[N2_2304 * 2 + n2] = b + montgomery(c * w_9[1][0] + d * w_9[1][1] + e * w_9[1][2] + f * w_9[1][3] + g * w_9[1][4]);
	a[N2_2304 * 3 + n2] = b + montgomery(c * w_9[2][0] + d * w_9[2][1] + e * w_9[2][2] + f * w_9[2][3] + g * w_9[2][4]);
	a[N2_2304 * 4 + n2] = b + montgomery(c * w_9[3][0] + d * w_9[3][1] + e * w_9[3][2] + f * w_9[3][3] + g * w_9[3][4]);
	a[N2_2304 * 5 + n2] = b + montgomery(c * w_9[4][0] + d * w_9[4][1] + e * w_9[4][2] + f * w_9[4][3] + g * w_9[4][4]);
	a[N2_2304 * 6 + n2] = b + montgomery(c * w_9[5][0] + d * w_9[5][1] + e * w_9[5][2] + f * w_9[5][3] + g * w_9[5][4]);
	a[N2_2304 * 7 + n2] = b + montgomery(c * w_9[6][0] + d * w_9[6][1] + e * w_9[6][2] + f * w_9[6][3] + g * w_9[6][4]);
	a[N2_2304 * 8 + n2] = b + montgomery(c * w_9[7][0] + d * w_9[7][1] + e * w_9[7][2] + f * w_9[7][3] + g * w_9[7][4]);
}

/* 256 * 9 --> 256 * 9 */
static void ntt_butterfly_2304_2304_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	h = a[N2_2304 * 6 + n2];
	i = a[N2_2304 * 7 + n2];
	j = a[N2_2304 * 8 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j);
	a[N2_2304 + n2] = b + montgomery(c * w_9_inv[0][0] + d * w_9_inv[0][1] + e * w_9_inv[0][2] + f * w_9_inv[0][3] + g * w_9_inv[0][4] + h * w_9_inv[0][5] + i * w_9_inv[0][6] + j * w_9_inv[0][7]);
	a[N2_2304 * 2 + n2] = b + montgomery(c * w_9_inv[1][0] + d * w_9_inv[1][1] + e * w_9_inv[1][2] + f * w_9_inv[1][3] + g * w_9_inv[1][4] + h * w_9_inv[1][5] + i * w_9_inv[1][6] + j * w_9_inv[1][7]);
	a[N2_2304 * 3 + n2] = b + montgomery(c * w_9_inv[2][0] + d * w_9_inv[2][1] + e * w_9_inv[2][2] + f * w_9_inv[2][3] + g * w_9_inv[2][4] + h * w_9_inv[2][5] + i * w_9_inv[2][6] + j * w_9_inv[2][7]);
	a[N2_2304 * 4 + n2] = b + montgomery(c * w_9_inv[3][0] + d * w_9_inv[3][1] + e * w_9_inv[3][2] + f * w_9_inv[3][3] + g * w_9_inv[3][4] + h * w_9_inv[3][5] + i * w_9_inv[3][6] + j * w_9_inv[3][7]);
	a[N2_2304 * 5 + n2] = b + montgomery(c * w_9_inv[4][0] + d * w_9_inv[4][1] + e * w_9_inv[4][2] + f * w_9_inv[4][3] + g * w_9_inv[4][4] + h * w_9_inv[4][5] + i * w_9_inv[4][6] + j * w_9_inv[4][7]);
	a[N2_2304 * 6 + n2] = b + montgomery(c * w_9_inv[5][0] + d * w_9_inv[5][1] + e * w_9_inv[5][2] + f * w_9_inv[5][3] + g * w_9_inv[5][4] + h * w_9_inv[5][5] + i * w_9_inv[5][6] + j * w_9_inv[5][7]);
	a[N2_2304 * 7 + n2] = b + montgomery(c * w_9_inv[6][0] + d * w_9_inv[6][1] + e * w_9_inv[6][2] + f * w_9_inv[6][3] + g * w_9_inv[6][4] + h * w_9_inv[6][5] + i * w_9_inv[6][6] + j * w_9_inv[6][7]);
	a[N2_2304 * 8 + n2] = b + montgomery(c * w_9_inv[7][0] + d * w_9_inv[7][1] + e * w_9_inv[7][2] + f * w_9_inv[7][3] + g * w_9_inv[7][4] + h * w_9_inv[7][5] + i * w_9_inv[7][6] + j * w_9_inv[7][7]);
}

/* 256 * 4 --> 256 * 4 */
static void ntt_butterfly_1024_1024_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	e = a[N2_1024 * 3 + n2];
	
	a[n2] = barrett_short(b + c + d + e);
	a[N2_1024 + n2] = b + montgomery(c * w_4_inv[0][0] + d * w_4_inv[0][1] + e * w_4_inv[0][2]);
	a[N2_1024 * 2 + n2] = b + montgomery(c * w_4_inv[1][0] + d * w_4_inv[1][1] + e * w_4_inv[1][2]);
	a[N2_1024 * 3 + n2] = b + montgomery(c * w_4_inv[2][0] + d * w_4_inv[2][1] + e * w_4_inv[2][2]);
}

/* 256 * 3 --> 256 * 4 */
static void ntt_butterfly_768_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	
	a[n2] = barrett_short(b + c + d);
	a[N2_1024 + n2] = b + montgomery(c * w_4[0][0] + d * w_4[0][1]);
	a[N2_1024 * 2 + n2] = b + montgomery(c * w_4[1][0] + d * w_4[1][1]);
	a[N2_1024 * 3 + n2] = b + montgomery(c * w_4[2][0] + d * w_4[2][1]);
}

/* 256 * 4 --> 256 * 1 */
static void ntt_butterfly_1024_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_short(a[n2] + a[N2_1024 + n2] + a[N2_1024 * 2 + n2] + a[N2_1024 * 3 + n2]);
}

/* 256 * 9 --> 256 * 10 */
static void ntt_butterfly_2304_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j);
	a[N2_2560 + n2] = b + montgomery(c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7]);
	a[N2_2560 * 2 + n2] = b + montgomery(c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7]);
	a[N2_2560 * 3 + n2] = b + montgomery(c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7]);
	a[N2_2560 * 4 + n2] = b + montgomery(c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4] + h * w_10[3][5] + i * w_10[3][6] + j * w_10[3][7]);
	a[N2_2560 * 5 + n2] = b + montgomery(c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4] + h * w_10[4][5] + i * w_10[4][6] + j * w_10[4][7]);
	a[N2_2560 * 6 + n2] = b + montgomery(c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4] + h * w_10[5][5] + i * w_10[5][6] + j * w_10[5][7]);
	a[N2_2560 * 7 + n2] = b + montgomery(c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4] + h * w_10[6][5] + i * w_10[6][6] + j * w_10[6][7]);
	a[N2_2560 * 8 + n2] = b + montgomery(c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4] + h * w_10[7][5] + i * w_10[7][6] + j * w_10[7][7]);
	a[N2_2560 * 9 + n2] = b + montgomery(c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4] + h * w_10[8][5] + i * w_10[8][6] + j * w_10[8][7]);
}

/* 256 * 10 --> 256 * 1 */
static void ntt_butterfly_2560_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_short(a[n2] + a[N2_2560 + n2] + a[N2_2560 * 2 + n2] + a[N2_2560 * 3 + n2] + a[N2_2560 * 4 + n2] + a[N2_2560 * 5 + n2] + a[N2_2560 * 6 + n2] + a[N2_2560 * 7 + n2] + a[N2_2560 * 8 + n2] + a[N2_2560 * 9 + n2]);	
}

void ntt_1536_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_1536_2560);
}

void intt_2560_1024(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 1024, omega_256, omega_2560, ntt_butterfly_2560_1024, INV_2560);
}

void ntt_768_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_768_2304);
}

void ntt_1536_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_1536_2304);
}

void intt_2304_2304_inv(uint32_t *a)
{
	intt_core(a, N1_2304, N2_2304, 2304, omega_256_inv, omega_2304_inv, ntt_butterfly_2304_2304_inv, INV_2304);
}

void ntt_1024_1024_inv(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256_inv, omega_1024_inv, ntt_butterfly_1024_1024_inv);
}

void ntt_768_1024(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256, omega_1024, ntt_butterfly_768_1024);
}

void intt_1024_256(uint32_t *a)
{
	intt_core(a, N1_1024, N2_1024, 256, omega_256, omega_1024, ntt_butterfly_1024_256, INV_1024);
}

void ntt_2304_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_2304_2560);
}

void intt_2560_256(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 256, omega_256, omega_2560, ntt_butterfly_2560_256, INV_2560);
}
