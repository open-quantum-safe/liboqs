/* ****************************** *
 * Titanium_CCA_super             *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 1280=5*256 */
#define N1_1280 5
#define N2_1280 256

/* 3072=3*1024 */
#define N1_3072 3
#define N2_3072 1024

/* 3328=13*256 */
#define N1_3328 13
#define N2_3328 256

/* multiplication inverses of 1280, 3072, 3328 (in Montgomery form) */
#define INV_1280 719665
#define INV_3072 998741
#define INV_3328 314

/* omega_n: n-th root of unity mod Q */

/* (in Montgomery form) */
static const uint32_t w_3[2]={1143141,208029};

static const uint32_t w_5[4][4]={{257374,660224,383910,49662},
{660224,49662,257374,383910},
{383910,257374,49662,660224},
{49662,383910,660224,257374}};

static const uint32_t w_13[12][12]={{739378,832564,508023,947265,1033385,410951,1063893,219279,1163648,321735,38958,62496},
{832564,947265,410951,219279,321735,62496,739378,508023,1033385,1063893,1163648,38958},
{508023,410951,1163648,62496,832564,1033385,219279,38958,739378,947265,1063893,321735},
{947265,219279,62496,508023,1063893,38958,832564,410951,321735,739378,1033385,1163648},
{1033385,321735,832564,1063893,62496,947265,1163648,739378,410951,38958,508023,219279},
{410951,62496,1033385,38958,947265,321735,508023,1163648,832564,219279,739378,1063893},
{1063893,739378,219279,832564,1163648,508023,321735,947265,38958,1033385,62496,410951},
{219279,508023,38958,410951,739378,1163648,947265,62496,1063893,832564,321735,1033385},
{1163648,1033385,739378,321735,410951,832564,38958,1063893,508023,62496,219279,947265},
{321735,1063893,947265,739378,38958,219279,1033385,832564,62496,1163648,410951,508023},
{38958,1163648,1063893,1033385,508023,739378,62496,321735,219279,410951,947265,832564},
{62496,38958,321735,1163648,219279,1063893,410951,1033385,947265,508023,832564,739378}};

/* omega_256,1024,1280,3072,3328 respectively (in Montgomery form) */
static const uint32_t omega_256[128]={1044992,901084,432696,43174,53472,1114901,68808,658703,845678,898707,654805,248220,918427,115070,447823,473942,752101,200114,809174,398395,999305,81928,950899,718447,1001535,369017,404200,1185205,810505,172715,677837,436808,380213,1134240,188664,119501,503039,160765,831757,153637,436315,1142507,21025,50016,1032088,838704,1110849,61847,1062170,274784,649462,686991,236690,986731,636896,806737,290426,918197,47852,149620,22859,315136,274086,883030,792565,920116,181542,1194764,1041292,913651,1157108,912736,316702,742171,683931,175846,769849,313393,150160,597399,494360,1176879,294143,879344,642534,193728,182605,1172049,80646,607486,754439,602111,537936,326863,1169730,142598,450171,930952,129195,877461,946507,39125,182823,694019,82002,1118379,751882,1032067,1082601,890887,765555,892047,1156658,833313,566709,588884,974990,1101931,601807,303238,1193306,688115,190130,37456,226377,441823,1012410,890645};
static const uint32_t omega_1024[512]={1044992,345261,313975,928945,901084,66530,236906,1188704,432696,586784,18466,51601,43174,204989,1187818,766041,53472,671189,928238,211052,1114901,285828,1013336,599111,68808,64072,234060,807170,658703,722712,895284,396135,845678,1102000,873343,547177,898707,142740,336844,485550,654805,512507,607055,633666,248220,250358,1138965,1008753,918427,220164,423565,61495,115070,886787,489630,1042642,447823,973764,315431,1151920,473942,108126,99848,407087,752101,825004,93472,174516,200114,24061,719997,641606,809174,218445,1141983,360078,398395,655276,972203,1188057,999305,83746,266588,206311,81928,888382,848269,36573,950899,762730,416179,41245,718447,326887,352166,1062850,1001535,1062145,313455,421425,369017,736292,970473,697658,404200,330551,333987,93280,1185205,611915,584702,382596,810505,319420,252860,1184755,172715,838500,86677,731082,677837,228200,1078215,422722,436808,1005853,484189,524550,380213,880859,694307,727867,1134240,1189477,1187144,108217,188664,829671,1054221,966198,119501,419119,514523,178509,503039,950935,797866,1162647,160765,1156110,969139,593755,831757,693995,423355,1054616,153637,189587,532438,890415,436315,524685,511973,85871,1142507,871502,1146523,1196875,21025,153023,788404,314302,50016,892376,1152170,717942,1032088,929848,584331,20500,838704,285781,967464,157036,1110849,1123400,194285,325362,61847,458622,730859,460189,1062170,337855,274205,452017,274784,1017121,699028,543239,649462,90063,441575,866121,686991,775937,127320,861977,236690,977888,746212,1067745,986731,990413,989802,393466,636896,1004538,398830,1079836,806737,236095,397168,655805,290426,708660,359423,957196,918197,1193765,579908,495976,47852,1176474,477026,721948,149620,1061319,705360,732866,22859,744926,1010690,412777,315136,864000,1013057,326807,274086,335873,735935,622041,883030,417041,882557,1153474,792565,781195,466804,329924,920116,670547,301646,876651,181542,1067085,342571,84697,1194764,356851,843086,968370,1041292,328304,537077,625755,913651,351112,34146,978309,1157108,745106,1186370,550874,912736,656153,630074,336671,316702,1194335,1136228,733603,742171,717972,1061368,753184,683931,185539,175833,287425,175846,300113,578524,343273,769849,175837,291329,391907,313393,360913,15274,530452,150160,390278,1119651,129504,597399,794058,1040282,540625,494360,866798,149662,1102311,1176879,872306,733146,296139,294143,742209,755060,118745,879344,413748,64751,896764,642534,516821,25195,628700,193728,979811,226898,1005544,182605,906492,552414,19614,1172049,950550,422106,1033673,80646,835231,490376,572657,607486,1054322,1064774,483197,754439,710730,1181662,748190,602111,600646,368887,609412,537936,266058,887112,806830,326863,328742,964565,921855,1169730,1083368,659726,523079,142598,198252,602911,183365,450171,869250,146652,560713,930952,463754,947367,909741,129195,295815,1176000,14402,877461,972102,1089481,635609,946507,70381,401239,1034858,39125,1045489,830333,502252,182823,1119260,945969,743374,694019,446779,1152901,233317,82002,960606,652114,282253,1118379,86113,180618,165261,751882,611260,1143503,645517,1032067,909352,947612,1148861,1082601,1109215,726697,1190401,890887,896987,860182,880932,765555,777217,178519,512799,892047,831066,19579,1137889,1156658,305906,242087,254955,833313,1014570,605414,230131,566709,792643,857323,486710,588884,869985,864012,1024769,974990,313926,881121,950019,1101931,805999,713888,669627,601807,303942,721385,798213,303238,34281,1110069,362120,1193306,131924,563157,920134,688115,674880,936411,999414,190130,1062406,568191,1040994,37456,614626,834476,951577,226377,497048,1094124,374853,441823,1108169,903882,401216,1012410,893416,969129,583995,890645,660795,368342,77492};
static const uint32_t omega_1280[1280]={1044992,798332,498344,442534,252256,901084,178118,90903,970167,597751,432696,569144,604705,807135,513888,43174,206618,191720,802630,299743,53472,407583,397956,579934,536518,1114901,746615,620972,859676,193738,68808,930472,903565,749488,237618,658703,1082814,543106,82381,820381,845678,984391,14640,1166634,829525,898707,942745,267605,842172,574394,654805,429460,332878,540829,334499,248220,1170647,114741,786879,286357,918427,275158,674633,550214,937522,115070,71170,1021474,300056,330306,447823,953115,195410,1180152,1061218,473942,1168134,330376,448491,548719,752101,707555,248228,75335,1061220,200114,506193,483205,503450,1038954,809174,499115,312968,864294,511654,398395,378738,807310,515558,230265,999305,807349,1166317,1100347,984268,81928,542211,416149,513931,146277,950899,482341,187127,656107,681501,718447,591785,170378,701659,1184659,1001535,999784,1119998,179099,1161422,369017,680313,433263,814171,444108,404200,1118752,646441,212720,1003030,1185205,527513,2041,909480,805934,810505,374893,86000,136068,545398,172715,621268,1067886,469112,1122042,677837,375404,809725,538604,655575,436808,676846,674025,1126337,889978,380213,136768,552078,921079,197773,1134240,725779,730215,806778,270865,188664,1081545,565227,156555,295901,119501,832303,343292,434823,486749,503039,1000801,855856,841902,400663,160765,164922,101899,253559,1016211,831757,817314,234485,697267,1074285,153637,849980,238134,697858,429538,436315,1082912,304425,1193540,1120516,1142507,1044286,415055,537722,407542,21025,371793,398726,587282,880486,50016,340372,64649,69242,215765,1032088,367113,182911,410489,288764,838704,952070,698901,199875,880452,1110849,810640,1060799,333020,268337,61847,316350,280412,177077,46738,1062170,722643,1179521,1192120,251193,274784,362986,930838,1112443,620466,649462,1131552,939744,204736,276453,686991,257374,1052617,357633,605908,236690,718309,316621,317229,939187,986731,721588,655990,1125386,504363,636896,1148560,177815,841091,16384,806737,1092015,1178604,943753,37608,290426,923026,798278,703214,343726,918197,615272,120664,946094,607642,47852,696261,1030454,43442,654177,149620,914339,475763,1048588,866879,22859,868527,825896,555998,958487,315136,1158830,618129,729853,50244,274086,82478,718614,490686,609071,883030,382371,602363,374015,488392,792565,546003,7334,1062683,1172540,920116,257045,570245,820597,26198,181542,945119,1111801,1059341,1072186,1194764,71039,985993,1125316,503695,1041292,591869,650412,456000,414991,913651,24196,1120902,1009267,286259,1157108,362080,374498,253385,877627,912736,700082,245376,1177738,901258,316702,9924,1087399,586860,1150306,742171,441640,449110,862704,154172,683931,1083945,245821,155058,384308,175846,856532,540275,705752,299484,769849,466151,374937,52189,1148419,313393,183732,623709,1125411,675756,150160,63720,265762,379583,130756,597399,703184,856903,64583,718999,494360,781055,949628,778290,923242,1176879,1098446,76124,863364,845088,294143,32,411076,191673,49102,879344,655274,913168,259203,1035840,642534,791592,776334,356882,393356,193728,239867,645934,139420,474693,182605,373338,926933,219406,929910,1172049,1052354,423585,790277,1106094,80646,1146133,599656,793184,859988,607486,1039059,810176,1090602,548964,754439,490250,399525,218367,611917,602111,131994,27288,705407,809655,537936,1059971,1078198,1149443,288934,326863,996892,510475,79066,617592,1169730,1064455,573294,301999,280386,142598,265404,273474,8176,796871,450171,564751,631245,889248,886710,930952,1079300,30340,974148,669972,129195,1061735,376183,782928,899040,877461,876921,529459,739460,210384,946507,371967,537310,506303,997718,39125,1057982,237676,1104258,1055821,182823,478111,660224,104633,930036,694019,84825,467164,658451,840793,82002,1193304,1084033,178199,981679,1118379,197880,861414,655325,1119040,751882,739696,246867,712734,434574,1032067,846145,543846,602906,310735,1082601,951844,491359,718186,383909,890887,525811,601955,1123201,141203,765555,117096,638198,202520,563384,892047,1050344,62095,1106027,867317,1156658,871249,749179,611209,492662,833313,1037548,419217,988210,701471,566709,923777,1010830,746176,822168,588884,793081,585158,552139,955892,974990,404160,604907,706370,750383,1101931,965153,584134,576598,812761,601807,1019096,3516,238938,842454,303238,771442,412891,893611,175266,1193306,810205,714339,1134508,1173338,688115,918487,446885,1183780,342760,190130,445148,585279,758679,1044175,37456,733977,911140,1164084,120573,226377,174892,881659,1190829,889260,441823,553549,798193,360094,321315,1012410,76636,252094,317613,1079775,890645,112731,425389,602107,679650,153089,399749,699737,755547,945825,296997,1019963,1107178,227914,600330,765385,628937,593376,390946,684193,1154907,991463,1006361,395451,898338,1144609,790498,800125,618147,661563,83180,451466,577109,338405,1004343,1129273,267609,294516,448593,960463,539378,115267,654975,1115700,377700,352403,213690,1183441,31447,368556,299374,255336,930476,355909,623687,543276,768621,865203,657252,863582,949861,27434,1083340,411202,911724,279654,922923,523448,647867,260559,1083011,1126911,176607,898025,867775,750258,244966,1002671,17929,136863,724139,29947,867705,749590,649362,445980,490526,949853,1122746,136861,997967,691888,714876,694631,159127,388907,698966,885113,333787,686427,799686,819343,390771,682523,967816,198776,390732,31764,97734,213813,1116153,655870,781932,684150,1051804,247182,715740,1010954,541974,516580,479634,606296,1027703,496422,13422,196546,198297,78083,1018982,36659,829064,517768,764818,383910,753973,793881,79329,551640,985361,195051,12876,670568,1196040,288601,392147,387576,823188,1112081,1062013,652683,1025366,576813,130195,728969,76039,520244,822677,388356,659477,542506,761273,521235,524056,71744,308103,817868,1061313,646003,277002,1000308,63841,472302,467866,391303,927216,1009417,116536,632854,1041526,902180,1078580,365778,854789,763258,711332,695042,197280,342225,356179,797418,1037316,1033159,1096182,944522,181870,366324,380767,963596,500814,123796,1044444,348101,959947,500223,768543,761766,115169,893656,4541,77565,55574,153795,783026,660359,790539,1177056,826288,799355,610799,317595,1148065,857709,1133432,1128839,982316,165993,830968,1015170,787592,909317,359377,246011,499180,998206,317629,87232,387441,137282,865061,929744,1136234,881731,917669,1021004,1151343,135911,475438,18560,5961,946888,923297,835095,267243,85638,577615,548619,66529,258337,993345,921628,511090,940707,145464,840448,592173,961391,479772,881460,880852,258894,211350,476493,542091,72695,693718,561185,49521,1020266,356990,1181697,391344,106066,19477,254328,1160473,907655,275055,399803,494867,854355,279884,582809,1077417,251987,590439,1150229,501820,167627,1154639,543904,1048461,283742,722318,149493,331202,1175222,329554,372185,642083,239594,882945,39251,579952,468228,1147837,923995,1115603,479467,707395,589010,315051,815710,595718,824066,709689,405516,652078,1190747,135398,25541,277965,941036,627836,377484,1171883,1016539,252962,86280,138740,125895,3317,1127042,212088,72765,694386,156789,606212,547669,742081,783090,284430,1173885,77179,188814,911822,40973,836001,823583,944696,320454,285345,497999,952705,20343,296823,881379,1188157,110682,611221,47775,455910,756441,748971,335377,1043909,514150,114136,952260,1043023,813773,1022235,341549,657806,492329,898597,428232,731930,823144,1145892,49662,884688,1014349,574372,72670,522325,1047921,1134361,932319,818498,1067325,600682,494897,341178,1133498,479082,703721,417026,248453,419791,274839,21202,99635,1121957,334717,352993,903938,1198049,787005,1006408,1148979,318737,542807,284913,938878,162241,555547,406489,421747,841199,804725,1004353,958214,552147,1058661,723388,1015476,824743,271148,978675,268171,26032,145727,774496,407804,91987,1117435,51948,598425,404897,338093,590595,159022,387905,107479,649117,443642,707831,798556,979714,586164,595970,1066087,1170793,492674,388426,660145,138110,119883,48638,909147,871218,201189,687606,1119015,580489,28351,133626,624787,896082,917695,1055483,932677,924607,1189905,401210,747910,633330,566836,308833,311371,267129,118781,1167741,223933,528109,1068886,136346,821898,415153,299041,320620,321160,668622,458621,987697,251574,826114,660771,691778,200363,1158956,140099,960405,93823,142260,1015258,719970,537857,1093448,268045,504062,1113256,730917,539630,357288,1116079,4777,114048,1019882,216402,79702,1000201,336667,542756,79041,446199,458385,951214,485347,763507,166014,351936,654235,595175,887346,115480,246237,706722,479895,814172,307194,672270,596126,74880,1056878,432526,1080985,559883,995561,634697,306034,147737,1135986,92054,330764,41423,326832,448902,586872,705419,364768,160533,778864,209871,496610,631372,274304,187251,451905,375913,609197,405000,612923,645942,242189,223091,793921,593174,491711,447698,96150,232928,613947,621483,385320,596274,178985,1194565,959143,355627,894843,426639,785190,304470,1022815,4775,387876,483742,63573,24743,509966,279594,751196,14301,855321,1007951,752933,612802,439402,153906,1160625,464104,286941,33997,1077508,971704,1023189,316422,7252,308821,756258,644532,399888,837987,876766,185671,1121445,945987,880468,118306,307436,1085350,772692,595974,518431};
static const uint32_t omega_3072[3072]={1044992,316549,21604,345261,1045007,718127,313975,359901,14567,928945,225643,1038501,901084,978745,450,66530,384563,439200,236906,334135,944283,1188704,237728,295919,432696,792895,79423,586784,1103275,839664,18466,919662,24660,51601,227443,106540,43174,339383,948074,204989,567452,401692,1187818,319730,278905,766041,555420,246893,53472,557308,153287,671189,3834,1046068,928238,147741,197356,211052,425496,926496,1114901,748070,907022,285828,484991,1069694,1013336,109221,492793,599111,1168568,535487,68808,1147337,271996,64072,793258,692195,234060,259482,1062717,807170,459341,871727,658703,234522,168042,722712,60001,1069976,895284,1053088,768025,396135,1058471,791775,845678,321874,10155,1102000,251802,326632,873343,152147,103286,547177,1131509,168332,898707,920183,154935,142740,735939,258354,336844,625945,556494,485550,1099091,407451,654805,430321,1107365,512507,664946,119178,607055,825475,103871,633666,553168,739292,248220,755518,304230,250358,565753,1002473,1138965,1057668,779552,1008753,736227,61317,918427,907033,1139423,220164,1080430,257680,423565,188400,1096751,61495,572007,542643,115070,1171167,67766,886787,89718,245161,489630,104855,859017,1042642,501595,941973,447823,739672,437521,973764,675110,503660,315431,1160891,358950,1151920,843071,495548,473942,953730,828205,108126,1129624,821486,99848,278504,254147,407087,1053598,44705,752101,358150,501164,825004,912829,319016,93472,746921,1056637,174516,561648,928052,200114,645431,29516,24061,948131,53672,719997,457324,866389,641606,662092,948559,809174,436133,875052,218445,347053,1017080,1141983,864886,659012,360078,679712,1024296,398395,860119,513342,655276,819444,223934,972203,657317,508842,1188057,568057,624258,999305,910210,650660,83746,586939,61230,266588,169746,1054511,206311,336918,51157,81928,557774,807911,888382,458650,183838,848269,758187,911819,36573,774535,959242,950899,1155130,518931,762730,12659,886474,416179,374374,184142,41245,1172400,10442,718447,95045,606744,326887,511683,330130,352166,1000912,1121172,1062850,454097,415919,1001535,1106783,985566,1062145,749227,1051454,313455,416142,661768,421425,5133,119909,369017,217484,817327,736292,204047,987287,970473,268426,334988,697658,802118,1070256,404200,520275,1041305,330551,1000137,340992,333987,895778,939755,93280,878279,668915,1185205,572389,1104976,611915,345918,183676,584702,955207,753707,382596,175014,1194379,810505,686162,1179172,319420,1164914,714112,252860,1175276,888251,1184755,505859,720413,172715,109012,1047622,838500,964584,515979,86677,940399,401484,731082,99378,75897,677837,1146448,992531,228200,1123675,660808,1078215,462685,381030,422722,1102104,480170,436808,974847,196249,1005853,174358,1044145,484189,45906,716670,524550,475259,988697,380213,195437,513067,880859,251633,1153615,694307,1185284,930181,727867,689019,909339,1134240,359103,934924,1189477,644876,746183,1187144,406451,1039441,108217,131365,917890,188664,17573,894133,829671,378114,470840,1054221,30316,674817,966198,834472,874923,119501,947673,891176,419119,10316,1179051,514523,483768,596016,178509,113654,642331,503039,702852,318693,950935,681220,741389,797866,1133846,1152821,1162647,804933,155237,160765,871553,553106,1156110,1196299,695006,969139,656930,212010,593755,190345,851828,831757,74165,1113995,693995,500180,599653,423355,556713,597800,1054616,621195,1185434,153637,57334,835419,189587,846258,673864,532438,469999,1142876,890415,1052082,33565,436315,76615,411253,524685,495218,25793,511973,506125,14267,85871,368628,745701,1142507,356628,569009,871502,625438,641281,1146523,604259,491974,1196875,300932,934224,21025,179787,62983,153023,552286,369277,788404,1092767,990052,314302,248502,637466,50016,525590,362777,892376,197172,636457,1152170,746912,576074,717942,552864,348235,1032088,458814,820437,929848,918251,428404,584331,48388,1190116,20500,501529,612727,838704,675256,179133,285781,105306,1112063,967464,941771,1110183,157036,240369,473384,1110849,974349,761599,1123400,886391,510404,194285,103134,950689,325362,19980,557770,61847,331184,454746,458622,951795,542126,730859,439145,761255,460189,890603,174660,1062170,619803,340658,337855,1094904,613771,274205,1136133,1198077,452017,640883,1194177,274784,103526,982020,1017121,402572,1184801,699028,1137785,217611,543239,1055154,327999,649462,678725,239397,90063,1094888,25677,441575,1120517,1099132,866121,974720,470337,686991,50406,183889,775937,74935,961595,127320,53619,419297,861977,814661,688251,236690,781433,807616,977888,699092,1093999,746212,605703,252853,1067745,512195,1177923,986731,302543,693169,990413,554042,815260,989802,410461,167976,393466,450882,1005560,636896,365105,198221,1004538,512423,572655,398830,525071,605534,1079836,888709,347251,806737,1167421,1058134,236095,27865,1191043,397168,838458,319398,655805,45685,231388,290426,259563,595460,708660,538397,99675,359423,715994,238239,957196,328921,93550,918197,1139269,250644,1193765,107376,220020,579908,565929,283021,495976,31363,669866,47852,658263,835071,1176474,293272,334216,477026,1090194,316784,721948,133416,76286,149620,821268,174114,1061319,41379,1005843,705360,849231,474429,732866,975485,583438,22859,797046,347013,744926,362327,825846,1010690,197257,915264,412777,829872,727319,315136,52316,599392,864000,741014,343064,1013057,786821,565865,326807,1165456,1166980,274086,506187,795530,335873,429140,80792,735935,710371,977727,622041,831278,589076,883030,226491,1057377,417041,608312,452211,882557,662417,464128,1153474,753333,114310,792565,829355,145027,781195,745805,172794,466804,670513,915604,329924,268462,1059159,920116,837254,993362,670547,68662,273783,301646,1119657,40145,876651,135360,842928,181542,322450,814162,1067085,813978,294409,342571,114825,1001825,84697,647667,147104,1194764,734305,1001865,356851,229242,186144,843086,897126,766313,968370,995846,318944,1041292,302005,986365,328304,28954,633197,537077,703241,988557,625755,1060884,376427,913651,280800,779966,351112,898332,465381,34146,974821,139157,978309,148982,434079,1157108,438631,738511,745106,388939,740055,1186370,1010868,1048918,550874,586505,582794,912736,944243,916550,656153,256879,784374,630074,314975,1173346,336671,706864,1018341,316702,1002689,691667,1194335,990368,547389,1136228,945882,1105619,733603,658462,811244,742171,487496,1040684,717972,157939,932977,1061368,794096,43992,753184,1077370,1003357,683931,796083,444255,185539,620520,1085639,175833,596615,480060,287425,28874,88889,175846,625161,493832,300113,333907,351470,578524,15200,383554,343273,458228,547432,769849,346315,1147587,175837,144598,1037258,291329,952171,1183444,391907,806121,91260,313393,832960,411766,360913,670042,526481,15274,1006847,1066788,530452,256252,52699,150160,901104,1114822,390278,86050,208724,1119651,119130,40854,129504,57023,336831,597399,542722,472862,794058,144870,252127,1040282,19562,469347,540625,1121297,415730,494360,537919,801102,866798,249466,726740,149662,268373,34288,1102311,750390,1116901,1176879,353149,1039747,872306,824177,18465,733146,484401,50625,296139,731462,288679,294143,1048717,201669,742209,386618,343660,755060,1141734,1147561,118745,117054,1011882,879344,427009,378088,413748,1026677,4940,64751,441036,29116,896764,340057,861353,642534,27195,825747,516821,184538,818640,25195,396938,1070694,628700,431325,270712,193728,446769,637092,979811,1143141,1195834,226898,292205,203090,1005544,48802,532475,182605,905593,926527,906492,873071,937278,552414,281705,647525,19614,583531,595713,1172049,437781,346603,950550,757420,425686,422106,25943,933510,1033673,160667,564200,80646,1060462,740021,835231,1067009,1015734,490376,268395,543397,572657,771862,803670,607486,942444,836946,1054322,897217,966135,1064774,1084662,58013,483197,724589,310881,754439,331074,305363,710730,844435,910200,1181662,1086913,577179,748190,525403,228634,602111,14660,303718,600646,1129269,502761,368887,1130105,679607,609412,747960,757639,537936,377631,239687,266058,756989,308717,887112,803368,589461,806830,542194,235056,326863,827623,581185,328742,253454,544247,964565,566418,435189,921855,508627,623790,1169730,414418,193892,1083368,718671,1139875,659726,545511,698832,523079,470772,351943,142598,608449,845202,198252,796129,637424,602911,665416,321785,183365,86114,164938,450171,181594,436634,869250,1117837,836029,146652,755202,71143,560713,257337,1144951,930952,761983,860684,463754,885188,172803,947367,127087,924388,909741,634569,47695,129195,1129548,1023242,295815,204328,682719,1176000,542682,200708,14402,105830,603805,877461,255114,1055909,972102,988497,217524,1089481,317867,243087,635609,1133294,32874,946507,266181,934918,70381,1007160,740327,401239,561740,116309,1034858,735223,897970,39125,1125210,621509,1045489,762764,363798,830333,449363,434872,502252,80642,314398,182823,831327,143712,1119260,274315,87435,945969,559377,272809,743374,825097,287602,694019,184240,348598,446779,106090,1174725,1152901,508874,1166164,233317,655490,1197195,82002,1181067,333345,960606,167470,664769,652114,511704,652723,282253,1021408,876637,1118379,90816,167878,86113,1176503,909912,180618,505330,296091,165261,790789,247295,751882,245900,545639,611260,382200,595700,1143503,424009,333915,645517,494839,23008,1032067,136221,890350,909352,1162786,372875,947612,296429,907457,1148861,577183,296173,1082601,232538,327327,1109215,519779,781606,726697,516041,867940,1190401,461996,66173,890887,429640,1086555,896987,290,175995,860182,283040,445537,880932,688410,1138790,765555,962800,837953,777217,397296,750886,178519,780733,837245,512799,15892,59878,892047,1133620,933040,831066,584357,105480,19579,45876,1111595,1137889,445979,653415,1156658,372101,353948,305906,152033,405920,242087,1020245,811190,254955,153809,987980,833313,357459,1011356,1014570,238413,1062793,605414,263374,945903,230131,663690,678958,566709,797700,124215,792643,1000631,227659,857323,179841,550199,486710,604990,253936,588884,1014388,1036850,869985,427782,785236,864012,583044,816577,1024769,1160550,255287,974990,510255,1157345,313926,805265,976418,881121,1195585,509573,950019,1158147,139633,1101931,561089,898655,805999,99847,91988,713888,406111,1122294,669627,997606,312910,601807,821684,1087586,303942,447395,1182251,721385,556036,124973,798213,1158524,967467,303238,929041,159964,34281,994780,374334,1110069,459670,1133360,362120,555626,330597,1193306,758364,378883,131924,947287,780860,563157,831661,139844,920134,600299,1104591,688115,30215,1005997,674880,735896,624733,936411,583977,1114260,999414,873077,858293,190130,287561,235349,1062406,308582,867153,568191,457701,496142,1040994,1030044,209868,37456,132985,1157398,614626,400612,1028146,834476,422906,676699,951577,616392,315593,226377,161930,111951,497048,1095069,238805,1094124,99092,645966,374853,867312,272210,441823,651326,901059,1108169,711246,42130,903882,487197,384126,401216,1064196,1105704,1012410,1117150,894204,893416,84690,540136,969129,1187932,17096,583995,877305,1110643,890645,819846,922344,660795,1049669,448913,368342,117689,839523,77492,1046769,1085125,153089,881532,1176477,852820,153074,479954,884106,838180,1183514,269136,972438,159580,296997,219336,1197631,1131551,813518,758881,961175,863946,253798,9377,960353,902162,765385,405186,1118658,611297,94806,358417,1179615,278419,1173421,1146480,970638,1091541,1154907,858698,250007,993092,630629,796389,10263,878351,919176,432040,642661,951188,1144609,640773,1044794,526892,1194247,152013,269843,1050340,1000725,987029,772585,271585,83180,450011,291059,912253,713090,128387,184745,1088860,705288,598970,29513,662594,1129273,50744,926085,1134009,404823,505886,964021,938599,135364,390911,738740,326354,539378,963559,1030039,475369,1138080,128105,302797,144993,430056,801946,139610,406306,352403,876207,1187926,96081,946279,871449,324738,1045934,1094795,650904,66572,1029749,299374,277898,1043146,1055341,462142,939727,861237,572136,641587,712531,98990,790630,543276,767760,90716,685574,533135,1078903,591026,372606,1094210,564415,644913,458789,949861,442563,893851,947723,632328,195608,59116,140413,418529,189328,461854,1136764,279654,291048,58658,977917,117651,940401,774516,1009681,101330,1136586,626074,655438,1083011,26914,1130315,311294,1108363,952920,708451,1093226,339064,155439,696486,256108,750258,458409,760560,224317,522971,694421,882650,37190,839131,46161,355010,702533,724139,244351,369876,1089955,68457,376595,1098233,919577,943934,790994,144483,1153376,445980,839931,696917,373077,285252,879065,1104609,451160,141444,1023565,636433,270029,997967,552650,1168565,1174020,249950,1144409,478084,740757,331692,556475,535989,249522,388907,761948,323029,979636,851028,181001,56098,333195,539069,838003,518369,173785,799686,337962,684739,542805,378637,974147,225878,540764,689239,10024,630024,573823,198776,287871,547421,1114335,611142,1136851,931493,1028335,143570,991770,861163,1146924,1116153,640307,390170,309699,739431,1014243,349812,439894,286262,1161508,423546,238839,247182,42951,679150,435351,1185422,311607,781902,823707,1013939,1156836,25681,1187639,479634,1103036,591337,871194,686398,867951,845915,197169,76909,135231,743984,782162,196546,91298,212515,135936,448854,146627,884626,781939,536313,776656,1192948,1078172,829064,980597,380754,461789,994034,210794,227608,929655,863093,500423,395963,127825,793881,677806,156776,867530,197944,857089,864094,302303,258326,1104801,319802,529166,12876,625692,93105,586166,852163,1014405,613379,242874,444374,815485,1023067,3702,387576,511919,18909,878661,33167,483969,945221,22805,309830,13326,692222,477668,1025366,1089069,150459,359581,233497,682102,1111404,257682,796597,466999,1098703,1122184,520244,51633,205550,969881,74406,537273,119866,735396,817051,775359,95977,717911,761273,223234,1001832,192228,1023723,153936,713892,1152175,481411,673531,722822,209384,817868,1002644,685014,317222,946448,44466,503774,12797,267900,470214,509062,288742,63841,838978,263157,8604,553205,451898,10937,791630,158640,1089864,1066716,280191,1009417,1180508,303948,368410,819967,727241,143860,1167765,523264,231883,363609,323158,1078580,250408,306905,778962,1187765,19030,683558,714313,602065,1019572,1084427,555750,695042,495229,879388,247146,516861,456692,400215,64235,45260,35434,393148,1042844,1037316,326528,644975,41971,1782,503075,228942,541151,986071,604326,1007736,346253,366324,1123916,84086,504086,697901,598428,774726,641368,600281,143465,576886,12647,1044444,1140747,362662,1008494,351823,524217,665643,728082,55205,307666,145999,1164516,761766,1121466,786828,673396,702863,1172288,686108,691956,1183814,1112210,829453,452380,55574,841453,629072,326579,572643,556800,51558,593822,706107,1206,897149,263857,1177056,1018294,1135098,1045058,645795,828804,409677,105314,208029,883779,949579,560615,1148065,672491,835304,305705,1000909,561624,45911,451169,622007,480139,645217,849846,165993,739267,377644,268233,279830,769677,613750,1149693,7965,1177581,696552,585354,359377,522825,1018948,912300,1092775,86018,230617,256310,87898,1041045,957712,724697,87232,223732,436482,74681,311690,687677,1003796,1094947,247392,872719,1178101,640311,1136234,866897,743335,739459,246286,655955,467222,758936,436826,737892,307478,1023421,135911,578278,857423,860226,103177,584310,923876,61948,4,746064,557198,3904,923297,1094555,216061,180960,795509,13280,499053,60296,980470,654842,142927,870082,548619,519356,958684,1108018,103193,1172404,756506,77564,98949,331960,223361,727744,511090,1147675,1014192,422144,1123146,236486,1070761,1144462,778784,336104,383420,509830,961391,416648,390465,220193,498989,104082,451869,592378,945228,130336,685886,20158,211350,895538,504912,207668,644039,382821,208279,787620,1030105,804615,747199,192521,561185,832976,999860,193543,685658,625426,799251,673010,592547,118245,309372,850830,391344,30660,139947,961986,1170216,7038,800913,359623,878683,542276,1152396,966693,907655,938518,602621,489421,659684,1098406,838658,482087,959842,240885,869160,1104531,279884,58812,947437,4316,1090705,978061,618173,632152,915060,702105,1166718,528215,1150229,539818,363010,21607,904809,863865,721055,107887,881297,476133,1064665,1121795,1048461,376813,1023967,136762,1156702,192238,492721,348850,723652,465215,222596,614643,1175222,401035,851068,453155,835754,372235,187391,1000824,282817,785304,368209,470762,882945,1145765,598689,334081,457067,855017,185024,411260,632216,871274,32625,31101,923995,691894,402551,862208,768941,1117289,462146,487710,220354,576040,366803,609005,315051,971590,140704,781040,589769,745870,315524,535664,733953,44607,444748,1083771,405516,368726,1053054,416886,452276,1025287,731277,527568,282477,868157,929619,138922,277965,360827,204719,527534,1129419,924298,896435,78424,1157936,321430,1062721,355153,1016539,875631,383919,130996,384103,903672,855510,1083256,196256,1113384,550414,1050977,3317,463776,196216,841230,968839,1011937,354995,300955,431768,229711,202235,879137,156789,896076,211716,869777,1169127,564884,661004,494840,209524,572326,137197,821654,284430,917281,418115,846969,299749,732700,1163935,223260,1058924,219772,1049099,764002,40973,759450,459570,452975,809142,458026,11711,187213,149163,647207,611576,615287,285345,253838,281531,541928,941202,413707,568007,883106,24735,861410,491217,179740,881379,195392,506414,3746,207713,650692,61853,252199,92462,464478,539619,386837,455910,710585,157397,480109,1040142,265104,136713,403985,1154089,444897,120711,194724,514150,401998,753826,1012542,577561,112442,1022248,601466,718021,910656,1169207,1109192,1022235,572920,704249,897968,864174,846611,619557,1182881,814527,854808,739853,650649,428232,851766,50494,1022244,1053483,160823,906752,245910,14637,806174,391960,1106821,884688,365121,786315,837168,528039,671600,1182807,191234,131293,667629,941829,1145382,1047921,296977,83259,807803,1112031,989357,78430,1078951,1157227,1068577,1141058,861250,600682,655359,725219,404023,1053211,945954,157799,1178519,728734,657456,76784,782351,703721,660162,396979,331283,948615,471341,1048419,929708,1163793,95770,447691,81180,21202,844932,158334,325775,373904,1179616,464935,713680,1147456,901942,466619,909402,903938,149364,996412,455872,811463,854421,443021,56347,50520,1079336,1081027,186199,318737,771072,819993,784333,171404,1193141,1133330,757045,1168965,301317,858024,336728,555547,1170886,372334,681260,1013543,379441,1172886,801143,127387,569381,766756,927369,1004353,751312,560989,218270,54940,2247,971183,905876,994991,192537,1149279,665606,1015476,292488,271554,291589,325010,260803,645667,916376,550556,1178467,614550,602368,26032,760300,851478,247531,440661,772395,775975,1172138,264571,164408,1037414,633881,1117435,137619,458060,362850,131072,182347,707705,929686,654684,625424,426219,394411,590595,255637,361135,143759,300864,231946,133307,113419,1140068,714884,473492,887200,443642,867007,892718,487351,353646,287881,16419,111168,620902,449891,672678,969447,595970,1183421,894363,597435,68812,695320,829194,67976,518474,588669,450121,440442,660145,820450,958394,932023,441092,889364,310969,394713,608620,391251,655887,963025,871218,370458,616896,869339,944627,653834,233516,631663,762892,276226,689454,574291,28351,783663,1004189,114713,479410,58206,538355,652570,499249,675002,727309,846138,1055483,589632,352879,999829,401952,560657,595170,532665,876296,1014716,1111967,1033143,747910,1016487,761447,328831,80244,362052,1051429,442879,1126938,637368,940744,53130,267129,436098,337397,734327,312893,1025278,250714,1070994,273693,288340,563512,1150386,1068886,68533,174839,902266,993753,515362,22081,655399,997373,1183679,1092251,594276,320620,942967,142172,225979,209584,980557,108600,880214,954994,562472,64787,1165207,251574,931900,263163,1127700,190921,457754,796842,636341,1081772,163223,462858,300111,1158956,72871,576572,152592,435317,834283,367748,748718,763209,695829,1117439,883683,1015258,366754,1054369,78821,923766,1110646,252112,638704,925272,454707,372984,910479,504062,1013841,849483,751302,1091991,23356,45180,689207,31917,964764,542591,886,1116079,17014,864736,237475,1030611,533312,545967,686377,545358,915828,176673,321444,79702,1107265,1030203,1111968,21578,288169,1017463,692751,901990,1032820,407292,950786,446199,952181,652442,586821,815881,602381,54578,774072,864166,552564,703242,1175073,166014,1061860,307731,288729,35295,825206,250469,901652,290624,49220,620898,901908,115480,965543,870754,88866,678302,416475,471384,682040,330141,7680,736085,1131908,307194,768441,111526,301094,1197791,1022086,337899,915041,752544,317149,509671,59291,432526,235281,360128,420864,800785,447195,1019562,417348,360836,685282,1182189,1138203,306034,64461,265041,367015,613724,1092601,1178502,1152205,86486,60192,752102,544666,41423,825980,844133,892175,1046048,792161,955994,177836,386891,943126,1044272,210101,364768,840622,186725,183511,959668,135288,592667,934707,252178,967950,534391,519123,631372,400381,1073866,405438,197450,970422,340758,1018240,647882,711371,593091,944145,609197,183693,161231,328096,770299,412845,334069,615037,381504,173312,37531,942794,223091,687826,40736,884155,392816,221663,316960,2496,688508,248062,39934,1058448,96150,636992,299426,392082,1098234,1106093,484193,791970,75787,528454,200475,885171,596274,376397,110495,894139,750686,15830,476696,642045,1073108,399868,39557,230614,894843,269040,1038117,1163800,203301,823747,88012,738411,64721,835961,642455,867484,4775,439717,819198,1066157,250794,417221,634924,366420,1058237,277947,597782,93490,509966,1167866,192084,523201,462185,573348,261670,614104,83821,198667,325004,339788,1007951,910520,962732,135675,889499,330928,629890,740380,701939,157087,168037,988213,1160625,1065096,40683,583455,797469,169935,363605,775175,521382,246504,581689,882488,971704,1036151,1086130,701033,103012,959276,103957,1098989,552115,823228,330769,925871,756258,546755,297022,89912,486835,1155951,294199,710884,813955,796865,133885,92377,185671,80931,303877,304665,1113391,657945,228952,10149,1180985,614086,320776,87438,307436,378235,275737,537286,148412,749168,829739,1080392,358558,1120589,151312,112956};
static const uint32_t omega_3328[3328]={1044992,297499,1003112,298793,445684,55345,1181209,270347,107736,622145,646473,926990,510895,901084,412027,538192,102607,328047,755915,153152,321622,1075659,287912,657315,617351,487678,432696,993156,776731,55930,255167,575079,763387,252704,560222,506436,877592,512078,1078471,43174,639359,313980,978973,677558,1107687,227190,186939,964189,757658,109672,1125119,934057,53472,99275,863453,369878,938683,158719,241864,813447,747783,699005,1183063,690133,1036638,1114901,415662,1040713,1187152,367486,119210,456897,63638,886353,195237,528298,29792,709918,68808,23964,963217,618999,727701,459666,1031801,970926,23897,456924,500130,236865,446682,658703,1002708,911692,712421,153466,1049272,577720,549722,753929,1060528,571193,152337,546788,845678,951445,803366,1157353,1053098,485028,900224,708427,192610,347065,1055477,473111,382282,898707,367530,76183,463433,207160,876998,493902,990235,501789,166611,475286,134188,895044,654805,730142,1095077,87403,274277,675759,334597,504539,472626,883786,717746,909397,751112,248220,43824,276024,519451,376273,267068,346252,26148,461260,398840,1098791,757733,390309,918427,35074,282588,1071258,1024576,1092731,366570,797121,1192161,452181,100859,512562,605174,115070,1020020,211075,670045,966541,309249,241218,1063954,978572,7755,503538,1151970,735092,447823,822703,845449,222362,987182,355928,257684,264839,919443,130706,869176,682152,917477,473942,903885,477566,518602,362396,1121201,27550,451719,1151683,443934,296274,812338,879240,752101,1105441,81819,833554,281947,1180730,602609,581165,421168,285420,262380,791758,310015,200114,742074,1189914,335017,638409,752848,402189,83866,601713,694936,941570,194618,17216,809174,270113,717769,260636,863445,595534,66163,350457,25732,214562,554878,286438,301598,398395,472015,147048,1171567,277854,418124,1083777,136957,665126,739378,558802,1023703,557741,999305,1053633,969336,544030,765319,868506,411546,926868,357906,774045,340829,836422,853779,81928,155153,189222,65901,552205,204646,1102617,665041,740811,872925,365237,58460,776317,950899,629335,313832,361285,110991,1060597,1021072,489336,390649,912695,1174744,520290,672220,718447,305586,528493,519832,412135,1086079,1098898,135746,79454,450573,1128718,55868,805920,1001535,452235,973843,411667,1108064,375880,569690,614623,759190,27464,481359,158660,707996,369017,65209,902153,210769,914820,1138919,1053782,360736,21581,1087962,700681,633290,176680,404200,867477,682605,120516,759066,1128970,136190,734437,952193,71907,70384,1096810,325993,1185205,174789,1028073,695494,777117,1148838,421422,309328,409027,95441,1181801,344937,1175923,810505,1065188,915483,408893,280936,944063,561346,1149955,64309,1128752,294911,919887,785689,172715,823422,931993,764832,228343,12455,917629,978802,708631,428787,1030867,958482,1192153,677837,426420,704300,389042,714266,827115,996589,986661,674803,942707,471446,621778,215713,436808,21748,1169717,943321,1123563,495152,475834,251805,758614,699643,1158212,784905,721545,380213,553021,1149354,243582,277061,22736,857064,872251,207459,829672,756150,712993,792196,1134240,47344,428107,1042331,1075304,716749,277832,1038678,1080509,65196,70763,1189086,926874,188664,230354,796066,998521,404382,526127,165058,1149841,883745,676152,31975,236168,937665,119501,635227,651447,800849,269512,897042,607026,591270,532711,152725,385201,31982,38719,503039,850291,225302,726191,1119401,480748,620003,1161817,935555,930302,539629,303902,105841,160765,38230,1117371,233070,863038,94973,5705,820000,411786,147593,175724,1012310,834384,831757,650524,478128,241321,554795,231457,833851,291035,26767,972342,817539,340515,108772,153637,1018199,58539,944126,1180467,832564,651014,1033670,967607,192612,290651,75526,1024217,436315,748908,116236,478845,384279,879135,119593,436345,1100779,992024,358868,1194774,1028312,1142507,485870,1111550,288920,978603,331419,290310,109465,973563,1121141,521889,1096305,193556,21025,1196001,1162672,780190,730559,115487,40430,164102,559870,850652,825304,561983,1153311,50016,538106,132247,533105,1019977,225895,772574,1098572,944661,466694,476370,707906,511485,1032088,64003,175446,467289,466339,905207,328423,932812,426838,894584,451134,879644,139202,838704,1181779,965491,1172655,738744,470825,167110,776965,643978,616676,358107,1094843,697436,1110849,892731,3141,59807,1120080,497491,394116,163587,709503,991984,289067,426417,788921,61847,1085688,147025,622247,165521,70810,1061438,62524,1158845,901089,270992,1083517,282291,1062170,980458,722998,130196,877774,170728,560924,1072499,764038,1059243,874758,179289,1093159,274784,751782,518826,34433,392060,649291,513010,1147329,1052950,1065421,333657,661337,986492,649462,481937,628148,249273,293878,105693,741158,669744,1070281,1026952,1165435,719514,160742,686991,1005038,1083837,840699,20540,499424,981711,123976,207407,1098355,1075175,761209,585419,236690,590583,741624,704173,377088,41902,576233,560696,315209,1056919,533371,705401,483241,986731,1096475,190690,590860,116771,963153,28085,936027,795489,500826,972170,876819,750631,636896,299123,722022,104365,1059543,799225,550602,1091470,1191248,1045471,1163318,529683,499770,806737,719955,900346,861416,319649,418263,757247,920020,628401,301388,331460,331904,986887,290426,431696,446212,737102,61560,794530,1193557,611882,199312,600549,1179697,986496,536634,918197,532279,357339,1192361,801186,348401,511436,18069,710223,1050321,940602,1141212,1071505,47852,475923,137544,880751,64159,567478,708295,321691,327457,624911,501176,684368,710977,149620,508023,442080,1074569,1081517,386484,982912,991718,603643,169071,574764,63944,641578,22859,981846,1108355,554210,1157499,529119,833465,396208,1058593,40012,1171899,497778,685274,315136,719868,958193,957409,308158,1063030,684058,1068580,1083819,150344,453532,331794,495414,274086,72891,1068640,589480,703839,213578,754703,793768,1121833,171941,1090182,381353,745228,883030,476780,1123846,899138,191123,358039,616757,469502,344460,253690,303983,217236,608463,792565,310505,755656,270279,827731,394211,1078165,287949,811737,1058513,1098491,833266,18996,920116,316691,1186980,426766,529326,985021,209124,590176,241063,643715,846631,427956,509264,181542,1041081,391624,966733,883910,814321,56485,175335,4023,340934,270849,324794,261049,1194764,112301,51857,126502,841385,1037915,1036992,714271,686080,343833,1166345,210845,1167250,1041292,430352,17828,319624,1123438,426784,21600,552029,376754,1076473,90953,778231,876346,913651,566634,553383,523068,188439,586524,218061,101227,915115,6340,879770,179363,203922,1157108,775327,121885,482275,678830,1170813,1178555,850703,584828,133893,829542,828817,911515,912736,18257,199631,1187164,29002,229909,169290,387836,1185640,1083635,548108,752949,1147525,316702,876703,428400,1164247,683162,1182351,406140,59542,208368,349210,455512,791741,789534,742171,849997,131593,1009268,378246,924464,1074998,961524,450210,585130,1946,220904,180153,683931,1056626,411455,1097543,17639,858423,877530,1062831,306846,930103,162417,165425,382520,175846,1165299,961423,902955,352294,925037,487440,1155557,195387,1089572,814489,110033,527040,769849,87382,866624,781556,538389,536233,248394,1126211,84038,542433,284820,413446,49132,313393,763348,154696,1099011,542598,422989,437956,1186380,577832,984781,988399,772358,2798,150160,851296,631211,113064,95374,675508,226068,685087,797521,692090,947265,98607,536433,597399,175672,82912,1153409,879973,443747,778659,784560,868312,1091380,135635,814269,325168,494360,52239,134157,571380,868033,574566,856606,612166,575091,424903,363403,272615,830634,1176879,202395,1098281,766331,1076966,561874,633631,142741,454854,182651,909624,338528,1044355,294143,1017405,889439,608348,442127,946921,217167,158584,455566,466644,688639,46980,1110807,879344,214735,467391,1183468,49027,878966,94252,1173656,59400,619519,437033,863659,549641,642534,612830,1014939,959203,24202,240356,218687,414860,899188,1176935,1018965,17435,622246,193728,1159826,785885,634548,634704,1026736,69661,1123094,545344,841832,410196,667726,484119,182605,1009065,113862,349727,249465,868539,678796,931770,1064588,1066549,864348,284314,309216,1172049,1059052,271890,913332,1178100,505997,81574,555783,1116885,762781,573012,361287,54577,80646,374097,543369,240850,661401,379325,441136,146114,1159123,248029,639037,1010067,604392,607486,794941,383209,1108600,831981,322561,947068,863062,616086,227103,244786,1060182,746167,754439,1051930,1082617,508890,1146312,985525,369768,447210,142379,1081140,237794,600161,143203,602111,251279,20443,839341,1185135,951198,582009,576080,84043,401398,830145,593130,783255,537936,135113,1161351,901126,425414,326598,893104,264659,6298,866383,390957,611506,22415,326863,606735,412940,1142983,238229,310926,861319,659566,621687,386388,96541,106126,508337,1169730,576630,145246,483098,228008,1075233,323284,920784,643711,959459,1189777,605133,73476,142598,894212,161409,1042218,668452,373214,290449,981016,558545,1084416,83899,868963,699838,450171,487122,540735,257066,923631,609809,1164535,946113,244884,692058,651808,202770,105304,930952,176294,509373,701222,948356,474876,916329,507391,297689,436106,653766,85190,396156,129195,359037,22034,291001,985805,858375,1033385,620035,259193,831392,163350,206076,303280,877461,612952,1167928,1086242,95400,1140207,665596,660979,301869,1140865,76605,540889,705512,946507,1112136,532752,194319,64542,546926,547355,427362,491088,93306,301615,1116957,1128039,39125,1031807,801684,678287,912161,662229,985549,890881,668608,765246,531455,836368,1178876,182823,850344,1126493,516231,148657,115501,843613,492931,823369,30802,974792,1006,377702,694019,449607,820817,130206,595704,63297,920292,144583,15043,1000854,491906,981600,858791,82002,463997,1071546,89446,155264,652488,191306,1186563,208275,576299,1095196,325013,74121,1118379,554358,577106,1095686,880555,800407,756196,613552,1016862,630787,92022,576973,54893,751882,94288,158204,391497,954779,211546,563439,818673,701964,386139,1129679,504804,186257,1032067,656350,281243,671081,498033,680975,570848,299104,59874,428292,616360,884952,176571,1082601,960202,599353,170920,1135585,447521,954650,256006,871026,16685,212038,1062567,565008,890887,499366,221555,986692,998467,729479,627022,860249,889031,135994,272604,1140911,1175245,765555,202059,991185,62921,743395,1068978,640162,427298,1098255,301632,637438,585982,1129283,892047,127433,938450,740545,1187501,107891,1042384,778414,506789,505169,673431,106038,594391,1156658,289586,163956,1083849,502215,131239,211817,107828,423263,1095805,1118165,600251,735,833313,1089429,55766,88791,659634,1099773,614322,862930,745167,207495,1012301,1088247,1048253,566709,834020,316376,487537,815640,1190044,262350,439887,632308,320091,1129660,1040737,510184,588884,742077,1105293,662212,266987,234857,776531,905006,7625,576205,152411,855632,529921,974990,406425,407114,141787,1006550,367688,411801,922569,613618,353281,640591,307305,1161981,1101931,845747,203243,1140365,1001214,1120115,708327,617148,223294,1056040,167623,683746,284516,601807,439640,410951,936899,160605,957107,440105,473587,134641,98083,939929,955227,753701,303238,864074,824546,377431,1149630,845017,426976,596261,1125132,567366,273236,87221,615627,1193306,503353,379860,925444,988001,17934,923925,703518,881458,489187,999249,237063,852101,688115,450476,270554,259292,435061,178056,1128041,1180792,51856,154709,732320,762362,410935,190130,811727,142502,7841,473898,946912,471030,375080,371751,822536,763694,1177803,496909,37456,186050,880511,843434,749660,470030,1026217,332122,828166,104976,598200,345404,1182145,226377,355691,952338,774216,309756,317241,50102,508466,1125270,269043,947234,973024,749661,441823,1135282,607675,256142,629117,472553,546735,1142568,1161405,576029,324519,829488,1153914,1012410,409846,955528,649961,783616,1137938,1168986,1195261,470394,343517,495109,490654,354334,890645,136974,185607,197321,450879,883943,1081571,61387,882017,296527,864453,916822,978312,153089,900582,194969,899288,752397,1142736,16872,927734,1090345,575936,551608,271091,687186,296997,786054,659889,1095474,870034,442166,1044929,876459,122422,910169,540766,580730,710403,765385,204925,421350,1142151,942914,623002,434694,945377,637859,691645,320489,686003,119610,1154907,558722,884101,219108,520523,90394,970891,1011142,233892,440423,1088409,72962,264024,1144609,1098806,334628,828203,259398,1039362,956217,384634,450298,499076,15018,507948,161443,83180,782419,157368,10929,830595,1078871,741184,1134443,311728,1002844,669783,1168289,488163,1129273,1174117,234864,579082,470380,738415,166280,227155,1174184,741157,697951,961216,751399,539378,195373,286389,485660,1044615,148809,620361,648359,444152,137553,626888,1045744,651293,352403,246636,394715,40728,144983,713053,297857,489654,1005471,851016,142604,724970,815799,299374,830551,1121898,734648,990921,321083,704179,207846,696292,1031470,722795,1063893,303037,543276,467939,103004,1110678,923804,522322,863484,693542,725455,314295,480335,288684,446969,949861,1154257,922057,678630,821808,931013,851829,1171933,736821,799241,99290,440348,807772,279654,1163007,915493,126823,173505,105350,831511,400960,5920,745900,1097222,685519,592907,1083011,178061,987006,528036,231540,888832,956863,134127,219509,1190326,694543,46111,462989,750258,375378,352632,975719,210899,842153,940397,933242,278638,1067375,328905,515929,280604,724139,294196,720515,679479,835685,76880,1170531,746362,46398,754147,901807,385743,318841,445980,92640,1116262,364527,916134,17351,595472,616916,776913,912661,935701,406323,888066,997967,456007,8167,863064,559672,445233,795892,1114215,596368,503145,256511,1003463,1180865,388907,927968,480312,937445,334636,602547,1131918,847624,1172349,983519,643203,911643,896483,799686,726066,1051033,26514,920227,779957,114304,1061124,532955,458703,639279,174378,640340,198776,144448,228745,654051,432762,329575,786535,271213,840175,424036,857252,361659,344302,1116153,1042928,1008859,1132180,645876,993435,95464,533040,457270,325156,832844,1139621,421764,247182,568746,884249,836796,1087090,137484,177009,708745,807432,285386,23337,677791,525861,479634,892495,669588,678249,785946,112002,99183,1062335,1118627,747508,69363,1142213,392161,196546,745846,224238,786414,90017,822201,628391,583458,438891,1170617,716722,1039421,490085,829064,1132872,295928,987312,283261,59162,144299,837345,1176500,110119,497400,564791,1021401,793881,330604,515476,1077565,439015,69111,1061891,463644,245888,1126174,1127697,101271,872088,12876,1023292,170008,502587,420964,49243,776659,888753,789054,1102640,16280,853144,22158,387576,132893,282598,789188,917145,254018,636735,48126,1133772,69329,903170,278194,412392,1025366,374659,266088,433249,969738,1185626,280452,219279,489450,769294,167214,239599,5928,520244,771661,493781,809039,483815,370966,201492,211420,523278,255374,726635,576303,982368,761273,1176333,28364,254760,74518,702929,722247,946276,439467,498438,39869,413176,476536,817868,645060,48727,954499,921020,1175345,341017,325830,990622,368409,441931,485088,405885,63841,1150737,769974,155750,122777,481332,920249,159403,117572,1132885,1127318,8995,271207,1009417,967727,402015,199560,793699,671954,1033023,48240,314336,521929,1166106,961913,260416,1078580,562854,546634,397232,928569,301039,591055,606811,665370,1045356,812880,1166099,1159362,695042,347790,972779,471890,78680,717333,578078,36264,262526,267779,658452,894179,1092240,1037316,1159851,80710,965011,335043,1103108,1192376,378081,786295,1050488,1022357,185771,363697,366324,547557,719953,956760,643286,966624,364230,907046,1171314,225739,380542,857566,1089309,1044444,179882,1139542,253955,17614,365517,547067,164411,230474,1005469,907430,1122555,173864,761766,449173,1081845,719236,813802,318946,1078488,761736,97302,206057,839213,3307,169769,55574,712211,86531,909161,219478,866662,907771,1088616,224518,76940,676192,101776,1004525,1177056,2080,35409,417891,467522,1082594,1157651,1033979,638211,347429,372777,636098,44770,1148065,659975,1065834,664976,178104,972186,425507,99509,253420,731387,721711,490175,686596,165993,1134078,1022635,730792,731742,292874,869658,265269,771243,303497,746947,318437,1058879,359377,16302,232590,25426,459337,727256,1030971,421116,554103,581405,839974,103238,500645,87232,305350,1194940,1138274,78001,700590,803965,1034494,488578,206097,909014,771664,409160,1136234,112393,1051056,575834,1032560,1127271,136643,1135557,39236,296992,927089,114564,915790,135911,217623,475083,1067885,320307,1027353,637157,125582,434043,138838,323323,1018792,104922,923297,446299,679255,1163648,806021,548790,685071,50752,145131,132660,864424,536744,211589,548619,716144,569933,948808,904203,1092388,456923,528337,127800,171129,32646,478567,1037339,511090,193043,114244,357382,1177541,698657,216370,1074105,990674,99726,122906,436872,612662,961391,607498,456457,493908,820993,1156179,621848,637385,882872,141162,664710,492680,714840,211350,101606,1007391,607221,1081310,234928,1169996,262054,402592,697255,225911,321262,447450,561185,898958,476059,1093716,138538,398856,647479,106611,6833,152610,34763,668398,698311,391344,478126,297735,336665,878432,779818,440834,278061,569680,896693,866621,866177,211194,907655,766385,751869,460979,1136521,403551,4524,586199,998769,597532,18384,211585,661447,279884,665802,840742,5720,396895,849680,686645,1180012,487858,147760,257479,56869,126576,1150229,722158,1060537,317330,1133922,630603,489786,876390,870624,573170,696905,513713,487104,1048461,690058,756001,123512,116564,811597,215169,206363,594438,1029010,623317,1134137,556503,1175222,216235,89726,643871,40582,668962,364616,801873,139488,1158069,26182,700303,512807,882945,478213,239888,240672,889923,135051,514023,129501,114262,1047737,744549,866287,702667,923995,1125190,129441,608601,494242,984503,443378,404313,76248,1026140,107899,816728,452853,315051,721301,74235,298943,1006958,840042,581324,728579,853621,944391,894098,980845,589618,405516,887576,442425,927802,370350,803870,119916,910132,386344,139568,99590,364815,1179085,277965,881390,11101,771315,668755,213060,988957,607905,957018,554366,351450,770125,688817,1016539,157000,806457,231348,314171,383760,1141596,1022746,1194058,857147,927232,873287,937032,3317,1085780,1146224,1071579,356696,160166,161089,483810,512001,854248,31736,987236,30831,156789,767729,1180253,878457,74643,771297,1176481,646052,821327,121608,1107128,419850,321735,284430,631447,644698,675013,1009642,611557,980020,1096854,282966,1191741,318311,1018718,994159,40973,422754,1076196,715806,519251,27268,19526,347378,613253,1064188,368539,369264,286566,285345,1179824,998450,10917,1169079,968172,1028791,810245,12441,114446,649973,445132,50556,881379,321378,769681,33834,514919,15730,791941,1138539,989713,848871,742569,406340,408547,455910,348084,1066488,188813,819835,273617,123083,236557,747871,612951,1196135,977177,1017928,514150,141455,786626,100538,1180442,339658,320551,135250,891235,267978,1035664,1032656,815561,1022235,32782,236658,295126,845787,273044,710641,42524,1002694,108509,383592,1088048,671041,428232,1110699,331457,416525,659692,661848,949687,71870,1114043,655648,913261,784635,1148949,884688,434733,1043385,99070,655483,775092,760125,11701,620249,213300,209682,425723,1195283,1047921,346785,566870,1085017,1102707,522573,972013,512994,400560,505991,250816,1099474,661648,600682,1022409,1115169,44672,318108,754334,419422,413521,329769,106701,1062446,383812,872913,703721,1145842,1063924,626701,330048,623515,341475,585915,622990,773178,834678,925466,367447,21202,995686,99800,431750,121115,636207,564450,1055340,743227,1015430,288457,859553,153726,903938,180676,308642,589733,755954,251160,980914,1039497,742515,731437,509442,1151101,87274,318737,983346,730690,14613,1149054,319115,1103829,24425,1138681,578562,761048,334422,648440,555547,585251,183142,238878,1173879,957725,979394,783221,298893,21146,179116,1180646,575835,1004353,38255,412196,563533,563377,171345,1128420,74987,652737,356249,787885,530355,713962,1015476,189016,1084219,848354,948616,329542,519285,266311,133493,131532,333733,913767,888865,26032,139029,926191,284749,19981,692084,1116507,642298,81196,435300,625069,836794,1143504,1117435,823984,654712,957231,536680,818756,756945,1051967,38958,950052,559044,188014,593689,590595,403140,814872,89481,366100,875520,251013,335019,581995,970978,953295,137899,451914,443642,146151,115464,689191,51769,212556,828313,750871,1055702,116941,960287,597920,1054878,595970,946802,1177638,358740,12946,246883,616072,622001,1114038,796683,367936,604951,414826,660145,1062968,36730,296955,772667,871483,304977,933422,1191783,331698,807124,586575,1175666,871218,591346,785141,55098,959852,887155,336762,538515,576394,811693,1101540,1091955,689744,28351,621451,1052835,714983,970073,122848,874797,277297,554370,238622,8304,592948,1124605,1055483,303869,1036672,155863,529629,824867,907632,217065,639536,113665,1114182,329118,498243,747910,710959,657346,941015,274450,588272,33546,251968,953197,506023,546273,995311,1092777,267129,1021787,688708,496859,249725,723205,281752,690690,900392,761975,544315,1112891,801925,1068886,839044,1176047,907080,212276,339706,164696,578046,938888,366689,1034731,992005,894801,320620,585129,30153,111839,1102681,57874,532485,537102,896212,57216,1121476,657192,492569,251574,85945,665329,1003762,1133539,651155,650726,770719,706993,1104775,896466,81124,70042,1158956,166274,396397,519794,285920,535852,212532,307200,529473,432835,666626,361713,19205,1015258,347737,71588,681850,1049424,1082580,354468,705150,374712,1167279,223289,1197075,820379,504062,748474,377264,1067875,602377,1134784,277789,1053498,1183038,197227,706175,216481,339290,1116079,734084,126535,1108635,1042817,545593,1006775,11518,989806,621782,102885,873068,1123960,79702,643723,620975,102395,317526,397674,441885,584529,181219,567294,1106059,621108,1143188,446199,1103793,1039877,806584,243302,986535,634642,379408,496117,811942,68402,693277,1011824,166014,541731,916838,527000,700048,517106,627233,898977,1138207,769789,581721,313129,1021510,115480,237879,598728,1027161,62496,750560,243431,942075,327055,1181396,986043,135514,633073,307194,698715,976526,211389,199614,468602,571059,337832,309050,1062087,925477,57170,22836,432526,996022,206896,1135160,454686,129103,557919,770783,99826,896449,560643,612099,68798,306034,1070648,259631,457536,10580,1090190,155697,419667,691292,692912,524650,1092043,603690,41423,908495,1034125,114232,695866,1066842,986264,1090253,774818,102276,79916,597830,1197346,364768,108652,1142315,1109290,538447,98308,583759,335151,452914,990586,185780,109834,149828,631372,364061,881705,710544,382441,8037,935731,758194,565773,877990,68421,157344,687897,609197,456004,92788,535869,931094,963224,421550,293075,1190456,621876,1045670,342449,668160,223091,791656,790967,1056294,191531,830393,786280,275512,584463,844800,557490,890776,36100,96150,352334,994838,57716,196867,77966,489754,580933,974787,142041,1030458,514335,913565,596274,758441,787130,261182,1037476,240974,757976,724494,1063440,1099998,258152,242854,444380,894843,334007,373535,820650,48451,353064,771105,601820,72949,630715,924845,1110860,582454,4775,694728,818221,272637,210080,1180147,274156,494563,316623,708894,198832,961018,345980,509966,747605,927527,938789,763020,1020025,70040,17289,1146225,1043372,465761,435719,787146,1007951,386354,1055579,1190240,724183,251169,727051,823001,826330,375545,434387,20278,701172,1160625,1012031,317570,354647,448421,728051,171864,865959,369915,1093105,599881,852677,15936,971704,842390,245743,423865,888325,880840,1147979,689615,72811,929038,250847,225057,448420,756258,62799,590406,941939,568964,725528,651346,55513,36676,622052,873562,368593,44167,185671,788235,242553,548120,414465,60143,29095,2820,727687,854564,702972,707427,843747,307436,1061107,1012474,1000760,747202,314138,116510,1136694,316064,901554,333628,281259,219769};

/* multiplication inverses of omega */

/* (in Montgomery form) */
static const uint32_t w_3_inv[2]={208029,1143141};

static const uint32_t w_5_inv[4][4]={{49662,383910,660224,257374},
{383910,257374,49662,660224},
{660224,49662,257374,383910},
{257374,660224,383910,49662}};

static const uint32_t omega_256_inv[128]={1044992,307436,185671,756258,971704,1160625,1007951,509966,4775,894843,596274,96150,223091,609197,631372,364768,41423,306034,432526,307194,115480,166014,446199,79702,1116079,504062,1015258,1158956,251574,320620,1068886,267129,747910,1055483,28351,871218,660145,595970,443642,590595,1117435,26032,1015476,1004353,555547,318737,903938,21202,703721,600682,1047921,884688,428232,1022235,514150,455910,881379,285345,40973,284430,156789,3317,1016539,277965,405516,315051,923995,882945,1175222,1048461,1150229,279884,907655,391344,561185,211350,961391,511090,548619,923297,135911,1136234,87232,359377,165993,1148065,1177056,55574,761766,1044444,366324,1037316,695042,1078580,1009417,63841,817868,761273,520244,1025366,387576,12876,793881,829064,196546,479634,247182,1116153,198776,799686,388907,997967,445980,724139,750258,1083011,279654,949861,543276,299374,352403,539378,1129273,83180,1144609,1154907,765385,296997};
static const uint32_t omega_1024_inv[512]={1044992,1120589,829739,537286,307436,614086,228952,304665,185671,796865,294199,89912,756258,823228,103957,701033,971704,246504,363605,583455,1160625,157087,629890,135675,1007951,198667,261670,523201,509966,277947,634924,1066157,4775,835961,88012,1163800,894843,399868,476696,894139,596274,528454,484193,392082,96150,248062,316960,884155,223091,173312,334069,328096,609197,711371,340758,405438,631372,967950,592667,183511,364768,943126,955994,892175,41423,60192,1178502,367015,306034,685282,1019562,420864,432526,317149,337899,301094,307194,7680,471384,88866,115480,49220,250469,288729,166014,552564,54578,586821,446199,1032820,1017463,1111968,79702,915828,545967,237475,1116079,964764,45180,751302,504062,454707,252112,78821,1015258,695829,367748,152592,1158956,163223,796842,1127700,251574,562472,108600,225979,320620,1183679,22081,902266,1068886,288340,250714,734327,267129,637368,1051429,328831,747910,1014716,595170,999829,1055483,675002,538355,114713,28351,276226,233516,869339,871218,391251,310969,932023,660145,588669,829194,597435,595970,449891,16419,487351,443642,714884,133307,143759,590595,625424,707705,362850,1117435,164408,775975,247531,26032,1178467,645667,291589,1015476,192537,971183,218270,1004353,569381,1172886,681260,555547,301317,1133330,784333,318737,1079336,443021,455872,903938,901942,464935,325775,21202,95770,1048419,331283,703721,657456,157799,404023,600682,1068577,78430,807803,1047921,667629,1182807,837168,884688,806174,906752,1022244,428232,854808,619557,897968,1022235,910656,1022248,1012542,514150,444897,136713,480109,455910,464478,61853,3746,881379,861410,568007,541928,285345,647207,11711,452975,40973,219772,1163935,846969,284430,572326,661004,869777,156789,229711,354995,841230,3317,1113384,855510,130996,1016539,321430,896435,527534,277965,868157,731277,416886,405516,44607,315524,781040,315051,576040,462146,862208,923995,871274,185024,334081,882945,785304,187391,453155,1175222,465215,492721,136762,1048461,476133,721055,21607,1150229,702105,618173,4316,279884,240885,838658,489421,907655,542276,800913,961986,391344,118245,799251,193543,561185,804615,208279,207668,211350,130336,451869,220193,961391,336104,1070761,422144,511090,331960,756506,1108018,548619,654842,499053,180960,923297,746064,923876,860226,135911,737892,467222,739459,1136234,872719,1003796,74681,87232,1041045,230617,912300,359377,1177581,613750,268233,165993,480139,45911,305705,1148065,883779,409677,1045058,1177056,1206,51558,326579,55574,1112210,686108,673396,761766,307666,665643,1008494,1044444,143465,774726,504086,366324,604326,228942,41971,1037316,35434,400215,247146,695042,1019572,683558,778962,1078580,231883,143860,368410,1009417,1089864,10937,8604,63841,470214,503774,317222,817868,673531,713892,192228,761273,775359,119866,969881,520244,466999,1111404,359581,1025366,13326,945221,878661,387576,815485,613379,586166,12876,1104801,864094,867530,793881,500423,227608,461789,829064,776656,884626,135936,196546,135231,845915,871194,479634,1156836,781902,435351,247182,1161508,349812,309699,1116153,991770,931493,1114335,198776,10024,225878,542805,799686,838003,56098,979636,388907,556475,478084,1174020,997967,1023565,1104609,373077,445980,790994,1098233,1089955,724139,46161,882650,224317,750258,155439,708451,311294,1083011,1136586,774516,977917,279654,189328,59116,947723,949861,564415,591026,685574,543276,712531,861237,1055341,299374,650904,324738,96081,352403,801946,302797,475369,539378,390911,964021,1134009,1129273,598970,184745,912253,83180,987029,269843,526892,1144609,432040,10263,993092,1154907,1146480,1179615,611297,765385,9377,961175,1131551,296997,269136,884106,852820};
static const uint32_t omega_1280_inv[1280]={1044992,518431,595974,772692,1085350,307436,118306,880468,945987,1121445,185671,876766,837987,399888,644532,756258,308821,7252,316422,1023189,971704,1077508,33997,286941,464104,1160625,153906,439402,612802,752933,1007951,855321,14301,751196,279594,509966,24743,63573,483742,387876,4775,1022815,304470,785190,426639,894843,355627,959143,1194565,178985,596274,385320,621483,613947,232928,96150,447698,491711,593174,793921,223091,242189,645942,612923,405000,609197,375913,451905,187251,274304,631372,496610,209871,778864,160533,364768,705419,586872,448902,326832,41423,330764,92054,1135986,147737,306034,634697,995561,559883,1080985,432526,1056878,74880,596126,672270,307194,814172,479895,706722,246237,115480,887346,595175,654235,351936,166014,763507,485347,951214,458385,446199,79041,542756,336667,1000201,79702,216402,1019882,114048,4777,1116079,357288,539630,730917,1113256,504062,268045,1093448,537857,719970,1015258,142260,93823,960405,140099,1158956,200363,691778,660771,826114,251574,987697,458621,668622,321160,320620,299041,415153,821898,136346,1068886,528109,223933,1167741,118781,267129,311371,308833,566836,633330,747910,401210,1189905,924607,932677,1055483,917695,896082,624787,133626,28351,580489,1119015,687606,201189,871218,909147,48638,119883,138110,660145,388426,492674,1170793,1066087,595970,586164,979714,798556,707831,443642,649117,107479,387905,159022,590595,338093,404897,598425,51948,1117435,91987,407804,774496,145727,26032,268171,978675,271148,824743,1015476,723388,1058661,552147,958214,1004353,804725,841199,421747,406489,555547,162241,938878,284913,542807,318737,1148979,1006408,787005,1198049,903938,352993,334717,1121957,99635,21202,274839,419791,248453,417026,703721,479082,1133498,341178,494897,600682,1067325,818498,932319,1134361,1047921,522325,72670,574372,1014349,884688,49662,1145892,823144,731930,428232,898597,492329,657806,341549,1022235,813773,1043023,952260,114136,514150,1043909,335377,748971,756441,455910,47775,611221,110682,1188157,881379,296823,20343,952705,497999,285345,320454,944696,823583,836001,40973,911822,188814,77179,1173885,284430,783090,742081,547669,606212,156789,694386,72765,212088,1127042,3317,125895,138740,86280,252962,1016539,1171883,377484,627836,941036,277965,25541,135398,1190747,652078,405516,709689,824066,595718,815710,315051,589010,707395,479467,1115603,923995,1147837,468228,579952,39251,882945,239594,642083,372185,329554,1175222,331202,149493,722318,283742,1048461,543904,1154639,167627,501820,1150229,590439,251987,1077417,582809,279884,854355,494867,399803,275055,907655,1160473,254328,19477,106066,391344,1181697,356990,1020266,49521,561185,693718,72695,542091,476493,211350,258894,880852,881460,479772,961391,592173,840448,145464,940707,511090,921628,993345,258337,66529,548619,577615,85638,267243,835095,923297,946888,5961,18560,475438,135911,1151343,1021004,917669,881731,1136234,929744,865061,137282,387441,87232,317629,998206,499180,246011,359377,909317,787592,1015170,830968,165993,982316,1128839,1133432,857709,1148065,317595,610799,799355,826288,1177056,790539,660359,783026,153795,55574,77565,4541,893656,115169,761766,768543,500223,959947,348101,1044444,123796,500814,963596,380767,366324,181870,944522,1096182,1033159,1037316,797418,356179,342225,197280,695042,711332,763258,854789,365778,1078580,902180,1041526,632854,116536,1009417,927216,391303,467866,472302,63841,1000308,277002,646003,1061313,817868,308103,71744,524056,521235,761273,542506,659477,388356,822677,520244,76039,728969,130195,576813,1025366,652683,1062013,1112081,823188,387576,392147,288601,1196040,670568,12876,195051,985361,551640,79329,793881,753973,383910,764818,517768,829064,36659,1018982,78083,198297,196546,13422,496422,1027703,606296,479634,516580,541974,1010954,715740,247182,1051804,684150,781932,655870,1116153,213813,97734,31764,390732,198776,967816,682523,390771,819343,799686,686427,333787,885113,698966,388907,159127,694631,714876,691888,997967,136861,1122746,949853,490526,445980,649362,749590,867705,29947,724139,136863,17929,1002671,244966,750258,867775,898025,176607,1126911,1083011,260559,647867,523448,922923,279654,911724,411202,1083340,27434,949861,863582,657252,865203,768621,543276,623687,355909,930476,255336,299374,368556,31447,1183441,213690,352403,377700,1115700,654975,115267,539378,960463,448593,294516,267609,1129273,1004343,338405,577109,451466,83180,661563,618147,800125,790498,1144609,898338,395451,1006361,991463,1154907,684193,390946,593376,628937,765385,600330,227914,1107178,1019963,296997,945825,755547,699737,399749,153089,679650,602107,425389,112731,890645,1079775,317613,252094,76636,1012410,321315,360094,798193,553549,441823,889260,1190829,881659,174892,226377,120573,1164084,911140,733977,37456,1044175,758679,585279,445148,190130,342760,1183780,446885,918487,688115,1173338,1134508,714339,810205,1193306,175266,893611,412891,771442,303238,842454,238938,3516,1019096,601807,812761,576598,584134,965153,1101931,750383,706370,604907,404160,974990,955892,552139,585158,793081,588884,822168,746176,1010830,923777,566709,701471,988210,419217,1037548,833313,492662,611209,749179,871249,1156658,867317,1106027,62095,1050344,892047,563384,202520,638198,117096,765555,141203,1123201,601955,525811,890887,383909,718186,491359,951844,1082601,310735,602906,543846,846145,1032067,434574,712734,246867,739696,751882,1119040,655325,861414,197880,1118379,981679,178199,1084033,1193304,82002,840793,658451,467164,84825,694019,930036,104633,660224,478111,182823,1055821,1104258,237676,1057982,39125,997718,506303,537310,371967,946507,210384,739460,529459,876921,877461,899040,782928,376183,1061735,129195,669972,974148,30340,1079300,930952,886710,889248,631245,564751,450171,796871,8176,273474,265404,142598,280386,301999,573294,1064455,1169730,617592,79066,510475,996892,326863,288934,1149443,1078198,1059971,537936,809655,705407,27288,131994,602111,611917,218367,399525,490250,754439,548964,1090602,810176,1039059,607486,859988,793184,599656,1146133,80646,1106094,790277,423585,1052354,1172049,929910,219406,926933,373338,182605,474693,139420,645934,239867,193728,393356,356882,776334,791592,642534,1035840,259203,913168,655274,879344,49102,191673,411076,32,294143,845088,863364,76124,1098446,1176879,923242,778290,949628,781055,494360,718999,64583,856903,703184,597399,130756,379583,265762,63720,150160,675756,1125411,623709,183732,313393,1148419,52189,374937,466151,769849,299484,705752,540275,856532,175846,384308,155058,245821,1083945,683931,154172,862704,449110,441640,742171,1150306,586860,1087399,9924,316702,901258,1177738,245376,700082,912736,877627,253385,374498,362080,1157108,286259,1009267,1120902,24196,913651,414991,456000,650412,591869,1041292,503695,1125316,985993,71039,1194764,1072186,1059341,1111801,945119,181542,26198,820597,570245,257045,920116,1172540,1062683,7334,546003,792565,488392,374015,602363,382371,883030,609071,490686,718614,82478,274086,50244,729853,618129,1158830,315136,958487,555998,825896,868527,22859,866879,1048588,475763,914339,149620,654177,43442,1030454,696261,47852,607642,946094,120664,615272,918197,343726,703214,798278,923026,290426,37608,943753,1178604,1092015,806737,16384,841091,177815,1148560,636896,504363,1125386,655990,721588,986731,939187,317229,316621,718309,236690,605908,357633,1052617,257374,686991,276453,204736,939744,1131552,649462,620466,1112443,930838,362986,274784,251193,1192120,1179521,722643,1062170,46738,177077,280412,316350,61847,268337,333020,1060799,810640,1110849,880452,199875,698901,952070,838704,288764,410489,182911,367113,1032088,215765,69242,64649,340372,50016,880486,587282,398726,371793,21025,407542,537722,415055,1044286,1142507,1120516,1193540,304425,1082912,436315,429538,697858,238134,849980,153637,1074285,697267,234485,817314,831757,1016211,253559,101899,164922,160765,400663,841902,855856,1000801,503039,486749,434823,343292,832303,119501,295901,156555,565227,1081545,188664,270865,806778,730215,725779,1134240,197773,921079,552078,136768,380213,889978,1126337,674025,676846,436808,655575,538604,809725,375404,677837,1122042,469112,1067886,621268,172715,545398,136068,86000,374893,810505,805934,909480,2041,527513,1185205,1003030,212720,646441,1118752,404200,444108,814171,433263,680313,369017,1161422,179099,1119998,999784,1001535,1184659,701659,170378,591785,718447,681501,656107,187127,482341,950899,146277,513931,416149,542211,81928,984268,1100347,1166317,807349,999305,230265,515558,807310,378738,398395,511654,864294,312968,499115,809174,1038954,503450,483205,506193,200114,1061220,75335,248228,707555,752101,548719,448491,330376,1168134,473942,1061218,1180152,195410,953115,447823,330306,300056,1021474,71170,115070,937522,550214,674633,275158,918427,286357,786879,114741,1170647,248220,334499,540829,332878,429460,654805,574394,842172,267605,942745,898707,829525,1166634,14640,984391,845678,820381,82381,543106,1082814,658703,237618,749488,903565,930472,68808,193738,859676,620972,746615,1114901,536518,579934,397956,407583,53472,299743,802630,191720,206618,43174,513888,807135,604705,569144,432696,597751,970167,90903,178118,901084,252256,442534,498344,798332};
static const uint32_t omega_3072_inv[3072]={1044992,112956,151312,1120589,358558,1080392,829739,749168,148412,537286,275737,378235,307436,87438,320776,614086,1180985,10149,228952,657945,1113391,304665,303877,80931,185671,92377,133885,796865,813955,710884,294199,1155951,486835,89912,297022,546755,756258,925871,330769,823228,552115,1098989,103957,959276,103012,701033,1086130,1036151,971704,882488,581689,246504,521382,775175,363605,169935,797469,583455,40683,1065096,1160625,988213,168037,157087,701939,740380,629890,330928,889499,135675,962732,910520,1007951,339788,325004,198667,83821,614104,261670,573348,462185,523201,192084,1167866,509966,93490,597782,277947,1058237,366420,634924,417221,250794,1066157,819198,439717,4775,867484,642455,835961,64721,738411,88012,823747,203301,1163800,1038117,269040,894843,230614,39557,399868,1073108,642045,476696,15830,750686,894139,110495,376397,596274,885171,200475,528454,75787,791970,484193,1106093,1098234,392082,299426,636992,96150,1058448,39934,248062,688508,2496,316960,221663,392816,884155,40736,687826,223091,942794,37531,173312,381504,615037,334069,412845,770299,328096,161231,183693,609197,944145,593091,711371,647882,1018240,340758,970422,197450,405438,1073866,400381,631372,519123,534391,967950,252178,934707,592667,135288,959668,183511,186725,840622,364768,210101,1044272,943126,386891,177836,955994,792161,1046048,892175,844133,825980,41423,544666,752102,60192,86486,1152205,1178502,1092601,613724,367015,265041,64461,306034,1138203,1182189,685282,360836,417348,1019562,447195,800785,420864,360128,235281,432526,59291,509671,317149,752544,915041,337899,1022086,1197791,301094,111526,768441,307194,1131908,736085,7680,330141,682040,471384,416475,678302,88866,870754,965543,115480,901908,620898,49220,290624,901652,250469,825206,35295,288729,307731,1061860,166014,1175073,703242,552564,864166,774072,54578,602381,815881,586821,652442,952181,446199,950786,407292,1032820,901990,692751,1017463,288169,21578,1111968,1030203,1107265,79702,321444,176673,915828,545358,686377,545967,533312,1030611,237475,864736,17014,1116079,886,542591,964764,31917,689207,45180,23356,1091991,751302,849483,1013841,504062,910479,372984,454707,925272,638704,252112,1110646,923766,78821,1054369,366754,1015258,883683,1117439,695829,763209,748718,367748,834283,435317,152592,576572,72871,1158956,300111,462858,163223,1081772,636341,796842,457754,190921,1127700,263163,931900,251574,1165207,64787,562472,954994,880214,108600,980557,209584,225979,142172,942967,320620,594276,1092251,1183679,997373,655399,22081,515362,993753,902266,174839,68533,1068886,1150386,563512,288340,273693,1070994,250714,1025278,312893,734327,337397,436098,267129,53130,940744,637368,1126938,442879,1051429,362052,80244,328831,761447,1016487,747910,1033143,1111967,1014716,876296,532665,595170,560657,401952,999829,352879,589632,1055483,846138,727309,675002,499249,652570,538355,58206,479410,114713,1004189,783663,28351,574291,689454,276226,762892,631663,233516,653834,944627,869339,616896,370458,871218,963025,655887,391251,608620,394713,310969,889364,441092,932023,958394,820450,660145,440442,450121,588669,518474,67976,829194,695320,68812,597435,894363,1183421,595970,969447,672678,449891,620902,111168,16419,287881,353646,487351,892718,867007,443642,887200,473492,714884,1140068,113419,133307,231946,300864,143759,361135,255637,590595,394411,426219,625424,654684,929686,707705,182347,131072,362850,458060,137619,1117435,633881,1037414,164408,264571,1172138,775975,772395,440661,247531,851478,760300,26032,602368,614550,1178467,550556,916376,645667,260803,325010,291589,271554,292488,1015476,665606,1149279,192537,994991,905876,971183,2247,54940,218270,560989,751312,1004353,927369,766756,569381,127387,801143,1172886,379441,1013543,681260,372334,1170886,555547,336728,858024,301317,1168965,757045,1133330,1193141,171404,784333,819993,771072,318737,186199,1081027,1079336,50520,56347,443021,854421,811463,455872,996412,149364,903938,909402,466619,901942,1147456,713680,464935,1179616,373904,325775,158334,844932,21202,81180,447691,95770,1163793,929708,1048419,471341,948615,331283,396979,660162,703721,782351,76784,657456,728734,1178519,157799,945954,1053211,404023,725219,655359,600682,861250,1141058,1068577,1157227,1078951,78430,989357,1112031,807803,83259,296977,1047921,1145382,941829,667629,131293,191234,1182807,671600,528039,837168,786315,365121,884688,1106821,391960,806174,14637,245910,906752,160823,1053483,1022244,50494,851766,428232,650649,739853,854808,814527,1182881,619557,846611,864174,897968,704249,572920,1022235,1109192,1169207,910656,718021,601466,1022248,112442,577561,1012542,753826,401998,514150,194724,120711,444897,1154089,403985,136713,265104,1040142,480109,157397,710585,455910,386837,539619,464478,92462,252199,61853,650692,207713,3746,506414,195392,881379,179740,491217,861410,24735,883106,568007,413707,941202,541928,281531,253838,285345,615287,611576,647207,149163,187213,11711,458026,809142,452975,459570,759450,40973,764002,1049099,219772,1058924,223260,1163935,732700,299749,846969,418115,917281,284430,821654,137197,572326,209524,494840,661004,564884,1169127,869777,211716,896076,156789,879137,202235,229711,431768,300955,354995,1011937,968839,841230,196216,463776,3317,1050977,550414,1113384,196256,1083256,855510,903672,384103,130996,383919,875631,1016539,355153,1062721,321430,1157936,78424,896435,924298,1129419,527534,204719,360827,277965,138922,929619,868157,282477,527568,731277,1025287,452276,416886,1053054,368726,405516,1083771,444748,44607,733953,535664,315524,745870,589769,781040,140704,971590,315051,609005,366803,576040,220354,487710,462146,1117289,768941,862208,402551,691894,923995,31101,32625,871274,632216,411260,185024,855017,457067,334081,598689,1145765,882945,470762,368209,785304,282817,1000824,187391,372235,835754,453155,851068,401035,1175222,614643,222596,465215,723652,348850,492721,192238,1156702,136762,1023967,376813,1048461,1121795,1064665,476133,881297,107887,721055,863865,904809,21607,363010,539818,1150229,528215,1166718,702105,915060,632152,618173,978061,1090705,4316,947437,58812,279884,1104531,869160,240885,959842,482087,838658,1098406,659684,489421,602621,938518,907655,966693,1152396,542276,878683,359623,800913,7038,1170216,961986,139947,30660,391344,850830,309372,118245,592547,673010,799251,625426,685658,193543,999860,832976,561185,192521,747199,804615,1030105,787620,208279,382821,644039,207668,504912,895538,211350,20158,685886,130336,945228,592378,451869,104082,498989,220193,390465,416648,961391,509830,383420,336104,778784,1144462,1070761,236486,1123146,422144,1014192,1147675,511090,727744,223361,331960,98949,77564,756506,1172404,103193,1108018,958684,519356,548619,870082,142927,654842,980470,60296,499053,13280,795509,180960,216061,1094555,923297,3904,557198,746064,4,61948,923876,584310,103177,860226,857423,578278,135911,1023421,307478,737892,436826,758936,467222,655955,246286,739459,743335,866897,1136234,640311,1178101,872719,247392,1094947,1003796,687677,311690,74681,436482,223732,87232,724697,957712,1041045,87898,256310,230617,86018,1092775,912300,1018948,522825,359377,585354,696552,1177581,7965,1149693,613750,769677,279830,268233,377644,739267,165993,849846,645217,480139,622007,451169,45911,561624,1000909,305705,835304,672491,1148065,560615,949579,883779,208029,105314,409677,828804,645795,1045058,1135098,1018294,1177056,263857,897149,1206,706107,593822,51558,556800,572643,326579,629072,841453,55574,452380,829453,1112210,1183814,691956,686108,1172288,702863,673396,786828,1121466,761766,1164516,145999,307666,55205,728082,665643,524217,351823,1008494,362662,1140747,1044444,12647,576886,143465,600281,641368,774726,598428,697901,504086,84086,1123916,366324,346253,1007736,604326,986071,541151,228942,503075,1782,41971,644975,326528,1037316,1042844,393148,35434,45260,64235,400215,456692,516861,247146,879388,495229,695042,555750,1084427,1019572,602065,714313,683558,19030,1187765,778962,306905,250408,1078580,323158,363609,231883,523264,1167765,143860,727241,819967,368410,303948,1180508,1009417,280191,1066716,1089864,158640,791630,10937,451898,553205,8604,263157,838978,63841,288742,509062,470214,267900,12797,503774,44466,946448,317222,685014,1002644,817868,209384,722822,673531,481411,1152175,713892,153936,1023723,192228,1001832,223234,761273,717911,95977,775359,817051,735396,119866,537273,74406,969881,205550,51633,520244,1122184,1098703,466999,796597,257682,1111404,682102,233497,359581,150459,1089069,1025366,477668,692222,13326,309830,22805,945221,483969,33167,878661,18909,511919,387576,3702,1023067,815485,444374,242874,613379,1014405,852163,586166,93105,625692,12876,529166,319802,1104801,258326,302303,864094,857089,197944,867530,156776,677806,793881,127825,395963,500423,863093,929655,227608,210794,994034,461789,380754,980597,829064,1078172,1192948,776656,536313,781939,884626,146627,448854,135936,212515,91298,196546,782162,743984,135231,76909,197169,845915,867951,686398,871194,591337,1103036,479634,1187639,25681,1156836,1013939,823707,781902,311607,1185422,435351,679150,42951,247182,238839,423546,1161508,286262,439894,349812,1014243,739431,309699,390170,640307,1116153,1146924,861163,991770,143570,1028335,931493,1136851,611142,1114335,547421,287871,198776,573823,630024,10024,689239,540764,225878,974147,378637,542805,684739,337962,799686,173785,518369,838003,539069,333195,56098,181001,851028,979636,323029,761948,388907,249522,535989,556475,331692,740757,478084,1144409,249950,1174020,1168565,552650,997967,270029,636433,1023565,141444,451160,1104609,879065,285252,373077,696917,839931,445980,1153376,144483,790994,943934,919577,1098233,376595,68457,1089955,369876,244351,724139,702533,355010,46161,839131,37190,882650,694421,522971,224317,760560,458409,750258,256108,696486,155439,339064,1093226,708451,952920,1108363,311294,1130315,26914,1083011,655438,626074,1136586,101330,1009681,774516,940401,117651,977917,58658,291048,279654,1136764,461854,189328,418529,140413,59116,195608,632328,947723,893851,442563,949861,458789,644913,564415,1094210,372606,591026,1078903,533135,685574,90716,767760,543276,790630,98990,712531,641587,572136,861237,939727,462142,1055341,1043146,277898,299374,1029749,66572,650904,1094795,1045934,324738,871449,946279,96081,1187926,876207,352403,406306,139610,801946,430056,144993,302797,128105,1138080,475369,1030039,963559,539378,326354,738740,390911,135364,938599,964021,505886,404823,1134009,926085,50744,1129273,662594,29513,598970,705288,1088860,184745,128387,713090,912253,291059,450011,83180,271585,772585,987029,1000725,1050340,269843,152013,1194247,526892,1044794,640773,1144609,951188,642661,432040,919176,878351,10263,796389,630629,993092,250007,858698,1154907,1091541,970638,1146480,1173421,278419,1179615,358417,94806,611297,1118658,405186,765385,902162,960353,9377,253798,863946,961175,758881,813518,1131551,1197631,219336,296997,159580,972438,269136,1183514,838180,884106,479954,153074,852820,1176477,881532,153089,1085125,1046769,77492,839523,117689,368342,448913,1049669,660795,922344,819846,890645,1110643,877305,583995,17096,1187932,969129,540136,84690,893416,894204,1117150,1012410,1105704,1064196,401216,384126,487197,903882,42130,711246,1108169,901059,651326,441823,272210,867312,374853,645966,99092,1094124,238805,1095069,497048,111951,161930,226377,315593,616392,951577,676699,422906,834476,1028146,400612,614626,1157398,132985,37456,209868,1030044,1040994,496142,457701,568191,867153,308582,1062406,235349,287561,190130,858293,873077,999414,1114260,583977,936411,624733,735896,674880,1005997,30215,688115,1104591,600299,920134,139844,831661,563157,780860,947287,131924,378883,758364,1193306,330597,555626,362120,1133360,459670,1110069,374334,994780,34281,159964,929041,303238,967467,1158524,798213,124973,556036,721385,1182251,447395,303942,1087586,821684,601807,312910,997606,669627,1122294,406111,713888,91988,99847,805999,898655,561089,1101931,139633,1158147,950019,509573,1195585,881121,976418,805265,313926,1157345,510255,974990,255287,1160550,1024769,816577,583044,864012,785236,427782,869985,1036850,1014388,588884,253936,604990,486710,550199,179841,857323,227659,1000631,792643,124215,797700,566709,678958,663690,230131,945903,263374,605414,1062793,238413,1014570,1011356,357459,833313,987980,153809,254955,811190,1020245,242087,405920,152033,305906,353948,372101,1156658,653415,445979,1137889,1111595,45876,19579,105480,584357,831066,933040,1133620,892047,59878,15892,512799,837245,780733,178519,750886,397296,777217,837953,962800,765555,1138790,688410,880932,445537,283040,860182,175995,290,896987,1086555,429640,890887,66173,461996,1190401,867940,516041,726697,781606,519779,1109215,327327,232538,1082601,296173,577183,1148861,907457,296429,947612,372875,1162786,909352,890350,136221,1032067,23008,494839,645517,333915,424009,1143503,595700,382200,611260,545639,245900,751882,247295,790789,165261,296091,505330,180618,909912,1176503,86113,167878,90816,1118379,876637,1021408,282253,652723,511704,652114,664769,167470,960606,333345,1181067,82002,1197195,655490,233317,1166164,508874,1152901,1174725,106090,446779,348598,184240,694019,287602,825097,743374,272809,559377,945969,87435,274315,1119260,143712,831327,182823,314398,80642,502252,434872,449363,830333,363798,762764,1045489,621509,1125210,39125,897970,735223,1034858,116309,561740,401239,740327,1007160,70381,934918,266181,946507,32874,1133294,635609,243087,317867,1089481,217524,988497,972102,1055909,255114,877461,603805,105830,14402,200708,542682,1176000,682719,204328,295815,1023242,1129548,129195,47695,634569,909741,924388,127087,947367,172803,885188,463754,860684,761983,930952,1144951,257337,560713,71143,755202,146652,836029,1117837,869250,436634,181594,450171,164938,86114,183365,321785,665416,602911,637424,796129,198252,845202,608449,142598,351943,470772,523079,698832,545511,659726,1139875,718671,1083368,193892,414418,1169730,623790,508627,921855,435189,566418,964565,544247,253454,328742,581185,827623,326863,235056,542194,806830,589461,803368,887112,308717,756989,266058,239687,377631,537936,757639,747960,609412,679607,1130105,368887,502761,1129269,600646,303718,14660,602111,228634,525403,748190,577179,1086913,1181662,910200,844435,710730,305363,331074,754439,310881,724589,483197,58013,1084662,1064774,966135,897217,1054322,836946,942444,607486,803670,771862,572657,543397,268395,490376,1015734,1067009,835231,740021,1060462,80646,564200,160667,1033673,933510,25943,422106,425686,757420,950550,346603,437781,1172049,595713,583531,19614,647525,281705,552414,937278,873071,906492,926527,905593,182605,532475,48802,1005544,203090,292205,226898,1195834,1143141,979811,637092,446769,193728,270712,431325,628700,1070694,396938,25195,818640,184538,516821,825747,27195,642534,861353,340057,896764,29116,441036,64751,4940,1026677,413748,378088,427009,879344,1011882,117054,118745,1147561,1141734,755060,343660,386618,742209,201669,1048717,294143,288679,731462,296139,50625,484401,733146,18465,824177,872306,1039747,353149,1176879,1116901,750390,1102311,34288,268373,149662,726740,249466,866798,801102,537919,494360,415730,1121297,540625,469347,19562,1040282,252127,144870,794058,472862,542722,597399,336831,57023,129504,40854,119130,1119651,208724,86050,390278,1114822,901104,150160,52699,256252,530452,1066788,1006847,15274,526481,670042,360913,411766,832960,313393,91260,806121,391907,1183444,952171,291329,1037258,144598,175837,1147587,346315,769849,547432,458228,343273,383554,15200,578524,351470,333907,300113,493832,625161,175846,88889,28874,287425,480060,596615,175833,1085639,620520,185539,444255,796083,683931,1003357,1077370,753184,43992,794096,1061368,932977,157939,717972,1040684,487496,742171,811244,658462,733603,1105619,945882,1136228,547389,990368,1194335,691667,1002689,316702,1018341,706864,336671,1173346,314975,630074,784374,256879,656153,916550,944243,912736,582794,586505,550874,1048918,1010868,1186370,740055,388939,745106,738511,438631,1157108,434079,148982,978309,139157,974821,34146,465381,898332,351112,779966,280800,913651,376427,1060884,625755,988557,703241,537077,633197,28954,328304,986365,302005,1041292,318944,995846,968370,766313,897126,843086,186144,229242,356851,1001865,734305,1194764,147104,647667,84697,1001825,114825,342571,294409,813978,1067085,814162,322450,181542,842928,135360,876651,40145,1119657,301646,273783,68662,670547,993362,837254,920116,1059159,268462,329924,915604,670513,466804,172794,745805,781195,145027,829355,792565,114310,753333,1153474,464128,662417,882557,452211,608312,417041,1057377,226491,883030,589076,831278,622041,977727,710371,735935,80792,429140,335873,795530,506187,274086,1166980,1165456,326807,565865,786821,1013057,343064,741014,864000,599392,52316,315136,727319,829872,412777,915264,197257,1010690,825846,362327,744926,347013,797046,22859,583438,975485,732866,474429,849231,705360,1005843,41379,1061319,174114,821268,149620,76286,133416,721948,316784,1090194,477026,334216,293272,1176474,835071,658263,47852,669866,31363,495976,283021,565929,579908,220020,107376,1193765,250644,1139269,918197,93550,328921,957196,238239,715994,359423,99675,538397,708660,595460,259563,290426,231388,45685,655805,319398,838458,397168,1191043,27865,236095,1058134,1167421,806737,347251,888709,1079836,605534,525071,398830,572655,512423,1004538,198221,365105,636896,1005560,450882,393466,167976,410461,989802,815260,554042,990413,693169,302543,986731,1177923,512195,1067745,252853,605703,746212,1093999,699092,977888,807616,781433,236690,688251,814661,861977,419297,53619,127320,961595,74935,775937,183889,50406,686991,470337,974720,866121,1099132,1120517,441575,25677,1094888,90063,239397,678725,649462,327999,1055154,543239,217611,1137785,699028,1184801,402572,1017121,982020,103526,274784,1194177,640883,452017,1198077,1136133,274205,613771,1094904,337855,340658,619803,1062170,174660,890603,460189,761255,439145,730859,542126,951795,458622,454746,331184,61847,557770,19980,325362,950689,103134,194285,510404,886391,1123400,761599,974349,1110849,473384,240369,157036,1110183,941771,967464,1112063,105306,285781,179133,675256,838704,612727,501529,20500,1190116,48388,584331,428404,918251,929848,820437,458814,1032088,348235,552864,717942,576074,746912,1152170,636457,197172,892376,362777,525590,50016,637466,248502,314302,990052,1092767,788404,369277,552286,153023,62983,179787,21025,934224,300932,1196875,491974,604259,1146523,641281,625438,871502,569009,356628,1142507,745701,368628,85871,14267,506125,511973,25793,495218,524685,411253,76615,436315,33565,1052082,890415,1142876,469999,532438,673864,846258,189587,835419,57334,153637,1185434,621195,1054616,597800,556713,423355,599653,500180,693995,1113995,74165,831757,851828,190345,593755,212010,656930,969139,695006,1196299,1156110,553106,871553,160765,155237,804933,1162647,1152821,1133846,797866,741389,681220,950935,318693,702852,503039,642331,113654,178509,596016,483768,514523,1179051,10316,419119,891176,947673,119501,874923,834472,966198,674817,30316,1054221,470840,378114,829671,894133,17573,188664,917890,131365,108217,1039441,406451,1187144,746183,644876,1189477,934924,359103,1134240,909339,689019,727867,930181,1185284,694307,1153615,251633,880859,513067,195437,380213,988697,475259,524550,716670,45906,484189,1044145,174358,1005853,196249,974847,436808,480170,1102104,422722,381030,462685,1078215,660808,1123675,228200,992531,1146448,677837,75897,99378,731082,401484,940399,86677,515979,964584,838500,1047622,109012,172715,720413,505859,1184755,888251,1175276,252860,714112,1164914,319420,1179172,686162,810505,1194379,175014,382596,753707,955207,584702,183676,345918,611915,1104976,572389,1185205,668915,878279,93280,939755,895778,333987,340992,1000137,330551,1041305,520275,404200,1070256,802118,697658,334988,268426,970473,987287,204047,736292,817327,217484,369017,119909,5133,421425,661768,416142,313455,1051454,749227,1062145,985566,1106783,1001535,415919,454097,1062850,1121172,1000912,352166,330130,511683,326887,606744,95045,718447,10442,1172400,41245,184142,374374,416179,886474,12659,762730,518931,1155130,950899,959242,774535,36573,911819,758187,848269,183838,458650,888382,807911,557774,81928,51157,336918,206311,1054511,169746,266588,61230,586939,83746,650660,910210,999305,624258,568057,1188057,508842,657317,972203,223934,819444,655276,513342,860119,398395,1024296,679712,360078,659012,864886,1141983,1017080,347053,218445,875052,436133,809174,948559,662092,641606,866389,457324,719997,53672,948131,24061,29516,645431,200114,928052,561648,174516,1056637,746921,93472,319016,912829,825004,501164,358150,752101,44705,1053598,407087,254147,278504,99848,821486,1129624,108126,828205,953730,473942,495548,843071,1151920,358950,1160891,315431,503660,675110,973764,437521,739672,447823,941973,501595,1042642,859017,104855,489630,245161,89718,886787,67766,1171167,115070,542643,572007,61495,1096751,188400,423565,257680,1080430,220164,1139423,907033,918427,61317,736227,1008753,779552,1057668,1138965,1002473,565753,250358,304230,755518,248220,739292,553168,633666,103871,825475,607055,119178,664946,512507,1107365,430321,654805,407451,1099091,485550,556494,625945,336844,258354,735939,142740,154935,920183,898707,168332,1131509,547177,103286,152147,873343,326632,251802,1102000,10155,321874,845678,791775,1058471,396135,768025,1053088,895284,1069976,60001,722712,168042,234522,658703,871727,459341,807170,1062717,259482,234060,692195,793258,64072,271996,1147337,68808,535487,1168568,599111,492793,109221,1013336,1069694,484991,285828,907022,748070,1114901,926496,425496,211052,197356,147741,928238,1046068,3834,671189,153287,557308,53472,246893,555420,766041,278905,319730,1187818,401692,567452,204989,948074,339383,43174,106540,227443,51601,24660,919662,18466,839664,1103275,586784,79423,792895,432696,295919,237728,1188704,944283,334135,236906,439200,384563,66530,450,978745,901084,1038501,225643,928945,14567,359901,313975,718127,1045007,345261,21604,316549};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* bit reverse step of dimension 1024 */
static void bit_reverse_1024(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[512];a[512]=t;
t=a[2];a[2]=a[256];a[256]=t;
t=a[3];a[3]=a[768];a[768]=t;
t=a[4];a[4]=a[128];a[128]=t;
t=a[5];a[5]=a[640];a[640]=t;
t=a[6];a[6]=a[384];a[384]=t;
t=a[7];a[7]=a[896];a[896]=t;
t=a[8];a[8]=a[64];a[64]=t;
t=a[9];a[9]=a[576];a[576]=t;
t=a[10];a[10]=a[320];a[320]=t;
t=a[11];a[11]=a[832];a[832]=t;
t=a[12];a[12]=a[192];a[192]=t;
t=a[13];a[13]=a[704];a[704]=t;
t=a[14];a[14]=a[448];a[448]=t;
t=a[15];a[15]=a[960];a[960]=t;
t=a[16];a[16]=a[32];a[32]=t;
t=a[17];a[17]=a[544];a[544]=t;
t=a[18];a[18]=a[288];a[288]=t;
t=a[19];a[19]=a[800];a[800]=t;
t=a[20];a[20]=a[160];a[160]=t;
t=a[21];a[21]=a[672];a[672]=t;
t=a[22];a[22]=a[416];a[416]=t;
t=a[23];a[23]=a[928];a[928]=t;
t=a[24];a[24]=a[96];a[96]=t;
t=a[25];a[25]=a[608];a[608]=t;
t=a[26];a[26]=a[352];a[352]=t;
t=a[27];a[27]=a[864];a[864]=t;
t=a[28];a[28]=a[224];a[224]=t;
t=a[29];a[29]=a[736];a[736]=t;
t=a[30];a[30]=a[480];a[480]=t;
t=a[31];a[31]=a[992];a[992]=t;
t=a[33];a[33]=a[528];a[528]=t;
t=a[34];a[34]=a[272];a[272]=t;
t=a[35];a[35]=a[784];a[784]=t;
t=a[36];a[36]=a[144];a[144]=t;
t=a[37];a[37]=a[656];a[656]=t;
t=a[38];a[38]=a[400];a[400]=t;
t=a[39];a[39]=a[912];a[912]=t;
t=a[40];a[40]=a[80];a[80]=t;
t=a[41];a[41]=a[592];a[592]=t;
t=a[42];a[42]=a[336];a[336]=t;
t=a[43];a[43]=a[848];a[848]=t;
t=a[44];a[44]=a[208];a[208]=t;
t=a[45];a[45]=a[720];a[720]=t;
t=a[46];a[46]=a[464];a[464]=t;
t=a[47];a[47]=a[976];a[976]=t;
t=a[49];a[49]=a[560];a[560]=t;
t=a[50];a[50]=a[304];a[304]=t;
t=a[51];a[51]=a[816];a[816]=t;
t=a[52];a[52]=a[176];a[176]=t;
t=a[53];a[53]=a[688];a[688]=t;
t=a[54];a[54]=a[432];a[432]=t;
t=a[55];a[55]=a[944];a[944]=t;
t=a[56];a[56]=a[112];a[112]=t;
t=a[57];a[57]=a[624];a[624]=t;
t=a[58];a[58]=a[368];a[368]=t;
t=a[59];a[59]=a[880];a[880]=t;
t=a[60];a[60]=a[240];a[240]=t;
t=a[61];a[61]=a[752];a[752]=t;
t=a[62];a[62]=a[496];a[496]=t;
t=a[63];a[63]=a[1008];a[1008]=t;
t=a[65];a[65]=a[520];a[520]=t;
t=a[66];a[66]=a[264];a[264]=t;
t=a[67];a[67]=a[776];a[776]=t;
t=a[68];a[68]=a[136];a[136]=t;
t=a[69];a[69]=a[648];a[648]=t;
t=a[70];a[70]=a[392];a[392]=t;
t=a[71];a[71]=a[904];a[904]=t;
t=a[73];a[73]=a[584];a[584]=t;
t=a[74];a[74]=a[328];a[328]=t;
t=a[75];a[75]=a[840];a[840]=t;
t=a[76];a[76]=a[200];a[200]=t;
t=a[77];a[77]=a[712];a[712]=t;
t=a[78];a[78]=a[456];a[456]=t;
t=a[79];a[79]=a[968];a[968]=t;
t=a[81];a[81]=a[552];a[552]=t;
t=a[82];a[82]=a[296];a[296]=t;
t=a[83];a[83]=a[808];a[808]=t;
t=a[84];a[84]=a[168];a[168]=t;
t=a[85];a[85]=a[680];a[680]=t;
t=a[86];a[86]=a[424];a[424]=t;
t=a[87];a[87]=a[936];a[936]=t;
t=a[88];a[88]=a[104];a[104]=t;
t=a[89];a[89]=a[616];a[616]=t;
t=a[90];a[90]=a[360];a[360]=t;
t=a[91];a[91]=a[872];a[872]=t;
t=a[92];a[92]=a[232];a[232]=t;
t=a[93];a[93]=a[744];a[744]=t;
t=a[94];a[94]=a[488];a[488]=t;
t=a[95];a[95]=a[1000];a[1000]=t;
t=a[97];a[97]=a[536];a[536]=t;
t=a[98];a[98]=a[280];a[280]=t;
t=a[99];a[99]=a[792];a[792]=t;
t=a[100];a[100]=a[152];a[152]=t;
t=a[101];a[101]=a[664];a[664]=t;
t=a[102];a[102]=a[408];a[408]=t;
t=a[103];a[103]=a[920];a[920]=t;
t=a[105];a[105]=a[600];a[600]=t;
t=a[106];a[106]=a[344];a[344]=t;
t=a[107];a[107]=a[856];a[856]=t;
t=a[108];a[108]=a[216];a[216]=t;
t=a[109];a[109]=a[728];a[728]=t;
t=a[110];a[110]=a[472];a[472]=t;
t=a[111];a[111]=a[984];a[984]=t;
t=a[113];a[113]=a[568];a[568]=t;
t=a[114];a[114]=a[312];a[312]=t;
t=a[115];a[115]=a[824];a[824]=t;
t=a[116];a[116]=a[184];a[184]=t;
t=a[117];a[117]=a[696];a[696]=t;
t=a[118];a[118]=a[440];a[440]=t;
t=a[119];a[119]=a[952];a[952]=t;
t=a[121];a[121]=a[632];a[632]=t;
t=a[122];a[122]=a[376];a[376]=t;
t=a[123];a[123]=a[888];a[888]=t;
t=a[124];a[124]=a[248];a[248]=t;
t=a[125];a[125]=a[760];a[760]=t;
t=a[126];a[126]=a[504];a[504]=t;
t=a[127];a[127]=a[1016];a[1016]=t;
t=a[129];a[129]=a[516];a[516]=t;
t=a[130];a[130]=a[260];a[260]=t;
t=a[131];a[131]=a[772];a[772]=t;
t=a[133];a[133]=a[644];a[644]=t;
t=a[134];a[134]=a[388];a[388]=t;
t=a[135];a[135]=a[900];a[900]=t;
t=a[137];a[137]=a[580];a[580]=t;
t=a[138];a[138]=a[324];a[324]=t;
t=a[139];a[139]=a[836];a[836]=t;
t=a[140];a[140]=a[196];a[196]=t;
t=a[141];a[141]=a[708];a[708]=t;
t=a[142];a[142]=a[452];a[452]=t;
t=a[143];a[143]=a[964];a[964]=t;
t=a[145];a[145]=a[548];a[548]=t;
t=a[146];a[146]=a[292];a[292]=t;
t=a[147];a[147]=a[804];a[804]=t;
t=a[148];a[148]=a[164];a[164]=t;
t=a[149];a[149]=a[676];a[676]=t;
t=a[150];a[150]=a[420];a[420]=t;
t=a[151];a[151]=a[932];a[932]=t;
t=a[153];a[153]=a[612];a[612]=t;
t=a[154];a[154]=a[356];a[356]=t;
t=a[155];a[155]=a[868];a[868]=t;
t=a[156];a[156]=a[228];a[228]=t;
t=a[157];a[157]=a[740];a[740]=t;
t=a[158];a[158]=a[484];a[484]=t;
t=a[159];a[159]=a[996];a[996]=t;
t=a[161];a[161]=a[532];a[532]=t;
t=a[162];a[162]=a[276];a[276]=t;
t=a[163];a[163]=a[788];a[788]=t;
t=a[165];a[165]=a[660];a[660]=t;
t=a[166];a[166]=a[404];a[404]=t;
t=a[167];a[167]=a[916];a[916]=t;
t=a[169];a[169]=a[596];a[596]=t;
t=a[170];a[170]=a[340];a[340]=t;
t=a[171];a[171]=a[852];a[852]=t;
t=a[172];a[172]=a[212];a[212]=t;
t=a[173];a[173]=a[724];a[724]=t;
t=a[174];a[174]=a[468];a[468]=t;
t=a[175];a[175]=a[980];a[980]=t;
t=a[177];a[177]=a[564];a[564]=t;
t=a[178];a[178]=a[308];a[308]=t;
t=a[179];a[179]=a[820];a[820]=t;
t=a[181];a[181]=a[692];a[692]=t;
t=a[182];a[182]=a[436];a[436]=t;
t=a[183];a[183]=a[948];a[948]=t;
t=a[185];a[185]=a[628];a[628]=t;
t=a[186];a[186]=a[372];a[372]=t;
t=a[187];a[187]=a[884];a[884]=t;
t=a[188];a[188]=a[244];a[244]=t;
t=a[189];a[189]=a[756];a[756]=t;
t=a[190];a[190]=a[500];a[500]=t;
t=a[191];a[191]=a[1012];a[1012]=t;
t=a[193];a[193]=a[524];a[524]=t;
t=a[194];a[194]=a[268];a[268]=t;
t=a[195];a[195]=a[780];a[780]=t;
t=a[197];a[197]=a[652];a[652]=t;
t=a[198];a[198]=a[396];a[396]=t;
t=a[199];a[199]=a[908];a[908]=t;
t=a[201];a[201]=a[588];a[588]=t;
t=a[202];a[202]=a[332];a[332]=t;
t=a[203];a[203]=a[844];a[844]=t;
t=a[205];a[205]=a[716];a[716]=t;
t=a[206];a[206]=a[460];a[460]=t;
t=a[207];a[207]=a[972];a[972]=t;
t=a[209];a[209]=a[556];a[556]=t;
t=a[210];a[210]=a[300];a[300]=t;
t=a[211];a[211]=a[812];a[812]=t;
t=a[213];a[213]=a[684];a[684]=t;
t=a[214];a[214]=a[428];a[428]=t;
t=a[215];a[215]=a[940];a[940]=t;
t=a[217];a[217]=a[620];a[620]=t;
t=a[218];a[218]=a[364];a[364]=t;
t=a[219];a[219]=a[876];a[876]=t;
t=a[220];a[220]=a[236];a[236]=t;
t=a[221];a[221]=a[748];a[748]=t;
t=a[222];a[222]=a[492];a[492]=t;
t=a[223];a[223]=a[1004];a[1004]=t;
t=a[225];a[225]=a[540];a[540]=t;
t=a[226];a[226]=a[284];a[284]=t;
t=a[227];a[227]=a[796];a[796]=t;
t=a[229];a[229]=a[668];a[668]=t;
t=a[230];a[230]=a[412];a[412]=t;
t=a[231];a[231]=a[924];a[924]=t;
t=a[233];a[233]=a[604];a[604]=t;
t=a[234];a[234]=a[348];a[348]=t;
t=a[235];a[235]=a[860];a[860]=t;
t=a[237];a[237]=a[732];a[732]=t;
t=a[238];a[238]=a[476];a[476]=t;
t=a[239];a[239]=a[988];a[988]=t;
t=a[241];a[241]=a[572];a[572]=t;
t=a[242];a[242]=a[316];a[316]=t;
t=a[243];a[243]=a[828];a[828]=t;
t=a[245];a[245]=a[700];a[700]=t;
t=a[246];a[246]=a[444];a[444]=t;
t=a[247];a[247]=a[956];a[956]=t;
t=a[249];a[249]=a[636];a[636]=t;
t=a[250];a[250]=a[380];a[380]=t;
t=a[251];a[251]=a[892];a[892]=t;
t=a[253];a[253]=a[764];a[764]=t;
t=a[254];a[254]=a[508];a[508]=t;
t=a[255];a[255]=a[1020];a[1020]=t;
t=a[257];a[257]=a[514];a[514]=t;
t=a[259];a[259]=a[770];a[770]=t;
t=a[261];a[261]=a[642];a[642]=t;
t=a[262];a[262]=a[386];a[386]=t;
t=a[263];a[263]=a[898];a[898]=t;
t=a[265];a[265]=a[578];a[578]=t;
t=a[266];a[266]=a[322];a[322]=t;
t=a[267];a[267]=a[834];a[834]=t;
t=a[269];a[269]=a[706];a[706]=t;
t=a[270];a[270]=a[450];a[450]=t;
t=a[271];a[271]=a[962];a[962]=t;
t=a[273];a[273]=a[546];a[546]=t;
t=a[274];a[274]=a[290];a[290]=t;
t=a[275];a[275]=a[802];a[802]=t;
t=a[277];a[277]=a[674];a[674]=t;
t=a[278];a[278]=a[418];a[418]=t;
t=a[279];a[279]=a[930];a[930]=t;
t=a[281];a[281]=a[610];a[610]=t;
t=a[282];a[282]=a[354];a[354]=t;
t=a[283];a[283]=a[866];a[866]=t;
t=a[285];a[285]=a[738];a[738]=t;
t=a[286];a[286]=a[482];a[482]=t;
t=a[287];a[287]=a[994];a[994]=t;
t=a[289];a[289]=a[530];a[530]=t;
t=a[291];a[291]=a[786];a[786]=t;
t=a[293];a[293]=a[658];a[658]=t;
t=a[294];a[294]=a[402];a[402]=t;
t=a[295];a[295]=a[914];a[914]=t;
t=a[297];a[297]=a[594];a[594]=t;
t=a[298];a[298]=a[338];a[338]=t;
t=a[299];a[299]=a[850];a[850]=t;
t=a[301];a[301]=a[722];a[722]=t;
t=a[302];a[302]=a[466];a[466]=t;
t=a[303];a[303]=a[978];a[978]=t;
t=a[305];a[305]=a[562];a[562]=t;
t=a[307];a[307]=a[818];a[818]=t;
t=a[309];a[309]=a[690];a[690]=t;
t=a[310];a[310]=a[434];a[434]=t;
t=a[311];a[311]=a[946];a[946]=t;
t=a[313];a[313]=a[626];a[626]=t;
t=a[314];a[314]=a[370];a[370]=t;
t=a[315];a[315]=a[882];a[882]=t;
t=a[317];a[317]=a[754];a[754]=t;
t=a[318];a[318]=a[498];a[498]=t;
t=a[319];a[319]=a[1010];a[1010]=t;
t=a[321];a[321]=a[522];a[522]=t;
t=a[323];a[323]=a[778];a[778]=t;
t=a[325];a[325]=a[650];a[650]=t;
t=a[326];a[326]=a[394];a[394]=t;
t=a[327];a[327]=a[906];a[906]=t;
t=a[329];a[329]=a[586];a[586]=t;
t=a[331];a[331]=a[842];a[842]=t;
t=a[333];a[333]=a[714];a[714]=t;
t=a[334];a[334]=a[458];a[458]=t;
t=a[335];a[335]=a[970];a[970]=t;
t=a[337];a[337]=a[554];a[554]=t;
t=a[339];a[339]=a[810];a[810]=t;
t=a[341];a[341]=a[682];a[682]=t;
t=a[342];a[342]=a[426];a[426]=t;
t=a[343];a[343]=a[938];a[938]=t;
t=a[345];a[345]=a[618];a[618]=t;
t=a[346];a[346]=a[362];a[362]=t;
t=a[347];a[347]=a[874];a[874]=t;
t=a[349];a[349]=a[746];a[746]=t;
t=a[350];a[350]=a[490];a[490]=t;
t=a[351];a[351]=a[1002];a[1002]=t;
t=a[353];a[353]=a[538];a[538]=t;
t=a[355];a[355]=a[794];a[794]=t;
t=a[357];a[357]=a[666];a[666]=t;
t=a[358];a[358]=a[410];a[410]=t;
t=a[359];a[359]=a[922];a[922]=t;
t=a[361];a[361]=a[602];a[602]=t;
t=a[363];a[363]=a[858];a[858]=t;
t=a[365];a[365]=a[730];a[730]=t;
t=a[366];a[366]=a[474];a[474]=t;
t=a[367];a[367]=a[986];a[986]=t;
t=a[369];a[369]=a[570];a[570]=t;
t=a[371];a[371]=a[826];a[826]=t;
t=a[373];a[373]=a[698];a[698]=t;
t=a[374];a[374]=a[442];a[442]=t;
t=a[375];a[375]=a[954];a[954]=t;
t=a[377];a[377]=a[634];a[634]=t;
t=a[379];a[379]=a[890];a[890]=t;
t=a[381];a[381]=a[762];a[762]=t;
t=a[382];a[382]=a[506];a[506]=t;
t=a[383];a[383]=a[1018];a[1018]=t;
t=a[385];a[385]=a[518];a[518]=t;
t=a[387];a[387]=a[774];a[774]=t;
t=a[389];a[389]=a[646];a[646]=t;
t=a[391];a[391]=a[902];a[902]=t;
t=a[393];a[393]=a[582];a[582]=t;
t=a[395];a[395]=a[838];a[838]=t;
t=a[397];a[397]=a[710];a[710]=t;
t=a[398];a[398]=a[454];a[454]=t;
t=a[399];a[399]=a[966];a[966]=t;
t=a[401];a[401]=a[550];a[550]=t;
t=a[403];a[403]=a[806];a[806]=t;
t=a[405];a[405]=a[678];a[678]=t;
t=a[406];a[406]=a[422];a[422]=t;
t=a[407];a[407]=a[934];a[934]=t;
t=a[409];a[409]=a[614];a[614]=t;
t=a[411];a[411]=a[870];a[870]=t;
t=a[413];a[413]=a[742];a[742]=t;
t=a[414];a[414]=a[486];a[486]=t;
t=a[415];a[415]=a[998];a[998]=t;
t=a[417];a[417]=a[534];a[534]=t;
t=a[419];a[419]=a[790];a[790]=t;
t=a[421];a[421]=a[662];a[662]=t;
t=a[423];a[423]=a[918];a[918]=t;
t=a[425];a[425]=a[598];a[598]=t;
t=a[427];a[427]=a[854];a[854]=t;
t=a[429];a[429]=a[726];a[726]=t;
t=a[430];a[430]=a[470];a[470]=t;
t=a[431];a[431]=a[982];a[982]=t;
t=a[433];a[433]=a[566];a[566]=t;
t=a[435];a[435]=a[822];a[822]=t;
t=a[437];a[437]=a[694];a[694]=t;
t=a[439];a[439]=a[950];a[950]=t;
t=a[441];a[441]=a[630];a[630]=t;
t=a[443];a[443]=a[886];a[886]=t;
t=a[445];a[445]=a[758];a[758]=t;
t=a[446];a[446]=a[502];a[502]=t;
t=a[447];a[447]=a[1014];a[1014]=t;
t=a[449];a[449]=a[526];a[526]=t;
t=a[451];a[451]=a[782];a[782]=t;
t=a[453];a[453]=a[654];a[654]=t;
t=a[455];a[455]=a[910];a[910]=t;
t=a[457];a[457]=a[590];a[590]=t;
t=a[459];a[459]=a[846];a[846]=t;
t=a[461];a[461]=a[718];a[718]=t;
t=a[463];a[463]=a[974];a[974]=t;
t=a[465];a[465]=a[558];a[558]=t;
t=a[467];a[467]=a[814];a[814]=t;
t=a[469];a[469]=a[686];a[686]=t;
t=a[471];a[471]=a[942];a[942]=t;
t=a[473];a[473]=a[622];a[622]=t;
t=a[475];a[475]=a[878];a[878]=t;
t=a[477];a[477]=a[750];a[750]=t;
t=a[478];a[478]=a[494];a[494]=t;
t=a[479];a[479]=a[1006];a[1006]=t;
t=a[481];a[481]=a[542];a[542]=t;
t=a[483];a[483]=a[798];a[798]=t;
t=a[485];a[485]=a[670];a[670]=t;
t=a[487];a[487]=a[926];a[926]=t;
t=a[489];a[489]=a[606];a[606]=t;
t=a[491];a[491]=a[862];a[862]=t;
t=a[493];a[493]=a[734];a[734]=t;
t=a[495];a[495]=a[990];a[990]=t;
t=a[497];a[497]=a[574];a[574]=t;
t=a[499];a[499]=a[830];a[830]=t;
t=a[501];a[501]=a[702];a[702]=t;
t=a[503];a[503]=a[958];a[958]=t;
t=a[505];a[505]=a[638];a[638]=t;
t=a[507];a[507]=a[894];a[894]=t;
t=a[509];a[509]=a[766];a[766]=t;
t=a[511];a[511]=a[1022];a[1022]=t;
t=a[515];a[515]=a[769];a[769]=t;
t=a[517];a[517]=a[641];a[641]=t;
t=a[519];a[519]=a[897];a[897]=t;
t=a[521];a[521]=a[577];a[577]=t;
t=a[523];a[523]=a[833];a[833]=t;
t=a[525];a[525]=a[705];a[705]=t;
t=a[527];a[527]=a[961];a[961]=t;
t=a[529];a[529]=a[545];a[545]=t;
t=a[531];a[531]=a[801];a[801]=t;
t=a[533];a[533]=a[673];a[673]=t;
t=a[535];a[535]=a[929];a[929]=t;
t=a[537];a[537]=a[609];a[609]=t;
t=a[539];a[539]=a[865];a[865]=t;
t=a[541];a[541]=a[737];a[737]=t;
t=a[543];a[543]=a[993];a[993]=t;
t=a[547];a[547]=a[785];a[785]=t;
t=a[549];a[549]=a[657];a[657]=t;
t=a[551];a[551]=a[913];a[913]=t;
t=a[553];a[553]=a[593];a[593]=t;
t=a[555];a[555]=a[849];a[849]=t;
t=a[557];a[557]=a[721];a[721]=t;
t=a[559];a[559]=a[977];a[977]=t;
t=a[563];a[563]=a[817];a[817]=t;
t=a[565];a[565]=a[689];a[689]=t;
t=a[567];a[567]=a[945];a[945]=t;
t=a[569];a[569]=a[625];a[625]=t;
t=a[571];a[571]=a[881];a[881]=t;
t=a[573];a[573]=a[753];a[753]=t;
t=a[575];a[575]=a[1009];a[1009]=t;
t=a[579];a[579]=a[777];a[777]=t;
t=a[581];a[581]=a[649];a[649]=t;
t=a[583];a[583]=a[905];a[905]=t;
t=a[587];a[587]=a[841];a[841]=t;
t=a[589];a[589]=a[713];a[713]=t;
t=a[591];a[591]=a[969];a[969]=t;
t=a[595];a[595]=a[809];a[809]=t;
t=a[597];a[597]=a[681];a[681]=t;
t=a[599];a[599]=a[937];a[937]=t;
t=a[601];a[601]=a[617];a[617]=t;
t=a[603];a[603]=a[873];a[873]=t;
t=a[605];a[605]=a[745];a[745]=t;
t=a[607];a[607]=a[1001];a[1001]=t;
t=a[611];a[611]=a[793];a[793]=t;
t=a[613];a[613]=a[665];a[665]=t;
t=a[615];a[615]=a[921];a[921]=t;
t=a[619];a[619]=a[857];a[857]=t;
t=a[621];a[621]=a[729];a[729]=t;
t=a[623];a[623]=a[985];a[985]=t;
t=a[627];a[627]=a[825];a[825]=t;
t=a[629];a[629]=a[697];a[697]=t;
t=a[631];a[631]=a[953];a[953]=t;
t=a[635];a[635]=a[889];a[889]=t;
t=a[637];a[637]=a[761];a[761]=t;
t=a[639];a[639]=a[1017];a[1017]=t;
t=a[643];a[643]=a[773];a[773]=t;
t=a[647];a[647]=a[901];a[901]=t;
t=a[651];a[651]=a[837];a[837]=t;
t=a[653];a[653]=a[709];a[709]=t;
t=a[655];a[655]=a[965];a[965]=t;
t=a[659];a[659]=a[805];a[805]=t;
t=a[661];a[661]=a[677];a[677]=t;
t=a[663];a[663]=a[933];a[933]=t;
t=a[667];a[667]=a[869];a[869]=t;
t=a[669];a[669]=a[741];a[741]=t;
t=a[671];a[671]=a[997];a[997]=t;
t=a[675];a[675]=a[789];a[789]=t;
t=a[679];a[679]=a[917];a[917]=t;
t=a[683];a[683]=a[853];a[853]=t;
t=a[685];a[685]=a[725];a[725]=t;
t=a[687];a[687]=a[981];a[981]=t;
t=a[691];a[691]=a[821];a[821]=t;
t=a[695];a[695]=a[949];a[949]=t;
t=a[699];a[699]=a[885];a[885]=t;
t=a[701];a[701]=a[757];a[757]=t;
t=a[703];a[703]=a[1013];a[1013]=t;
t=a[707];a[707]=a[781];a[781]=t;
t=a[711];a[711]=a[909];a[909]=t;
t=a[715];a[715]=a[845];a[845]=t;
t=a[719];a[719]=a[973];a[973]=t;
t=a[723];a[723]=a[813];a[813]=t;
t=a[727];a[727]=a[941];a[941]=t;
t=a[731];a[731]=a[877];a[877]=t;
t=a[733];a[733]=a[749];a[749]=t;
t=a[735];a[735]=a[1005];a[1005]=t;
t=a[739];a[739]=a[797];a[797]=t;
t=a[743];a[743]=a[925];a[925]=t;
t=a[747];a[747]=a[861];a[861]=t;
t=a[751];a[751]=a[989];a[989]=t;
t=a[755];a[755]=a[829];a[829]=t;
t=a[759];a[759]=a[957];a[957]=t;
t=a[763];a[763]=a[893];a[893]=t;
t=a[767];a[767]=a[1021];a[1021]=t;
t=a[775];a[775]=a[899];a[899]=t;
t=a[779];a[779]=a[835];a[835]=t;
t=a[783];a[783]=a[963];a[963]=t;
t=a[787];a[787]=a[803];a[803]=t;
t=a[791];a[791]=a[931];a[931]=t;
t=a[795];a[795]=a[867];a[867]=t;
t=a[799];a[799]=a[995];a[995]=t;
t=a[807];a[807]=a[915];a[915]=t;
t=a[811];a[811]=a[851];a[851]=t;
t=a[815];a[815]=a[979];a[979]=t;
t=a[823];a[823]=a[947];a[947]=t;
t=a[827];a[827]=a[883];a[883]=t;
t=a[831];a[831]=a[1011];a[1011]=t;
t=a[839];a[839]=a[907];a[907]=t;
t=a[847];a[847]=a[971];a[971]=t;
t=a[855];a[855]=a[939];a[939]=t;
t=a[859];a[859]=a[875];a[875]=t;
t=a[863];a[863]=a[1003];a[1003]=t;
t=a[871];a[871]=a[923];a[923]=t;
t=a[879];a[879]=a[987];a[987]=t;
t=a[887];a[887]=a[955];a[955]=t;
t=a[895];a[895]=a[1019];a[1019]=t;
t=a[911];a[911]=a[967];a[967]=t;
t=a[919];a[919]=a[935];a[935]=t;
t=a[927];a[927]=a[999];a[999]=t;
t=a[943];a[943]=a[983];a[983]=t;
t=a[959];a[959]=a[1015];a[1015]=t;
t=a[991];a[991]=a[1007];a[1007]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 2;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v, x, y, t;
	
	uint32_t q_level = Q << 2, q_level1;
	
	/* first iteration */
	u = a[0];
	v = a[d];
	
	a[0] = u + v;
	a[d] = Q2 + u - v;

	for (j = 1; j < d; j++)
	{
		/* Gentleman-Sande's butterfly
		 * (u, v) <-- (u + v, (u - v) * omega) % Q */
		u = a[j];
		v = a[j + d];
		
		a[j] = u + v;
		a[j + d] = montgomery((Q2 + u - v) * omega[j]);
	} 
	
	d >>= 1;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = u + v;
			a[j1 + d] = q_level + u - v;

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = u + v;
				a[j + d] = montgomery((q_level + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
		
		q_level <<= 1;
	}
	
	/* merged last 2 levels (save some overhead of iterations) */
	q_level1 = q_level << 1;
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 1];
		x = a[j + 2];
		y = a[j + 3];
		t = montgomery((q_level + v - y) * omega[num_of_problems]);
		
		a[j] = barrett_short(u + v + x + y);
		a[j + 1] = barrett_short(q_level1 + u + x - v - y);
		a[j + 2] = barrett_short(q_level + u + t - x);
		a[j + 3] = barrett_short(q_level1 + u - x - t);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), void (*bit_reverse)(uint32_t *))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n, void (*bit_reverse)(uint32_t *))
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = montgomery((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 8 --> 256 * 13 */
static void ntt_butterfly_2048_3328(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i;
	
	b = a[n2];
	c = a[N2_3328 + n2];
	d = a[N2_3328 * 2 + n2];
	e = a[N2_3328 * 3 + n2];
	f = a[N2_3328 * 4 + n2];
	g = a[N2_3328 * 5 + n2];
	h = a[N2_3328 * 6 + n2];
	i = a[N2_3328 * 7 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i);
	a[N2_3328 + n2] = b + montgomery(c * w_13[0][0] + d * w_13[0][1] + e * w_13[0][2] + f * w_13[0][3] + g * w_13[0][4] + h * w_13[0][5] + i * w_13[0][6]);
	a[N2_3328 * 2 + n2] = b + montgomery(c * w_13[1][0] + d * w_13[1][1] + e * w_13[1][2] + f * w_13[1][3] + g * w_13[1][4] + h * w_13[1][5] + i * w_13[1][6]);
	a[N2_3328 * 3 + n2] = b + montgomery(c * w_13[2][0] + d * w_13[2][1] + e * w_13[2][2] + f * w_13[2][3] + g * w_13[2][4] + h * w_13[2][5] + i * w_13[2][6]);
	a[N2_3328 * 4 + n2] = b + montgomery(c * w_13[3][0] + d * w_13[3][1] + e * w_13[3][2] + f * w_13[3][3] + g * w_13[3][4] + h * w_13[3][5] + i * w_13[3][6]);
	a[N2_3328 * 5 + n2] = b + montgomery(c * w_13[4][0] + d * w_13[4][1] + e * w_13[4][2] + f * w_13[4][3] + g * w_13[4][4] + h * w_13[4][5] + i * w_13[4][6]);
	a[N2_3328 * 6 + n2] = b + montgomery(c * w_13[5][0] + d * w_13[5][1] + e * w_13[5][2] + f * w_13[5][3] + g * w_13[5][4] + h * w_13[5][5] + i * w_13[5][6]);
	a[N2_3328 * 7 + n2] = b + montgomery(c * w_13[6][0] + d * w_13[6][1] + e * w_13[6][2] + f * w_13[6][3] + g * w_13[6][4] + h * w_13[6][5] + i * w_13[6][6]);
	a[N2_3328 * 8 + n2] = b + montgomery(c * w_13[7][0] + d * w_13[7][1] + e * w_13[7][2] + f * w_13[7][3] + g * w_13[7][4] + h * w_13[7][5] + i * w_13[7][6]);
	a[N2_3328 * 9 + n2] = b + montgomery(c * w_13[8][0] + d * w_13[8][1] + e * w_13[8][2] + f * w_13[8][3] + g * w_13[8][4] + h * w_13[8][5] + i * w_13[8][6]);
	a[N2_3328 * 10 + n2] = b + montgomery(c * w_13[9][0] + d * w_13[9][1] + e * w_13[9][2] + f * w_13[9][3] + g * w_13[9][4] + h * w_13[9][5] + i * w_13[9][6]);
	a[N2_3328 * 11 + n2] = b + montgomery(c * w_13[10][0] + d * w_13[10][1] + e * w_13[10][2] + f * w_13[10][3] + g * w_13[10][4] + h * w_13[10][5] + i * w_13[10][6]);
	a[N2_3328 * 12 + n2] = b + montgomery(c * w_13[11][0] + d * w_13[11][1] + e * w_13[11][2] + f * w_13[11][3] + g * w_13[11][4] + h * w_13[11][5] + i * w_13[11][6]);
}

/* 256 * 13 --> 256 * 5 */
static void ntt_butterfly_3328_1280(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k, l, m, n;
	
	b = a[n2];
	c = a[N2_3328 + n2];
	d = a[N2_3328 * 2 + n2];
	e = a[N2_3328 * 3 + n2];
	f = a[N2_3328 * 4 + n2];
	g = a[N2_3328 * 5 + n2];
	h = a[N2_3328 * 6 + n2];
	i = a[N2_3328 * 7 + n2];
	j = a[N2_3328 * 8 + n2];
	k = a[N2_3328 * 9 + n2];
	l = a[N2_3328 * 10 + n2];
	m = a[N2_3328 * 11 + n2];
	n = a[N2_3328 * 12 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j + k + l + m + n);
	a[N2_3328 + n2] = b + montgomery(c * w_13[0][0] + d * w_13[0][1] + e * w_13[0][2] + f * w_13[0][3] + g * w_13[0][4] + h * w_13[0][5] + i * w_13[0][6] + j * w_13[0][7] + k * w_13[0][8] + l * w_13[0][9] + m * w_13[0][10] + n * w_13[0][11]);
	a[N2_3328 * 2 + n2] = b + montgomery(c * w_13[1][0] + d * w_13[1][1] + e * w_13[1][2] + f * w_13[1][3] + g * w_13[1][4] + h * w_13[1][5] + i * w_13[1][6] + j * w_13[1][7] + k * w_13[1][8] + l * w_13[1][9] + m * w_13[1][10] + n * w_13[1][11]);
	a[N2_3328 * 3 + n2] = b + montgomery(c * w_13[2][0] + d * w_13[2][1] + e * w_13[2][2] + f * w_13[2][3] + g * w_13[2][4] + h * w_13[2][5] + i * w_13[2][6] + j * w_13[2][7] + k * w_13[2][8] + l * w_13[2][9] + m * w_13[2][10] + n * w_13[2][11]);
	a[N2_3328 * 4 + n2] = b + montgomery(c * w_13[3][0] + d * w_13[3][1] + e * w_13[3][2] + f * w_13[3][3] + g * w_13[3][4] + h * w_13[3][5] + i * w_13[3][6] + j * w_13[3][7] + k * w_13[3][8] + l * w_13[3][9] + m * w_13[3][10] + n * w_13[3][11]);
}

/* 1024 * 1 --> 1024 * 3 */
static void ntt_butterfly_1024_3072(uint32_t *a, uint32_t n2)
{
	a[N2_3072 + n2] = a[n2];
	a[N2_3072 * 2 + n2] = a[n2];
}

/* 1024 * 2 --> 1024 * 3 */
static void ntt_butterfly_2048_3072(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_3072 + n2];
	
	a[n2] = barrett_short(b + c);
	a[N2_3072 + n2] = b + montgomery(c * w_3[0]);
	a[N2_3072 * 2 + n2] = b + montgomery(c * w_3[1]);
}

/* 1024 * 3 --> 1024 * 3 */
static void ntt_butterfly_3072_3072_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_3072 + n2];
	d = a[N2_3072 * 2 + n2];
	
	a[n2] = barrett_short(b + c + d);
	a[N2_3072 + n2] = b + montgomery(c * w_3_inv[0] + d * w_3_inv[1]);
	a[N2_3072 * 2 + n2] = b + montgomery(c * w_3_inv[1] + d * w_3_inv[0]);
}

/* 256 * 5 --> 256 * 5 */
static void ntt_butterfly_1280_1280_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f;
	
	b = a[n2];
	c = a[N2_1280 + n2];
	d = a[N2_1280 * 2 + n2];
	e = a[N2_1280 * 3 + n2];
	f = a[N2_1280 * 4 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f);
	a[N2_1280 + n2] = b + montgomery(c * w_5_inv[0][0] + d * w_5_inv[0][1] + e * w_5_inv[0][2] + f * w_5_inv[0][3]);
	a[N2_1280 * 2 + n2] = b + montgomery(c * w_5_inv[1][0] + d * w_5_inv[1][1] + e * w_5_inv[1][2] + f * w_5_inv[1][3]);
	a[N2_1280 * 3 + n2] = b + montgomery(c * w_5_inv[2][0] + d * w_5_inv[2][1] + e * w_5_inv[2][2] + f * w_5_inv[2][3]);
	a[N2_1280 * 4 + n2] = b + montgomery(c * w_5_inv[3][0] + d * w_5_inv[3][1] + e * w_5_inv[3][2] + f * w_5_inv[3][3]);
}

/* 256 * 4 --> 256 * 5 */
static void ntt_butterfly_1024_1280(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1280 + n2];
	d = a[N2_1280 * 2 + n2];
	e = a[N2_1280 * 3 + n2];
	
	a[n2] = barrett_short(b + c + d + e);
	a[N2_1280 + n2] = b + montgomery(c * w_5[0][0] + d * w_5[0][1] + e * w_5[0][2]);
	a[N2_1280 * 2 + n2] = b + montgomery(c * w_5[1][0] + d * w_5[1][1] + e * w_5[1][2]);
	a[N2_1280 * 3 + n2] = b + montgomery(c * w_5[2][0] + d * w_5[2][1] + e * w_5[2][2]);
	a[N2_1280 * 4 + n2] = b + montgomery(c * w_5[3][0] + d * w_5[3][1] + e * w_5[3][2]);
}

/* 256 * 5 --> 256 * 1 */
static void ntt_butterfly_1280_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_short(a[n2] + a[N2_1280 + n2] + a[N2_1280 * 2 + n2] + a[N2_1280 * 3 + n2] + a[N2_1280 * 4 + n2]);
}

/* 256 * 12 --> 256 * 13 */
static void ntt_butterfly_3072_3328(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k, l, m;
	
	b = a[n2];
	c = a[N2_3328 + n2];
	d = a[N2_3328 * 2 + n2];
	e = a[N2_3328 * 3 + n2];
	f = a[N2_3328 * 4 + n2];
	g = a[N2_3328 * 5 + n2];
	h = a[N2_3328 * 6 + n2];
	i = a[N2_3328 * 7 + n2];
	j = a[N2_3328 * 8 + n2];
	k = a[N2_3328 * 9 + n2];
	l = a[N2_3328 * 10 + n2];
	m = a[N2_3328 * 11 + n2];
	
	a[n2] = barrett_short(b + c + d + e + f + g + h + i + j + k + l + m);
	a[N2_3328 + n2] = b + montgomery(c * w_13[0][0] + d * w_13[0][1] + e * w_13[0][2] + f * w_13[0][3] + g * w_13[0][4] + h * w_13[0][5] + i * w_13[0][6] + j * w_13[0][7] + k * w_13[0][8] + l * w_13[0][9] + m * w_13[0][10]);
	a[N2_3328 * 2 + n2] = b + montgomery(c * w_13[1][0] + d * w_13[1][1] + e * w_13[1][2] + f * w_13[1][3] + g * w_13[1][4] + h * w_13[1][5] + i * w_13[1][6] + j * w_13[1][7] + k * w_13[1][8] + l * w_13[1][9] + m * w_13[1][10]);
	a[N2_3328 * 3 + n2] = b + montgomery(c * w_13[2][0] + d * w_13[2][1] + e * w_13[2][2] + f * w_13[2][3] + g * w_13[2][4] + h * w_13[2][5] + i * w_13[2][6] + j * w_13[2][7] + k * w_13[2][8] + l * w_13[2][9] + m * w_13[2][10]);
	a[N2_3328 * 4 + n2] = b + montgomery(c * w_13[3][0] + d * w_13[3][1] + e * w_13[3][2] + f * w_13[3][3] + g * w_13[3][4] + h * w_13[3][5] + i * w_13[3][6] + j * w_13[3][7] + k * w_13[3][8] + l * w_13[3][9] + m * w_13[3][10]);
	a[N2_3328 * 5 + n2] = b + montgomery(c * w_13[4][0] + d * w_13[4][1] + e * w_13[4][2] + f * w_13[4][3] + g * w_13[4][4] + h * w_13[4][5] + i * w_13[4][6] + j * w_13[4][7] + k * w_13[4][8] + l * w_13[4][9] + m * w_13[4][10]);
	a[N2_3328 * 6 + n2] = b + montgomery(c * w_13[5][0] + d * w_13[5][1] + e * w_13[5][2] + f * w_13[5][3] + g * w_13[5][4] + h * w_13[5][5] + i * w_13[5][6] + j * w_13[5][7] + k * w_13[5][8] + l * w_13[5][9] + m * w_13[5][10]);
	a[N2_3328 * 7 + n2] = b + montgomery(c * w_13[6][0] + d * w_13[6][1] + e * w_13[6][2] + f * w_13[6][3] + g * w_13[6][4] + h * w_13[6][5] + i * w_13[6][6] + j * w_13[6][7] + k * w_13[6][8] + l * w_13[6][9] + m * w_13[6][10]);
	a[N2_3328 * 8 + n2] = b + montgomery(c * w_13[7][0] + d * w_13[7][1] + e * w_13[7][2] + f * w_13[7][3] + g * w_13[7][4] + h * w_13[7][5] + i * w_13[7][6] + j * w_13[7][7] + k * w_13[7][8] + l * w_13[7][9] + m * w_13[7][10]);
	a[N2_3328 * 9 + n2] = b + montgomery(c * w_13[8][0] + d * w_13[8][1] + e * w_13[8][2] + f * w_13[8][3] + g * w_13[8][4] + h * w_13[8][5] + i * w_13[8][6] + j * w_13[8][7] + k * w_13[8][8] + l * w_13[8][9] + m * w_13[8][10]);
	a[N2_3328 * 10 + n2] = b + montgomery(c * w_13[9][0] + d * w_13[9][1] + e * w_13[9][2] + f * w_13[9][3] + g * w_13[9][4] + h * w_13[9][5] + i * w_13[9][6] + j * w_13[9][7] + k * w_13[9][8] + l * w_13[9][9] + m * w_13[9][10]);
	a[N2_3328 * 11 + n2] = b + montgomery(c * w_13[10][0] + d * w_13[10][1] + e * w_13[10][2] + f * w_13[10][3] + g * w_13[10][4] + h * w_13[10][5] + i * w_13[10][6] + j * w_13[10][7] + k * w_13[10][8] + l * w_13[10][9] + m * w_13[10][10]);
	a[N2_3328 * 12 + n2] = b + montgomery(c * w_13[11][0] + d * w_13[11][1] + e * w_13[11][2] + f * w_13[11][3] + g * w_13[11][4] + h * w_13[11][5] + i * w_13[11][6] + j * w_13[11][7] + k * w_13[11][8] + l * w_13[11][9] + m * w_13[11][10]);
}

/* 256 * 13 --> 256 * 1 */
static void ntt_butterfly_3328_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_short(a[n2] + a[N2_3328 + n2] + a[N2_3328 * 2 + n2] + a[N2_3328 * 3 + n2] + a[N2_3328 * 4 + n2] + a[N2_3328 * 5 + n2] + a[N2_3328 * 6 + n2] + a[N2_3328 * 7 + n2] + a[N2_3328 * 8 + n2] + a[N2_3328 * 9 + n2] + a[N2_3328 * 10 + n2] + a[N2_3328 * 11 + n2] + a[N2_3328 * 12 + n2]);
}

void ntt_2048_3328(uint32_t *a)
{
	ntt_core(a, N1_3328, N2_3328, omega_256, omega_3328, ntt_butterfly_2048_3328, bit_reverse_256);
}

void intt_3328_1280(uint32_t *a)
{
	intt_core(a, N1_3328, N2_3328, 1280, omega_256, omega_3328, ntt_butterfly_3328_1280, INV_3328, bit_reverse_256);
}

void ntt_1024_3072(uint32_t *a)
{
	ntt_core(a, N1_3072, N2_3072, omega_1024, omega_3072, ntt_butterfly_1024_3072, bit_reverse_1024);
}

void ntt_2048_3072(uint32_t *a)
{
	ntt_core(a, N1_3072, N2_3072, omega_1024, omega_3072, ntt_butterfly_2048_3072, bit_reverse_1024);
}

void intt_3072_3072_inv(uint32_t *a)
{
	intt_core(a, N1_3072, N2_3072, 3072, omega_1024_inv, omega_3072_inv, ntt_butterfly_3072_3072_inv, INV_3072, bit_reverse_1024);
}

void ntt_1280_1280_inv(uint32_t *a)
{
	ntt_core(a, N1_1280, N2_1280, omega_256_inv, omega_1280_inv, ntt_butterfly_1280_1280_inv, bit_reverse_256);
}

void ntt_1024_1280(uint32_t *a)
{
	ntt_core(a, N1_1280, N2_1280, omega_256, omega_1280, ntt_butterfly_1024_1280, bit_reverse_256);
}

void intt_1280_256(uint32_t *a)
{
	intt_core(a, N1_1280, N2_1280, 256, omega_256, omega_1280, ntt_butterfly_1280_256, INV_1280, bit_reverse_256);
}

void ntt_3072_3328(uint32_t *a)
{
	ntt_core(a, N1_3328, N2_3328, omega_256, omega_3328, ntt_butterfly_3072_3328, bit_reverse_256);
}

void intt_3328_256(uint32_t *a)
{
	intt_core(a, N1_3328, N2_3328, 256, omega_256, omega_3328, ntt_butterfly_3328_256, INV_3328, bit_reverse_256);
}
